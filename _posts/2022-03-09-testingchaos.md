---
author:
- Liam Llamazares
bibliography:
- biblio.bib
date: 23-05-2022
title: Malliavin Calculus
---

Based on the book Nunno, G. D., Øksendal, B., & Proske, F. (Eds.). (2008). Malliavin calculus for Lévy processes with applications to finance. Berlin, Heidelberg: Springer Berlin Heidelberg.

\section{Wiener Itô chaos expansion}
\subsection{Three line summary}
\begin{itemize}
	\item Square integrable  \textit{deterministic} functions of multiple variables can be repeatedly Itô integrated to get a square integrable \emph{random} function.
	\item  Repeated integration satisfies an \textit{isometry}.
	\item Every square integrable function can be uniquely  written as the \textit{sum} of repeated integrals.
\end{itemize}
\subsection{Why this is important}
I have no idea yet what this links to or why it's important. \red{To be filled out.}

\subsection{Iterated integrals}
We will write $\Ff_t$ for the completion of the natural filtration generated by $W(t)$, on some measure space  $\Omega$ and consider an interval $I=[0,T]$ or  $I=[0,+\infty)$. We also recall the notation
\begin{equation*}
	\Mm_t^2:=\{f\in L^2([0,t]\times\Omega)\text{ that are continuous martingales}\}.
\end{equation*}
We will work with the spaces $L^2(I^n), L^2_S(I^n),L^2(S_n)$ of respectively square integrable functions, symmetric square integrable functions and square integrable functions on
\begin{equation*}
	S_n:=\{0\leq t_0\leq\ldots\leq t_n\leq T\}.
\end{equation*}
Since these functions don't involve a random variable we call them \emph{deterministic}. Given $f\in L^2(I^n)$ we denote it's symmetrization by
\begin{equation*}
	f_S:=\frac{1}{n!}\sum_{\sigma} f(t_{\sigma_1},\ldots,t_{\sigma_n}).
\end{equation*}
Where $\sigma$ is summed over all the permutations of $\{1,\ldots,n\}$.
Note that if $f$ is already symmetric then  $f=f_S$. Given a \emph{deterministic} function we can transform it into a \emph{random} one by taking it's Itô integral. By integrating multiple times we obtain the following definition
\begin{definition}
	Let $f\in L^2(S_n)$, then we define the \emph{n-fold Itô integral} as
	\begin{equation*}
		J_n(f):=\int_I\cdots \int_{0}^{t_3}\int_{0}^{t_2} f(t_1,\ldots,t_n)dW(t_1) dW(t_2)\ldots dW(t_n).
	\end{equation*}

\end{definition}
The definition requires some care to verify to make sense of sense of and to make sure it is well defined. For example note that the variables appearing in the upper bounds of the integration domain are the same as those appearing as integration variables. To better understand the definition, first note that, by the properties of the Itô integral, for each $t_2\leq\cdots\leq t_n$,
\begin{equation*}
	F_2(t_2\ldots,t_n):=	\int_{0}^{t_2} f(t_1,\ldots,t_n)dW(t_1) \in \Mm_{t_3}^2.
\end{equation*}
Where $F_2(\cdot,t_3,\ldots,t_n)\in \Mm_{t_3}^2$ is viewed as a function of $t_2$. Due to the above inclusion $F_2(\cdot,t_3,\ldots,t_n)$ is Itô integrable and
\begin{equation*}
	F_3(t_3\ldots,t_n):=	\int_{0}^{t_3} F_2(t_2,\ldots,t_n)dW(t_2) \in \Mm_{t_4}^2  .
\end{equation*}
Where the above is viewed as a function of $t_3$. Iterating this process we get that $F_n \in \Mm_T^2$ and
\begin{equation*}
	J_n(f)=\int_I F_n(t_n)dW(t_2) \in L^2(\Omega).
\end{equation*}
To notice the subtleties involved, we note that one example of an integral that would be ill-defined however is if for $f\in L^2(I^n)$
we defined
\begin{equation*}
	\red{J_n(f)}:=\int_I\cdots \int_I\int_I f(t_1,\ldots,t_n)dW(t_1) dW(t_2)\ldots dW(t_n).
\end{equation*}
In this case we have that the first integral is $\Ff_T$ adapted and not $\Ff_{t_2}$ adapted so we cannot continue integrating! As a result we instead give the following definition for symmetric functions.
\begin{definition}
	Let $f\in L^2_S(I^n)$, then we define
	\begin{equation*}
		I_n(f):=\int_I\cdots \int_I\int_I f(t_1,\ldots,t_n)dW(t_1) dW(t_2)\ldots dW(t_n):=n! J_n(f).
	\end{equation*}
\end{definition}
Where it is important to note that the second equality is by definition and where the rescaling factor is motivated by the fact that, by counting permutations, if $I$ is finite then $\mu(I^n)=n! \mu(S_n)$.
\begin{proposition}[Itô's n-th isometry]
	Let $f,g\in L^2(S^n)$ then
	\begin{equation*}
		\br{J_n(f),J_m(g)}_{L^2(\Omega)}=\br{f,g}_{L^2(S_n)}\delta_{nm}
	\end{equation*}
\end{proposition}
\begin{proof}
	The proof is an application of Itô's (product) isometry to move the expectation into the iterated integrals. If the number of integrals are unequal ($n\neq m$) you get the expectation of a Itô integral which is zero. Otherwise you just get the (deterministic) inner product.
\end{proof}
As a result we also get by a calculation that if $f,g\in L^2(I^n)$ then
\begin{equation*}
	\br{I_n(f),I_m(g)}_{L^2(\Omega)}=n!\br{f,g}_{L^2(I^n)}\delta_{nm}.
\end{equation*}
\subsection{The chaos expansion}
\begin{lemma}[Itô's representation theorem]
	Let $\xi\in L^2(\Omega,\Ff_\infty)$, then there exists a unique $X(t)\in \mathbb{L}^2(I)$ such that
	\begin{equation*}
		\xi=\E[\xi]+\int_{I} X(t)dW(t).
	\end{equation*}
	Furthermore it holds that $\norm{X}_{L^2(I\times\Omega)}\leq \norm{\xi}_{L^2(\Omega)}$.
\end{lemma}


\begin{theorem}[Chaos expansion]
	Let $\xi\in L^2(\Omega,\Ff_\infty)$, then there exists a unique sequence of functions $f_n \in L^2(S_n),g_n \in L^2(I^n)$ such that
	\begin{equation*}
		\xi=\sum_{n=0}^{\infty}  f_n;\quad \xi=\sum_{n=0}^{\infty} g_n.
	\end{equation*}
	\begin{proof}
		The proof is a bit technical but we sketch the main idea which is to iteratively apply Itô's representation theorem to get
		\begin{multline*}
			\xi=\E[\xi]+\int_I X_1(t)dW(t_1)=\E[\xi]+\int_{I} \E[X_1(t_1)] dW(t_1)\\+ \int_{I}\int_{0}^{t_2} X_2(t_1,t_2) dW(t_1)dW(t_2)= \ldots=\sum_{n=0}^{N}  J_n(g_n)+ \int_{S_{N+1}} X_{N+1} dW^{\otimes(N+1)}.
		\end{multline*}
		Where $g_0=\Ee[\xi], g_1(t_1) =\Ee[X_1](t_1)$ and so on. By an iteration we deduce that if we write $\phi_{N+1}$ for the last integral term, then
		\begin{equation*}
			\E[\phi_{N+1}]\leq\ldots\leq \E[\xi^2].
		\end{equation*}
		Furthermore, by Itô's $n$-th isometry we have that the terms in the above sum are orthogonal so
		\begin{equation*}
			\norm{\xi}_{L^2(\Omega)}=\sum_{n=0}^{N} \norm{J_n(f_n)}_{L^2(\Omega)} +\norm{\phi_{N+1}}_{L^2(\Omega)}.
		\end{equation*}
		Since the last term is bounded, we obtain a bound on the $L^2(\Omega)$ norm of the sum uniform in  $n$ so the sum converges. As a result so does $\phi_N$  to some $\phi_\infty$. It suffices to see that $\phi_\infty=0$. This can be proved using that, by Itô's  $n$-th isometry, $\phi_{N+1}$ is orthogonal to  $J_n(h)$ for any $h\in L^2(\Omega)$ and $n\leq N$. As a result the limit $\phi_\infty$ is orthogonal to $J_n(h)$ for all  $n$  and by a density argument (there are a lot of these functions $J_n(h)$!) we obtain $\phi_\infty=0$. This proves the first sum of the theorem.\\\\
		It remains to prove the second part, but this follows by extending the $f_n$ by  $0$ on  $I^n\setminus S_n$ and taking $g_n$ to be the symmetrization of this extension.
	\end{proof}


\end{theorem}



\bibliography{biblio.bib}

