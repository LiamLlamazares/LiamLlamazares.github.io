---
layout: post
title: The Chaos Expansion
subtitle: Iterated Itô integrals and their consequences
thumbnail-img: /assets/img/Malliavin.jpg
share-img: /assets/img/Malliavin.jpg
tags: [Stochastic calculus, Malliavin Calculus]
---

This is the first post of many to come on this blog, thanks for joining!
This is also the first in a series on Malliavin calculus. This chain is
based on the book by Oksendal and Nunno [1](https://link.springer.com/book/10.1007/978-3-540-78572-9) and inspired by a reading group on the topic.

# Three line summary

-   square-integrable deterministic functions of multiple variables
    can be iteratively Itô integrated to get a square-integrable random
    function.

-   Iterated integration satisfies an isometry.

-   Every square-integrable function can be uniquely written as the
    a sum of iterated integrals.

# Why this is important

The chaos expansion gives us a way to represent random variables as a sum of functions in $L^2$. This representation can be used to define the [Skorohod integral](https://liamllamazares.github.io/2022-05-29-Malliavin-Calculus-2/) and later on the Malliavin derivative.

## Iterated integrals

We will write $\mathcal{F}\U t$ for the completion of the natural
filtration generated by $W(t)$, on some measure space $\Omega$ and
consider an interval $I=\zl 0,T\zr $ or $I=\zl 0,+\infty)$. In this second case we will also write $T=+\infty$. In this second case we say that $T=\infty.$ We also recall the
notation
<div>
 $$\mathcal{M}\U t^2:=\{f\in L^2(\zl 0,t\zr \times\Omega)\text{ that are continuous martingales}\}.$$
</div>
We will work with the spaces $L^2(I^n), L^2\U S(I^n),L^2(S\U n)$ of
respectively square-integrable functions, symmetric square-integrable
functions and square-integrable functions on
<div>
 $$S\U n:=\{0\leq t\U 0\leq\ldots\leq t\U n\leq T\}.$$
</div>  Since these functions
don't involve a random variable we call them deterministic. Given
$f\in L^2(I^n)$ we denote its symmetrization by
<div>
 $$f\U S:=\frac{1}{n!}\sum\U {\sigma} f(t\U {\sigma\U 1},\ldots,t\U {\sigma\U n}).$$
</div>
Where $\sigma$ is summed over all the permutations of $\{1,\ldots,n\}$.
Note that if $f$ is already symmetric then $f=f\U S$. Given a
deterministic function we can transform it into a random one by
taking its Itô integral. We will want to do this multiple times, this is permitted by the following lemma.

**Lemma 0** Given $f\in L^2(S\U n)$  and any $m<n$, the integral
<div>
 $$\int\U {0}^{t\U m}\int\U {0}^{t\U 2} f(t\U 1,\ldots,t\U n)dW(t\U 1)\ldots dW(t\U {m-1}).$$
</div>
is in $\mathbb{L}^2(I\times\Omega)$ as a function of $t\U m$.

Proof. The proof can be seen by verifying the above property for smooth functions $f \in C\U c^\infty(S\U n)$ and taking limits as $C\U c^\infty(S\U n)$  is dense in $L^2(S\U n)$ and measurability is preserved by limits. ◻

We can now define, the following

**Definition 1**. Let $f\in L^2(S\U n)$, then we define the n-fold Itô
integral as
<div>
 $$J\U n(f):=\int\U I\cdots \int\U {0}^{t\U 3}\int\U {0}^{t\U 2} f(t\U 1,\ldots,t\U n)dW(t\U 1) dW(t\U 2)\ldots dW(t\U n).$$
</div>

To notice the
subtleties involved in this definition, we note that one example of an integral that would
be ill-defined however is if for $f\in L^2(I^n)$ we defined
<div>
 $${\color{red}J\U n(f)}:=\int\U I\cdots \int\U I\int\U I f(t\U 1,\ldots,t\U n)dW(t\U 1) dW(t\U 2)\ldots dW(t\U n).$$
</div>
In this case, we have that the first integral is $\mathcal{F}\U T$ adapted
and not $\mathcal{F}\U {t\U 2}$ adapted so we cannot continue integrating!
As a result, we instead give the following definition for symmetric
functions.


**Definition 2**. Let $f\in L^2\U S(I^n)$, then we define
<div>
 $$I\U n(f):=\int\U I\cdots \int\U I\int\U I f(t\U 1,\ldots,t\U n)dW(t\U 1) dW(t\U 2)\ldots dW(t\U n):=n! J\U n(f).$$
</div>


Where it is important to note that the second equality is by definition
and where the rescaling factor is motivated by the fact that, by
counting permutations, if $I$ is finite then $\mu(I^n)=n! \mu(S\U n)$.


**Proposition 1** (Itô's n-th isometry). Let $f,g\in L^2(S^n)$ then
<div>
 $$\left\langle J\U n(f),J\U m(g)\right\rangle\U {L^2(\Omega)}=\left\langle f,g\right\rangle\U {L^2(S\U n)}\delta\U {nm}$$
</div>



Proof. The proof is an application of Itô's (product) isometry to move
the expectation into the iterated integrals. If the number of integrals
is unequal ($n\neq m$) you get the expectation of an Itô integral which
is zero. Otherwise, you just get the (deterministic) inner product. ◻


As a result we also get by a calculation that if $f,g\in L^2(I^n)$ then
<div>
 $$\left\langle I\U n(f),I\U m(g)\right\rangle\U {L^2(\Omega)}=n!\left\langle f,g\right\rangle\U {L^2(I^n)}\delta\U {nm}.$$
</div>

## The chaos expansion


**Lemma 1** (Itô's representation theorem). Let
$\xi\in L^2(\Omega,\mathcal{F}\U \infty)$, then there exists a unique
$X(t)\in \mathbb{L}^2(I)$ such that
<div>
 $$\xi=\mathbb{E}\zl \xi\zr +\int\U {I} X(t)dW(t).$$
</div>  Furthermore it holds that
$\norm{X}\U {L^2(I\times\Omega)}\leq \norm{\xi}\U {L^2(\Omega)}$.



**Theorem 1** (Chaos expansion). Let
$\xi\in L^2(\Omega,\mathcal{F}\U \infty)$, then there exists a unique
sequence of functions $g\U n \in L^2(S\U n),f\U n \in L^2(I^n)$ such that
<div>
 $$\xi=\sum\U {n=0}^{\infty}  J\U n (g\U n);\quad \xi=\sum\U {n=0}^{\infty} I \U n (f\U n).$$
</div>


Proof. The proof is a bit technical but we sketch the main idea which
is to iteratively apply Itô's representation theorem to get
<div>
 $$\begin{gathered}
            \xi=\mathbb{E}\zl \xi\zr +\int\U I X\U 1(t)dW(t\U 1)=\mathbb{E}\zl \xi\zr +\int\U {I} \mathbb{E}\zl X\U 1(t\U 1)\zr  dW(t\U 1)\\+ \int\U {I}\int\U {0}^{t\U 2} X\U 2(t\U 1,t\U 2) dW(t\U 1)dW(t\U 2)= \ldots=\sum\U {n=0}^{N}  J\U n(f\U n)+ \int\U {S\U {N+1}} X\U {N+1} dW^{\otimes(N+1)}.
        \end{gathered}$$
</div>  Where
$g\U 0=\mathbb{E}\zl \xi\zr , g\U 1(t\U 1) =\mathbb{E}\zl X\U 1\zr (t\U 1)$ and so on. By an
iteration we deduce that, if we write $\phi\U {N+1}$ for the last integral
term, then
<div>
 $$\mathbb{E}\zl \phi\U {N+1}\zr \leq\ldots\leq \mathbb{E}\zl \xi^2\zr .$$
</div>
Furthermore, by Itô's $n$-th isometry we have that the terms in the
above sum are orthogonal so
<div>
 $$\norm{\xi}\U {L^2(\Omega)}=\sum\U {n=0}^{N} \norm{J\U n(g\U n)}\U {L^2(\Omega)} +\norm{\phi\U {N+1}}\U {L^2(\Omega)}.$$
</div>
Since the last term is bounded, we obtain a bound on the $L^2(\Omega)$
norm of the sum uniform in $n$ so the sum converges. As a result, so does
$\phi\U N$ to some $\phi\U \infty$. It suffices to see that $\phi\U \infty=0$.
This can be proved using that, by Itô's $n$-th isometry, $\phi\U {N+1}$ is
orthogonal to $J\U n(h)$ for any $h\in L^2(\Omega)$ and $n\leq N$. As a
result, the limit $\phi\U \infty$ is orthogonal to $J\U n(h)$ for all $n$ and
by a density argument (there are a lot of these functions $J\U n(h)$!) we
obtain $\phi\U \infty=0$. This proves the first sum of the theorem.\
\
It remains to prove the second part, but this follows by extending the
$g\U n$ by $0$ on $I^n\setminus S\U n$ and taking $f\U n$ to be the
symmetrization of this extension. ◻


A pdf of version of this page is provided below:
<object data="/assets/Malliavin_Oksendal_Chapter_1.pdf" width="1000" height="1000" type='application/pdf'></object>
