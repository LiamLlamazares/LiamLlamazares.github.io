---
layout: post
title: The Chaos Expansion
subtitle: Iterated Itô integrals and their consequences
thumbnail-img: /assets/img/Malliavin.jpg
share-img: /assets/img/Malliavin.jpg
tags: [Stochastic calculus, Malliavin Calculus]
---

This is the first post of many to come on this blog, thanks for joining!
This is also the first in a series on Malliavin calculus. This chain is
based on the book by Oksendal and Nunno [1](https://link.springer.com/book/10.1007/978-3-540-78572-9).

# Wiener Itô chaos expansion

, and inspired by a reading group on the topic.

## Three line summary

-   Square integrable deterministic functions of multiple variables
    can be repeatedly Itô integrated to get a square integrable random
    function.

-   Repeated integration satisfies an isometry.

-   Every square integrable function can be uniquely written as the
    sum of repeated integrals.

## Why this is important

I have no idea yet what this links to or why it's important. To be
filled out.

## Iterated integrals

We will write $\mathcal{F}\U t$ for the completion of the natural
filtration generated by $W(t)$, on some measure space $\Omega$ and
consider an interval $I=\zl 0,T\zr $ or $I=\zl 0,+\infty)$. We also recall the
notation
<div>
 $$\mathcal{M}\U t^2:=\{f\in L^2(\zl 0,t\zr \times\Omega)\text{ that are continuous martingales}\}.$$
</div> 
We will work with the spaces $L^2(I^n), L^2\U S(I^n),L^2(S\U n)$ of
respectively square integrable functions, symmetric square integrable
functions and square integrable functions on
<div>
 $$S\U n:=\{0\leq t\U 0\leq\ldots\leq t\U n\leq T\}.$$
</div>  Since these functions
don't involve a random variable we call them deterministic. Given
$f\in L^2(I^n)$ we denote it's symmetrization by
<div>
 $$f\U S:=\frac{1}{n!}\sum\U {\sigma} f(t\U {\sigma\U 1},\ldots,t\U {\sigma\U n}).$$
</div> 
Where $\sigma$ is summed over all the permutations of $\{1,\ldots,n\}$.
Note that if $f$ is already symmetric then $f=f\U S$. Given a
deterministic function we can transform it into a random one by
taking it's Itô integral. By integrating multiple times we obtain the
following definition


**Definition 1**. Let $f\in L^2(S\U n)$, then we define the n-fold Itô
integral as
<div>
 $$J\U n(f):=\int\U I\cdots \int\U {0}^{t\U 3}\int\U {0}^{t\U 2} f(t\U 1,\ldots,t\U n)dW(t\U 1) dW(t\U 2)\ldots dW(t\U n).$$
</div> 


The definition requires some care to verify to make sense of sense of
and to make sure it is well defined. For example note that the variables
appearing in the upper bounds of the integration domain are the same as
those appearing as integration variables. To better understand the
definition, first note that, by the properties of the Itô integral, for
each $t\U 2\leq\cdots\leq t\U n$,
<div>
 $$F\U 2(t\U 2\ldots,t\U n):=    \int\U {0}^{t\U 2} f(t\U 1,\ldots,t\U n)dW(t\U 1) \in \mathcal{M}\U {t\U 3}^2.$$
</div> 
Where $F\U 2(\cdot,t\U 3,\ldots,t\U n)\in \mathcal{M}\U {t\U 3}^2$ is viewed as a
function of $t\U 2$. Due to the above inclusion
$F\U 2(\cdot,t\U 3,\ldots,t\U n)$ is Itô integrable and
<div>
 $$F\U 3(t\U 3\ldots,t\U n):=    \int\U {0}^{t\U 3} F\U 2(t\U 2,\ldots,t\U n)dW(t\U 2) \in \mathcal{M}\U {t\U 4}^2  .$$
</div> 
Where the above is viewed as a function of $t\U 3$. Iterating this process
we get that $F\U n \in \mathcal{M}\U T^2$ and
<div>
 $$J\U n(f)=\int\U I F\U n(t\U n)dW(t\U 2) \in L^2(\Omega).$$
</div>  To notice the
subtleties involved, we note that one example of an integral that would
be ill-defined however is if for $f\in L^2(I^n)$ we defined
<div>
 $${\color{red}J\U n(f)}:=\int\U I\cdots \int\U I\int\U I f(t\U 1,\ldots,t\U n)dW(t\U 1) dW(t\U 2)\ldots dW(t\U n).$$
</div> 
In this case we have that the first integral is $\mathcal{F}\U T$ adapted
and not $\mathcal{F}\U {t\U 2}$ adapted so we cannot continue integrating!
As a result we instead give the following definition for symmetric
functions.


**Definition 2**. Let $f\in L^2\U S(I^n)$, then we define
<div>
 $$I\U n(f):=\int\U I\cdots \int\U I\int\U I f(t\U 1,\ldots,t\U n)dW(t\U 1) dW(t\U 2)\ldots dW(t\U n):=n! J\U n(f).$$
</div> 


Where it is important to note that the second equality is by definition
and where the rescaling factor is motivated by the fact that, by
counting permutations, if $I$ is finite then $\mu(I^n)=n! \mu(S\U n)$.


**Proposition 1** (Itô's n-th isometry). Let $f,g\in L^2(S^n)$ then
<div>
 $$\left\langle J\U n(f),J\U m(g)\right\rangle\U {L^2(\Omega)}=\left\langle f,g\right\rangle\U {L^2(S\U n)}\delta\U {nm}$$
</div> 



Proof. The proof is an application of Itô's (product) isometry to move
the expectation into the iterated integrals. If the number of integrals
are unequal ($n\neq m$) you get the expectation of a Itô integral which
is zero. Otherwise you just get the (deterministic) inner product. ◻


As a result we also get by a calculation that if $f,g\in L^2(I^n)$ then
<div>
 $$\left\langle I\U n(f),I\U m(g)\right\rangle\U {L^2(\Omega)}=n!\left\langle f,g\right\rangle\U {L^2(I^n)}\delta\U {nm}.$$
</div> 

## The chaos expansion


**Lemma 1** (Itô's representation theorem). Let
$\xi\in L^2(\Omega,\mathcal{F}\U \infty)$, then there exists a unique
$X(t)\in \mathbb{L}^2(I)$ such that
<div>
 $$\xi=\mathbb{E}\zl \xi\zr +\int\U {I} X(t)dW(t).$$
</div>  Furthermore it holds that
$\norm{X}\U {L^2(I\times\Omega)}\leq \norm{\xi}\U {L^2(\Omega)}$.



**Theorem 1** (Chaos expansion). Let
$\xi\in L^2(\Omega,\mathcal{F}\U \infty)$, then there exists a unique
sequence of functions $f\U n \in L^2(S\U n),g\U n \in L^2(I^n)$ such that
<div>
 $$\xi=\sum\U {n=0}^{\infty}  f\U n;\quad \xi=\sum\U {n=0}^{\infty} g\U n.$$
</div> 


Proof. The proof is a bit technical but we sketch the main idea which
is to iteratively apply Itô's representation theorem to get
<div>
 $$\begin{gathered}
            \xi=\mathbb{E}\zl \xi\zr +\int\U I X\U 1(t)dW(t\U 1)=\mathbb{E}\zl \xi\zr +\int\U {I} \mathbb{E}\zl X\U 1(t\U 1)\zr  dW(t\U 1)\\+ \int\U {I}\int\U {0}^{t\U 2} X\U 2(t\U 1,t\U 2) dW(t\U 1)dW(t\U 2)= \ldots=\sum\U {n=0}^{N}  J\U n(g\U n)+ \int\U {S\U {N+1}} X\U {N+1} dW^{\otimes(N+1)}.
        \end{gathered}$$
</div>  Where
$g\U 0=\mathbb{E}\zl \xi\zr , g\U 1(t\U 1) =\mathbb{E}\zl X\U 1\zr (t\U 1)$ and so on. By an
iteration we deduce that if we write $\phi\U {N+1}$ for the last integral
term, then <div>
 $$\mathbb{E}\zl \phi\U {N+1}\zr \leq\ldots\leq \mathbb{E}\zl \xi^2\zr .$$
</div> 
Furthermore, by Itô's $n$-th isometry we have that the terms in the
above sum are orthogonal so
<div>
 $$\norm{\xi}\U {L^2(\Omega)}=\sum\U {n=0}^{N} \norm{J\U n(f\U n)}\U {L^2(\Omega)} +\norm{\phi\U {N+1}}\U {L^2(\Omega)}.$$
</div> 
Since the last term is bounded, we obtain a bound on the $L^2(\Omega)$
norm of the sum uniform in $n$ so the sum converges. As a result so does
$\phi\U N$ to some $\phi\U \infty$. It suffices to see that $\phi\U \infty=0$.
This can be proved using that, by Itô's $n$-th isometry, $\phi\U {N+1}$ is
orthogonal to $J\U n(h)$ for any $h\in L^2(\Omega)$ and $n\leq N$. As a
result the limit $\phi\U \infty$ is orthogonal to $J\U n(h)$ for all $n$ and
by a density argument (there are a lot of these functions $J\U n(h)$!) we
obtain $\phi\U \infty=0$. This proves the first sum of the theorem.\
\
It remains to prove the second part, but this follows by extending the
$f\U n$ by $0$ on $I^n\setminus S\U n$ and taking $g\U n$ to be the
symmetrization of this extension. ◻


A pdf of version of this page is provided below:
<object data="/assets/Malliavin_Oksendal_Chapter_1.pdf" width="1000" height="1000" type='application/pdf'></object>

# Three line summary

-   The Itô integral is a way of integrating random variables against
    Brownian motion.

-   The Itô integral is well defined for piecewise constant adapted
    processes $\mathcal{E}$ and turns them isometrically into square
    integrable continuous martingales ($\mathcal{M}\U I^2$).

-   As a result the Itô integral can be extended isometrically to a
    function $\overline{\mathcal{E}}\to \mathcal{M}\U I^2$. Furthermore
    $\overline{\mathcal{E}}$ can be characterised explicitly as the
    square integrable adapted processes that are measurable in time and
    space.

# Why should I care?

The Itô integral forms the basis of the whole of stochastic calculus.
This comprises SDEs, SPDEs. Knowledge of what functions can be
integrated and what properties the integrated function has is
instrumental. In this post we construct the integral and address both of
the preceding issues.

# Notation

Given two measure spaces $(\Omega,\mathcal{F}),(\Omega',\mathcal{F}')$
we abbreviate that $f:\Omega\to\Omega'$ is measurable between
$\mathcal{F}$ and $\mathcal{F}'$ as $f:\mathcal{F}\to\mathcal{F}'.$
Furthermore we will take $I=\zl 0,T\zr $ or $I=\zl 0,+\infty)$ to be the index
set of our stochastic processes and by abuse of notation write
$\mathcal{F}\U \infty$ to mean $\mathcal{F}\U T$ in the former case and
$\mathcal{F}\U \infty$ in the latter.

# Integrable functions: progressive measurability

As we will soon see the only stochastic process that can be integrated
are the square integrable and progressively measurable. But what does
this mysterious term mean?


**Definition 1**. A stochastic process $\{X\U t\}\U {t\in I}$ is
progressively measurable if
<div>
 $$X:\mathcal{B}(\zl 0,t\zr )\otimes\mathcal{F}\U t\to \mathcal{H}$$
</div>  is
measurable for all $t\in I$.


Whenever we're given a stochastic process and a filtration the first
thing to check is that it is adapted. In fact, since
$\omega\to(t,\omega)$ is
$\mathcal{F}\U t\to \mathcal{B}(\zl 0,t\zr )\otimes \mathcal{F}\U t$ measurable
for all $t$ we have that the following holds.


**Lemma 1**. Progressively measurable processes are adapted.


Additionally, stochastic processes can be viewed path-wise but also be
seen as functions of a product space, this leads to the following
definition.


**Definition 2**. We say that a stochastic process $\{X\U t\}\U {t\in I}$
is jointly measurable if
<div>
 $$X:\mathcal{B}(I)\otimes\mathcal{F}\U \infty\to \mathcal{H}$$
</div>  where
$\mathcal{F}\U \infty:=\vee\U {t\in I}\mathcal{F}\U t$.


In the definition of progressive measurability we imposed some kind of
measurability, in fact the condition leads to the following


**Proposition 1** (Progressive implies jointly measurable). Let
$I\subset{\mathbb R}$, and $\{X\U t\}\U {t\in I}$ be progressively
measurable. Then it is also jointly measurable.



Proof. Given $A\in\mathcal{H}$ we have that <div>
 $$\begin{gathered}
        \left.{X^{-1}}\right|\U {\zl 0,t\zr \times\Omega}(A)\in\mathcal{B}(\zl 0,t\zr )\otimes\mathcal{F}\U t\quad\forall t\in I\\ \iff X^{-1}(A)\cap(\zl 0,t\zr \times\Omega)\in\mathcal{B}(\zl 0,t\zr )\otimes\mathcal{F}\U t\quad\forall t\in I\\\implies X^{-1}(A)=\bigcup\U {n \in  \mathbb{N}}X^{-1}(A)\cap(\zl 0,t\U n\zr \times\Omega) \in\mathcal{B}(I)\otimes\mathcal{F}\U \infty
    \end{gathered}$$
</div>  Where $t\U n\in I$ is a sequence converging to the
endpoint of $I$. ◻


Note however that the converse isn't true, for example if $X$ is
constant in $t$ then, for some $B\subset \Omega$
<div>
 $$X^{-1}(A)=I\times B;\quad {X^{-1}}|\U {\zl 0,t\zr \times\Omega}(A)= \zl 0,t\zr \times B$$
</div> 
So it suffices to consider some Construction where
$B\in\mathcal{F}\U \infty$ but $B\not\in\mathcal{F}\U t$. It is also
important to note the following.


**Lemma 2** (SDE coefficients are progressive). Let $X\U t$ be a
progressively measurable stochastic process and let
$f:\mathcal{H}\to\mathcal{G}$ be measurable, then $f(t,X\U t)$ is
progressively measurable.



Proof. This follows from considering $(t,\omega)\to (t,X(t,w))$. Where
the arrow is measurable as, due to the progressive measurability of $X$,
each component is adapted. ◻


The difference between progressively measurable and adapted is quite
subtle. In fact every adapted and jointly measurable stochastic process
has a progressively measurable modification (see
[1](https://link.springer.com/book/10.1007/978-1-4612-0949-2) page $5$). The proof of this fact is very
lengthy and technical. Thus, if
$X\in L^2(\mathcal{B}(I)\otimes\mathcal{F}\U \infty)$ (and in particular
is jointly measurable), we may always choose a representative that is
progressively measurable. This leads to some authors giving the
defintion of the class of Itô integrable functions in terms of joint
measurability instead of progressive measurability. In the end both lead
to equivalent definition. That said, this technicality is usually of
little importance due to the following result.


**Lemma 3** (Continuity is progressive). Let $\{X\U t\}\U {t\in I}$ be a
left or right continuous stochastic process. Then $X$ is progressively
measurable.



Proof. Suppose for example that $X$ is right continuous, then we
consider
<div>
 $$X\U {s}^{(n)}(\omega)=X\U {(k+1) ! / 2^{n}}(\omega) \text { for } \frac{k t}{2^{n}}<s \leq \frac{k+1}{2^{n}} t$$
</div> 
The pre-image of any set $A\in\mathcal{H}$ is of the form
<div>
 $$X^{-1}(A)=\bigcup\U {i\in \mathbb{N}}(t\U i,t\U {i+1}\zr \times X\U {t\U i}^{-1}(A).$$
</div> 
So $X^{(n)}$ is progressively measurable. We conclude as by right
continuity $\lim\U {n \to \infty}X^{(n)}=X$. ◻


Also we used that the pointwise limit of progressively measurable
functions is progressively measurable. This is because the pointwise
limit of measurable functions is measurable.


**Lemma 4**. For any $p \in\zl 1, \infty)$, the elementary processes are
$L^{p}$-dense in the space $\mathbb{L}^{p}(I\times\Omega)$ of
progressively measurable processes in
$L^p(\mathcal{B}(I)\otimes\mathcal{F}\U \infty)$. That is, for any
$Y \in \mathbb{L}^{p}$ there is a sequence $V\U {n}$ of elementary
functions such that
<div>
 $$\mathbb{E}\zl \int\U {I}|Y(t)-V\U {n}(t)|^{p} dt\zr  \longrightarrow 0.$$
</div> 


The proof of this fact is also rather technical and long. See Chapter
$2$ of [2](http://galton.uchicago.edu/~lalley/Courses/385/Old/ItoIntegral-2012.pdf). Furthermore, we have that


**Theorem 1**. Let
$(\mathcal{E},\|\cdot\|\U {L^2(I\times\Omega)},\mathcal{F}\U t)$ be the set
of simple stochastic processes adapted to $\{\mathcal{F}\U t\}\U {t\in I}$
with the $L^2$ norm. Then it's completion is
<div>
 $$\mathbb{L}^2(I\times\Omega):=\{X\in L^2(\zl 0,T\zr \times\Omega)\text{ progressively measurable }\}.$$
</div> 


The proof of this is by the previous approximation result together with
the fact that the Ito integral of simple processes is an isometry and
the fact that $\mathbb{L}^2(I\times\Omega)$ is complete. This last
property follows from the completeness of the $L^p$ spaces and the fact
that pointwise limits of progressively measurable functions are
progressively measurable (and from every convergent sequence in $L^p$ we
can extract a convergent sub-sequence which must also converge to the
$L^p$ limit). This finally leads us to be able to define the stochastic
integral.


**Theorem 2**. Let $t\in I$ and define for a simple process
$f\in\mathcal{E}$
<div>
 $$\int\U {0}^t X dW=\sum\U {n=0}^{N-1} X(t\U n)(W(t\cap t\U {n+1})-W(t\U n)).$$
</div> 
Then the above defines an isometry to the space of continuous square
integrable martingales $\mathcal{M}\U I^2$ as <div>
 $$\begin{aligned}
        int: \left(\mathcal{E},\|\cdot\|\U {L^2(I\times\Omega)}\right) & \longrightarrow  \left(\mathcal{M}\U I^2,\|\cdot\|\U {L^2(I\times\Omega)}\right) \\
        X(t)                                          & \longmapsto \int\U {0}^t X dW
        .\end{aligned}$$
</div>  Thus, it extends uniquely to the closure
$\overline{\mathcal{E}}=\mathbb{L}^2(I\times\Omega)$. Furthermore the
extension also has image in $\mathcal{M}\U I^2.$



Proof. The first part of the proof is a calculation using the
definition of integral of simple process, the adaptedness of $X$ and the
definition of $W$. The second part is slightly more tricky. The fact
that $X$ is a martingale is due to $L^2$ convergence ($L^1$ would
suffice).\
\
Then, one takes a sequence of elementary processes $X\U n$ converging to
$X$. By the first part one may apply Doob's martingale inequality and
$L^2$ convergence to get a measure of the set where the supremum
<div>
 $$\sup\U {t\in I}  |X\U n(t)-X\U m(t)|>2^{-k},$$
</div>  which can be made small for
$n,m \to\infty$. One can then extract a subsequence and apply
Borel-Cantelli to deduce that the above supremum goes to $0$ almost
everywhere. This shows that $X\U n$ is almost everywhere Cauchy in
$L^\infty$ and thus converges almost everywhere to some continuous
process $Y$. This process must be $X$ by $L^2$ convergence to $X$ which
concludes the proof. ◻

A pdf of version of this page is provided below:
<object data="/assets/The Itô integral.pdf" width="1000" height="1000" type='application/pdf'></object>
