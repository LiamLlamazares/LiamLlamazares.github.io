---
layout: post
title: This good
subtitle: This too
tags: [Stochastic calculus, Malliavin Calculus]
---
Header my macros in head bar underscore everywhere
Based on the book by el pringado [@nunno2008malliavin].

# Wiener Itô chaos expansion

## Three line summary

-   Square integrable *deterministic* functions of multiple variables
    can be repeatedly Itô integrated to get a square integrable *random*
    function.

-   Repeated integration satisfies an *isometry*.

-   Every square integrable function can be uniquely written as the
    *sum* of repeated integrals.

## Why this is important

I have no idea yet what this links to or why it's important. To be
filled out.

## Iterated integrals

We will write $\mathcal{F}\_t$ for the completion of the natural
filtration generated by $W(t)$, on some measure space $\Omega$ and
consider an interval $I=[0,T]$ or $I=[0,+\infty)$. We also recall the
notation
<div>
$$
\mathcal{M}\_t^2:=\{f\in L^2([0,t]\times\Omega)\text{ that are continuous martingales}\}.$$</div>

We will work with the spaces $L^2(I^n), L^2\_S(I^n),L^2(S\_n)$ of
respectively square integrable functions, symmetric square integrable
functions and square integrable functions on
$|X|\_{L^2(I\times\Omega)}\leq|\xi|\_{L^2(\Omega)}$
<div>
$$
S\_n:=\{0\leq t\_0\leq\ldots\leq t\_n\leq T\}.$$</div>
 
 Since these functions
don't involve a random variable we call them *deterministic*. Given
$f\in L^2(I^n)$ we denote its symmetrization by
<div>
$$f\_S:=\frac{1}{n!}\sum\_{\sigma} f(t\_{\sigma\_1},\ldots,t\_{\sigma\_n}).$$</div>

Where $\sigma$ is summed over all the permutations of $\{1,\ldots,n\}$.
Note that if $f$ is already symmetric then $f=f\_S$. Given a
*deterministic* function we can transform it into a *random* one by
taking its Itô integral. By integrating multiple times we obtain the
following definition

**Definition 1**. Let $f\in L^2(S\_n)$, then we define the *n-fold Itô
integral* as
<div>
$$J\_n(f):=\int\_I\cdots \int\_{0}^{t\_3}\int\_{0}^{t\_2} f(t\_1,\ldots,t\_n)dW(t\_1) dW(t\_2)\ldots dW(t\_n).$$</div>


The definition requires some care to verify to make sense of sense of
and to make sure it is well defined. For example note that the variables
appearing in the upper bounds of the integration domain are the same as
those appearing as integration variables. To better understand the
definition, first note that, by the properties of the Itô integral, for
each $t\_2\leq\cdots\leq t\_n$,
<div>
$$F\_2(t\_2\ldots,t\_n):=    \int\_{0}^{t\_2} f(t\_1,\ldots,t\_n)dW(t\_1) \in \mathcal{M}\_{t\_3}^2.$$</div>

Where $F\_2(\cdot,t\_3,\ldots,t\_n)\in \mathcal{M}\_{t\_3}^2$ is viewed as a
function of $t\_2$. Due to the above inclusion
$F\_2(\cdot,t\_3,\ldots,t\_n)$ is Itô integrable and
<div>
$$F\_3(t\_3\ldots,t\_n):=    \int\_{0}^{t\_3} F\_2(t\_2,\ldots,t\_n)dW(t\_2) \in \mathcal{M}\_{t\_4}^2  .$$</div>

Where the above is viewed as a function of $t\_3$. Iterating this process
we get that $F\_n \in \mathcal{M}\_T^2$ and
<div>
$$J\_n(f)=\int\_I F\_n(t\_n)dW(t\_2) \in L^2(\Omega).$$</div>

To notice the
subtleties involved, we note that one example of an integral that would
be ill-defined however is if for $f\in L^2(I^n)$ we defined
<div>
$${\color{red}J\_n(f)}:=\int\_I\cdots \int\_I\int\_I f(t\_1,\ldots,t\_n)dW(t\_1) dW(t\_2)\ldots dW(t\_n).$$</div>

In this case we have that the first integral is $\mathcal{F}\_T$ adapted
and not $\mathcal{F}\_{t\_2}$ adapted so we cannot continue integrating!
As a result we instead give the following definition for symmetric
functions.

**Definition 2**. Let $f\in L^2\_S(I^n)$, then we define
<div>
$$I\_n(f):=\int\_I\cdots \int\_I\int\_I f(t\_1,\ldots,t\_n)dW(t\_1) dW(t\_2)\ldots dW(t\_n):=n! J\_n(f).$$</div>


Where it is important to note that the second equality is by definition
and where the rescaling factor is motivated by the fact that, by
counting permutations, if $I$ is finite then $\mu(I^n)=n! \mu(S\_n)$.


**Proposition 1** (Itô's n-th isometry). Let $f,g\in L^2(S^n)$ then
<div>
$$\left\langle J\_n(f),J\_m(g)\right\rangle\_{L^2(\Omega)}=\left\langle f,g\right\rangle\_{L^2(S\_n)}\delta\_{nm}$$</div>



*Proof.* The proof is an application of Itô's (product) isometry to move
the expectation into the iterated integrals. If the number of integrals
are unequal ($n\neq m$) you get the expectation of a Itô integral which
is zero. Otherwise you just get the (deterministic) inner product. ◻

As a result we also get by a calculation that if $f,g\in L^2(I^n)$ then
<div>
$$\left\langle I\_n(f),I\_m(g)\right\rangle\_{L^2(\Omega)}=n!\left\langle f,g\right\rangle\_{L^2(I^n)}\delta\_{nm}.$$</div>

## The chaos expansion


**Lemma 1** (Itô's representation theorem). Let
$\xi\in L^2(\Omega,\mathcal{F}\_\infty)$, then there exists a unique
$X(t)\in \mathbb{L}^2(I)$ such that
<div>
$$\xi=\mathbb{E}[\xi]+\int\_{I} X(t)dW(t).$$</div> 
Furthermore it holds that
$\|X\|\_{L^2(I\times\Omega)}\leq \|\xi\|\_{L^2(\Omega)}$


**Theorem 1** (Chaos expansion). Let
$\xi\in L^2(\Omega,\mathcal{F}\_\infty)$, then there exists a unique
sequence of functions $f\_n \in L^2(S\_n),g\_n \in L^2(I^n)$ such that
<div>
$$\xi=\sum\_{n=0}^{\infty}  f\_n;\quad \xi=\sum\_{n=0}^{\infty} g\_n.$$</div>


*Proof.* The proof is a bit technical but we sketch the main idea which
is to iteratively apply Itô's representation theorem to get
<div>
$$\begin{gathered}
            \xi=\mathbb{E}[\xi]+\int\_I X\_1(t)dW(t\_1)=\mathbb{E}[\xi]+\int\_{I} \mathbb{E}[X\_1(t\_1)] dW(t\_1)\\+ \int\_{I}\int\_{0}^{t\_2} X\_2(t\_1,t\_2) dW(t\_1)dW(t\_2)= \ldots=\sum\_{n=0}^{N}  J\_n(g\_n)+ \int\_{S\_{N+1}} X\_{N+1} dW^{\otimes(N+1)}.
        \end{gathered}$$</div>
 Where
$g\_0=\mathcal{E}[\xi], g\_1(t\_1) =\mathcal{E}[X\_1](t\_1)$ and so on. By an
iteration we deduce that if we write $\phi\_{N+1}$ for the last integral
term, then <div>
$$\mathbb{E}[\phi\_{N+1}]\leq\ldots\leq \mathbb{E}[\xi^2].$$</div>
Furthermore, by Itô's $n$-th isometry we have that the terms in the
above sum are orthogonal so
<div>
$$\|\xi\|\_{L^2(\Omega)}=\sum\_{n=0}^{N} \|J\_n(f\_n)\|\_{L^2(\Omega)} +\|\phi\_{N+1}\|\_{L^2(\Omega)}.$$</div>
Since the last term is bounded, we obtain a bound on the $L^2(\Omega)$
norm of the sum uniform in $n$ so the sum converges. As a result so does
$\phi\_N$ to some $\phi\_\infty$. It suffices to see that $\phi\_\infty=0$.
This can be proved using that, by Itô's $n$-th isometry, $\phi\_{N+1}$ is
orthogonal to $J\_n(h)$ for any $h\in L^2(\Omega)$ and $n\leq N$. As a
result the limit $\phi\_\infty$ is orthogonal to $J\_n(h)$ for all $n$ and
by a density argument (there are a lot of these functions $J\_n(h)$!) we
obtain $\phi\_\infty=0$. This proves the first sum of the theorem.\
\
It remains to prove the second part, but this follows by extending the
$f\_n$ by $0$ on $I^n\setminus S\_n$ and taking $g\_n$ to be the
symmetrization of this extension. ◻



