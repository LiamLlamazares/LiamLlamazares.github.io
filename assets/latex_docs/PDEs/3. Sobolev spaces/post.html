<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Liam Llamazares" />
  <meta name="dcterms.date" content="2023-06-08" />
  <title>Sobolev spaces</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Sobolev spaces</h1>
<p class="author">Liam Llamazares</p>
<p class="date">06/08/2023</p>
</header>
<h1 id="three-line-summary"> Three line summary</h1>
<ul>
<li><p>Given open <span
class="math inline"><em>U</em> ⊂ ℝ<sup><em>d</em></sup></span> the
Sobolev spaces <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
are <strong>complete</strong> spaces of <strong>weakly
differentiable</strong> functions.</p></li>
<li><p><strong>Smooth functions are dense</strong> in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
if <span class="math inline"><em>Ω</em></span> is smooth and bounded.
This lets us perform formal manipulations as if everything is smooth and
then take limits. In particular, we can <strong>extend and
restrict</strong> functions to <span
class="math inline">∂<em>Ω</em></span>.</p></li>
<li><p>Functions in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
enjoy various inequalities. Cashing in differentiability for
integrability we can <strong>compactly embed</strong> <span
class="math display">$$\begin{aligned}
     W^{k,p}(\Omega) \hookrightarrow L^q(\Omega).\end{aligned}$$</span>
Where <span
class="math inline"><em>q</em> ≡ <em>q</em>(<em>d</em>,<em>k</em>,<em>p</em>)</span>
decreases with the dimension <span
class="math inline"><em>d</em></span>, increases with differentiability
<span class="math inline"><em>k</em></span> and integrability <span
class="math inline"><em>p</em></span>, and is larger than <span
class="math inline"><em>p</em></span>.</p></li>
</ul>
<h1 id="why-should-i-care">Why should I care?</h1>
<p>Sobolev spaces allow us to extend the notion of differentiability to
a wider class of functions. The fact that these spaces are complete and
compactly embedded in <span
class="math inline"><em>L</em><sup><em>q</em></sup></span> spaces is an
important tool to extract convergent sub-sequences. This is useful when
solving differential equations as a common technique is to take a Cauchy
sequence whose limit is the solution to the equation.</p>
<h1 id="notation">Notation</h1>
<ul>
<li><p>In this post we will be dealing with functions over a variety of
domains. To facilitate interpretation of the notation we will stick to
the convention that <span class="math inline"><em>K</em></span> is a
compact set, <span class="math inline"><em>U</em>, <em>V</em></span> are
open sets, and <span class="math inline"><em>Ω</em></span> is an open
bounded set with <span class="math inline"><em>C</em><sup>1</sup></span>
boundary.</p></li>
<li><p>Given a topological space <span
class="math inline"><em>X</em></span> and a subset <span
class="math inline"><em>A</em> ⊂ <em>X</em></span> we abbreviate <span
class="math inline"><em>A</em></span> is dense in <span
class="math inline"><em>X</em></span> with the topology of <span
class="math inline"><em>X</em></span> by <span
class="math display">$$\begin{aligned}
              \overline{A}=X.
          \end{aligned}$$</span> We stress that in practice <span
class="math inline"><em>X</em></span> may be itself a subset of some
larger space <span class="math inline"><em>Y</em></span> (for example
<span
class="math inline"><em>X</em> = <em>H</em><sup><em>s</em></sup>(ℝ<sup><em>d</em></sup>)</span>
and <span
class="math inline"><em>Y</em> = <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>)
. However, the above notation will always mean the closure with the
topology of <span class="math inline"><em>X</em></span> and not <span
class="math inline"><em>Y</em></span>.</p></li>
<li><p>A related notation is we will write given <span
class="math inline"><em>a</em><sub><em>n</em></sub> ∈ <em>A</em></span>
<span class="math display">$$\begin{aligned}
              \lim_{n \to \infty}a_n =x \in X.
          \end{aligned}$$</span> To mean the limit in the topology of
<span class="math inline"><em>X</em></span>.</p></li>
<li><p>Given two sets <span
class="math inline"><em>A</em>, <em>B</em></span> we write <span
class="math inline"><em>A</em> ⋐ <em>B</em></span> and say that
<em><span class="math inline"><em>A</em></span> is compactly included in
<span class="math inline"><em>B</em></span></em> if <span
class="math inline">$\overline{A}$</span> is compact and
<em>strictly</em> included in <span
class="math inline"><em>B</em></span>.</p></li>
<li><p>We also write <span class="math display">$$\begin{aligned}
              A+B=\left\{x+y:x \in A, y \in  B\right\} .
          \end{aligned}$$</span></p></li>
<li><p>Given a topological vector space <span
class="math inline"><em>X</em></span> we write <span
class="math inline"><em>X</em>′</span> for the dual of <span
class="math inline"><em>X</em></span> and denote given <span
class="math inline"> ∈ <em>X</em>′, <em>φ</em> ∈ <em>X</em></span> the
duality pairing as <span class="math display">$$\begin{aligned}
              (\varphi,w):= w(\varphi) .
          \end{aligned}$$</span></p></li>
<li><p>We will always write <span class="math inline"><em>α</em></span>
for a multi-index <span
class="math inline"><em>α</em> ∈ ℕ<sup><em>d</em></sup></span> and use
the notation <span class="math display">$$\begin{aligned}
              D^\alpha f := \partial _1^{\alpha_1}\cdots \partial
_d^{\alpha_d}.
          \end{aligned}$$</span> In the case <span
class="math inline"><em>α</em> = 0</span> we use the convention <span
class="math inline"><em>D</em><sup>0</sup> = <em>f</em></span>.</p></li>
<li><p>Given a space of functions <span
class="math inline"><em>X</em></span> with domain <span
class="math inline"><em>A</em></span> and <span
class="math inline"><em>B</em> ⊂ <em>A</em></span> we write <span
class="math display">$$\begin{aligned}
              \left.X\right|_{B}:=\left\{\left.f\right|_{B}: f\in
X\right\} .
          \end{aligned}$$</span></p></li>
<li><p>Given two quantities <span
class="math inline"><em>M</em>, <em>N</em></span> we write <span
class="math inline"><em>M</em> ≲ <em>N</em></span> to mean that there
exists some constant <span class="math inline"><em>C</em></span>
independent of <span class="math inline"><em>M</em></span> and <span
class="math inline"><em>N</em></span> such that <span
class="math inline"><em>M</em> ≤ <em>C</em><em>N</em></span>.</p></li>
<li><p>We write <span
class="math inline"><em>B</em><sub><em>r</em></sub>(<em>x</em>)</span>
for the ball centered at <span class="math inline"><em>x</em></span>
with radius <span class="math inline"><em>r</em></span> and <span
class="math inline"><em>B</em><sub><em>r</em></sub></span> if <span
class="math inline"><em>x</em> = 0</span>. The space where the ball is
contained depending on context.</p></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p>In practice, one often wants to solve a differential equation <span
class="math display">$$\begin{aligned}
\label{PDE1}
    \mathcal{L}u = f\quad  \mathrm{ on  }\quad  D
.\end{aligned}$$</span> Where <span
class="math inline"><em>D</em></span> is some domain in <span
class="math inline">ℝ<sup><em>d</em></sup></span>. In a previous post on
the <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=Sobolev%20spaces-,Sobolev,-spaces%20form%20a">Fourier
transform</a> we saw how to define the Sobolev spaces <span
class="math inline"><em>H</em><sup><em>s</em></sup>(<em>D</em>)</span>
when <span class="math inline"><em>D</em></span> is the whole Euclidean
space <span class="math inline">ℝ<sup><em>d</em></sup></span> or the
torus <span class="math inline">𝕋<sup><em>d</em></sup></span>. These
spaces correspond to <span class="math inline"><em>s</em></span>-times
weakly differentiable functions and we saw how these spaces could help
us solve <a href="#PDE1" data-reference-type="eqref"
data-reference="PDE1">[PDE1]</a>. However, in practice <span
class="math inline"><em>D</em></span> may be an open set in <span
class="math inline">ℝ<sup><em>d</em></sup></span> or even some <span
class="math inline"><em>d</em></span>-dimensional manifold with a
boundary condition <span class="math display">$$\begin{aligned}
\label{bc}
    \left.u\right|_{\partial  D}= g.\end{aligned}$$</span> Note that
equation <a href="#bc" data-reference-type="eqref"
data-reference="bc">[bc]</a> is a priori ill-defined as the Lebesgue
measure of <span
class="math inline">∂<em>D</em> ⊂ ℝ<sup><em>d</em></sup></span> is zero.
Thus, it is necessary to extend the theory to a wider class of domains
and to explain what we mean by the restriction of a function to its
boundary of definition.</p>
<h2 id="a-first-attempt">A first attempt</h2>
<p>Suppose for example <span
class="math inline"><em>D</em> = <em>U</em></span> is an open set and
<span class="math inline"><em>u</em> : <em>U</em> → ℝ</span>. Then, we
can try to define <span
class="math inline"><em>H</em><sup><em>s</em></sup>(<em>U</em>)</span>
using our knowledge of <span
class="math inline"><em>H</em><sup><em>s</em></sup>(ℝ<sup><em>d</em></sup>)</span>
by:</p>
<ol>
<li><p>Extending <span class="math inline"><em>u</em></span> by zero
outside of <span class="math inline"><em>U</em></span> to form <span
class="math display">$$\begin{aligned}
              \tilde{u}(x):=\begin{cases}
                                u(x) &amp; \quad x \in U     \\
                                0    &amp; \quad x \not\in U
                            \end{cases}.
          \end{aligned}$$</span></p></li>
<li><p>Studying if <span
class="math inline"><em>ũ</em> ∈ <em>H</em><sup><em>s</em></sup>(ℝ<sup><em>d</em></sup>)</span>.
That is, as we saw in the <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=fact%2C%20since%20the-,Fourier,-transform%20is%20a">previous
post</a>, checking if <span class="math display">$$\begin{aligned}
\label{nm hs}
              \left\lVert \tilde{u} \right\rVert_{H^s(\mathbb{R}^d)}^2=
\int_{\mathbb{R}^d}\left\langle\xi
\right\rangle^{2s}\widehat{\tilde{u}}(\xi )^2 \,\mathrm{d}\xi &lt;
\infty.
          \end{aligned}$$</span></p></li>
<li><p>Saying that <span
class="math inline"><em>u</em> ∈ <em>H</em><sup><em>s</em></sup>(<em>U</em>)</span>
if and only if <span
class="math inline"><em>ũ</em> ∈ <em>H</em><sup><em>s</em></sup>(ℝ<sup><em>d</em></sup>)</span>.</p></li>
</ol>
<p>However, this runs into problems as is shown in the following
example:</p>
<div class="example">
<p><strong>Example 1</strong>. <em>Let <span
class="math inline"><em>U</em> = (0,1)</span> and take <span
class="math inline"><em>u</em> : (0,1) → ℝ</span> defined to be
identically equal to <span class="math inline">1</span>. Note that <span
class="math inline"><em>u</em> ∈ <em>C</em><sup>∞</sup>(<em>U</em>)</span>
so we expect that <span
class="math inline"><em>u</em> ∈ <em>H</em><sup><em>s</em></sup>((0,1))</span>
for all <span class="math inline"><em>s</em> ∈ ℝ</span>. However, it
holds that <span
class="math inline"><em>ũ</em> = 1<sub>(0,1)</sub></span> with <span
class="math display">$$\begin{aligned}
        \widehat{\tilde{u}}(\xi )=\frac{1-e^{-2 \pi i \xi }}{2 \pi i \xi
}.
    \end{aligned}$$</span></em></p>
</div>
<p>As we can see, by substituting in <a href="#nm hs"
data-reference-type="eqref" data-reference="nm hs">[nm hs]</a>, our
naive definition of <span
class="math inline"><em>H</em><sup><em>s</em></sup>(<em>U</em>)</span>
gives that <span
class="math inline"><em>u</em> ∈ <em>H</em><sup><em>s</em></sup>((0,1))</span>
if and only if <span class="math inline">$s&lt; \frac{1}{2}$</span>.
Thus, our program of extending <span
class="math inline"><em>u</em></span> by zero and studying the
regularity of the extension is not going to work. The reason for this is
that, by extending by zero we introduce a discontinuity on <span
class="math inline"><em>ũ</em></span> at the boundary of <span
class="math inline"><em>U</em></span>.</p>
<h2 id="a-second-approach">A second approach</h2>
<p>Alternatively, we could also define <span
class="math display">$$\begin{aligned}
    H^s(U)= \left.H^s(\mathbb{R}^d)\right|_{U}:=
\left\{\left.f\right|_{u}: f \in H^s(\mathbb{R}^d)\right\}
.\end{aligned}$$</span> As we will see later (Corollary <a
href="#restriction" data-reference-type="ref"
data-reference="restriction">19</a>) this is a better approach. However,
it is not optimal as it requires some conditions on <span
class="math inline"><em>U</em></span>. For example, if <span
class="math inline"><em>U</em></span> is not smooth we cannot assert
that <span
class="math inline"><em>C</em><sup>∞</sup>(ℝ<sup><em>d</em></sup>)|<sub><em>U</em></sub> = <em>C</em><sup>∞</sup>(<em>U</em>)</span>.</p>
<h1 id="test-functions-and-distributions">Test functions and
distributions</h1>
<h2 id="seminorms-and-their-topologies">Seminorms and their
topologies</h2>
<p>We need a new approach. Motivated as in the previous post by <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=is%20called%20the-,duality,-method%20and%20appears">duality</a>
we should begin by defining what is meant by a weak derivative of a
function <span class="math inline"><em>u</em></span> in <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>.
If <span class="math inline"><em>u</em>, <em>φ</em></span> are smooth
functions then we have by integration by parts <span
class="math display">$$\begin{aligned}
    (\varphi, D^\alpha u):= \int_{D} \varphi D^\alpha u  = (-1)^{\left|
\alpha \right| }\int_{D}(D^{\alpha} \varphi) u + \text{ boundary
effects}  .\end{aligned}$$</span> In the previous post, we used that</p>
<ul>
<li><p>If <span
class="math inline"><em>D</em> = ℝ<sup><em>d</em></sup></span> we can
take as our test functions <span
class="math inline"><em>φ</em> ∈ 𝒮(ℝ<sup><em>d</em></sup>)</span> and
use that <span class="math inline"><em>φ</em></span> multiplied by any
function in <span class="math inline"><em>L</em><sup>2</sup></span>
(<span class="math inline"><em>u</em></span> and its derivatives) vanish
at infinity to get rid of the boundary effects.</p></li>
<li><p>If <span
class="math inline"><em>D</em> = 𝕋<sup><em>d</em></sup></span> we can
take as our test functions <span
class="math inline"><em>φ</em> ∈ <em>C</em><sup>∞</sup>(𝕋<sup><em>d</em></sup>)</span>
as the boundary effect of periodic functions cancels out.</p></li>
</ul>
<p>To obtain this cancellation on a general open <span
class="math inline"><em>D</em></span> we need to impose that our test
function <span class="math inline"><em>φ</em></span> vanishes in a
neighborhood of the boundary. That is we need our test functions to have
compact support.</p>
<div class="definition">
<p><strong>Definition 1</strong>. <em>Let <span
class="math inline"><em>U</em></span> be an open set, then we define
<span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
to be the space of smooth functions whose support is some compact set
<span class="math inline"><em>K</em> ⊂ <em>U</em></span>.</em></p>
</div>
<p>Another notation for <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
is <span class="math inline">𝒟(<em>U</em>)</span> and it is often called
the space of <em>test functions</em> for reasons we will later see.
Given a compact subset <span
class="math inline"><em>K</em> ⊂ <em>U</em></span> we define for each
<span class="math inline"><em>k</em> ∈ ℕ</span></p>
<div class="definition">
<p><strong>Definition 2</strong>. <em>Given a compact subset <span
class="math inline"><em>K</em></span> of an open set <span
class="math inline"><em>U</em></span> we define <span
class="math display">$$\begin{aligned}
        C_c^\infty(K):= \left\{\varphi \in C_c^\infty(U):
\mathbf{supp}(\varphi) \subset K \right\} .
    \end{aligned}$$</span> We endow <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>K</em>)</span>
with the <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=together-,with,-a%20countable%20family">topology
generated by the countable family of seminorms</a> <span
class="math display">$$\begin{aligned}
\label{local smooth norms}
        \left\lVert \varphi \right\rVert_{C^k(K)}:= \sup_{x \in K}
\sum_{\left| \alpha \right|\leq k } \left| D^\alpha \varphi \right|,
\quad  k \in \mathbb{N}_{0}
    \end{aligned}$$</span></em></p>
</div>
<p>Later we will need to generate topologies when the family of
seminorms is uncountable.</p>
<div class="definition">
<p><strong>Definition 3</strong>. <em>Let <span
class="math inline"><em>X</em></span> be a vector space and let <span
class="math inline"><em>ρ</em> ∈ 𝒫</span> be a family of seminorms on
<span class="math inline"><em>X</em></span>. Then we define the
<em>topology generated by <span class="math inline">𝒫</span></em> to be
the topology generated by the local basis <span
class="math display"><em>x</em> + {<em>ρ</em><sup>−1</sup>(<em>B</em><sub><em>ϵ</em></sub>):<em>ϵ</em>&gt;0}</span></em></p>
</div>
<p>The above topology is equivalent to the initial topology generated by
the family <span
class="math display">{<em>ρ</em>(⋅−<em>x</em>):<em>x</em>∈<em>X</em>,<em>ρ</em>∈𝒫}.</span>
We include some exercises to help the reader get more used to the
topology that arises. I recommended trying to solve them for a few
minutes before checking the hints.</p>
<div id="TVS ex" class="exercise">
<p><strong>Exercise 1</strong>. <em>Write <span
class="math inline"><em>τ</em><sub>𝒫</sub></span> for the topology
generated by <span class="math inline">𝒫</span>, Show that <span
class="math inline"><em>τ</em><sub>𝒫</sub></span> is the coarsest
topology that makes <span class="math inline"><em>X</em></span> into a
topological vector space (<a
href="https://en.wikipedia.org/wiki/Topological_vector_space">TVS</a>).</em></p>
</div>
<div class="hint">
<p><em>Hint 1</em>. The fact that <span
class="math inline">(<em>X</em>,<em>τ</em><sub>𝒫</sub>)</span> is a TVS
follows from the triangle inequality and homogeneity of seminorms. The
fact that it is the coarsest that makes <span
class="math inline"><em>ρ</em></span> continuous is that <span
class="math inline"><em>ρ</em><sup>−1</sup>(<em>B</em><sub><em>ϵ</em></sub>)</span>
must be an open neighborhood of the origin and in a TVS, by continuity
of the sum, translation of an open set must be open.</p>
</div>
<div id="convex ex" class="exercise">
<p><strong>Exercise 2</strong>. <em>Show that <span
class="math inline">(<em>X</em>,<em>τ</em><sub>𝒫</sub>)</span> is
locally convex. That is, every point has a local basis of convex
sets</em></p>
</div>
<div class="hint">
<p><em>Hint 2</em>. Show that <span
class="math inline"><em>ρ</em><sup>−1</sup>(<em>B</em><sub><em>ϵ</em></sub>)</span>
is convex.</p>
</div>
<div id="convergence TVS" class="exercise">
<p><strong>Exercise 3</strong>. <em>Show that the topology <span
class="math inline">(<em>X</em>,<em>τ</em><sub>𝒫</sub>)</span> is
determined by the following property.</em></p>
<ul>
<li><p><em>Given a <a
href="https://en.wikipedia.org/wiki/Net_(mathematics)#:~:text=%5Bedit%5D-,Any,-function%20whose%20domain">net</a>
<span
class="math inline"><em>x</em><sub>•</sub> ∈ (<em>X</em>,<em>τ</em><sub>𝒫</sub>)</span>
it holds that <span
class="math display">lim <em>x</em><sub>•</sub> = <em>x</em> ∈ <em>X</em> ⇔ <em>ρ</em>(<em>x</em><sub>•</sub>−<em>x</em>) → 0  ∀<em>ρ</em> ∈ 𝒫.</span></em></p></li>
</ul>
</div>
<div class="hint">
<p><em>Hint 3</em>. The topology of any topological space is completely
determined by the convergence of nets. So it is enough to show that the
property holds. The implication holds by the continuity of <span
class="math inline"><em>ρ</em></span>, the reverse follows from being
able to fit <span class="math inline"><em>x</em><sub>•</sub></span> into
any basic set <span
class="math inline"><em>x</em> + <em>ρ</em>(<em>B</em><sub><em>ϵ</em></sub>)</span>.</p>
</div>
<div class="exercise">
<p><strong>Exercise 4</strong>. <em>Show that <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>K</em>)</span>
is complete and thus a <a
href="https://en.wikipedia.org/wiki/Fr%C3%A9chet_space#:~:text=locally%20convex%20metrizable%20topological%20vector%20space">Fréchet</a>
space.</em></p>
</div>
<div class="hint">
<p><em>Hint 4</em>. The topology is <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=together-,with,-a%20countable%20family">metrizable</a>
as the family of seminorms is countable Use Exercise <a
href="#convergence TVS" data-reference-type="ref"
data-reference="convergence TVS">3</a> to show that if <span
class="math inline"><em>φ</em><sub><em>n</em></sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>K</em>)</span>
is Cauchy then the sequence of derivatives <span
class="math inline"><em>D</em><sup><em>α</em></sup><em>φ</em><sub><em>n</em></sub></span>
converge uniformly to <span
class="math inline"><em>φ</em><sup>(<em>α</em>)</sup> ∈ <em>C</em><sub><em>c</em></sub><sup>0</sup>(<em>K</em>)</span>
for all <span class="math inline"><em>α</em></span>. It remains to show
that <span class="math display">$$\begin{aligned}
        \varphi^{(0)}= \lim_{n \to \infty} \varphi_n \in  C_c^\infty(K).
    \end{aligned}$$</span> To do so use the fundamental theorem of
calculus and induction.</p>
</div>
<p>Using <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>K</em>)</span>
as a stepping stone we can build a topology on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>.
We use the approach in <a
href="https://terrytao.wordpress.com/2009/04/19/245c-notes-3-distributions/#:~:text=is%20clearly%20a-,vector,-space.%20Now%20we">Terence
Tao’s blog post on distributions</a>. Let us call a seminorm on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
<em>restrictable</em> if it is a continuous function on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>K</em>)</span>
for all <span class="math inline"><em>K</em> ⊂ <em>U</em></span>.</p>
<div class="definition">
<p><strong>Definition 4</strong>. <em>The topology on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
is the one generated by all the restrictable seminorms on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>.
We call this topology the <em>smooth topology</em>.</em></p>
</div>
<div class="exercise">
<p><strong>Exercise 5</strong>. <em>Give an infinite restrictable family
of seminorms.</em></p>
</div>
<div class="hint">
<p><em>Hint 5</em>. Valid answers include all the <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
and <span
class="math inline"><em>C</em><sup><em>k</em></sup>(<em>U</em>)</span>
norms.</p>
</div>
<div class="exercise">
<p><strong>Exercise 6</strong>. <em>Show that <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>Ω</em>)</span>
with the smooth topology is a locally convex topological vector space
(LCTVS).</em></p>
</div>
<div class="hint">
<p><em>Hint 6</em>. See Exercises <a href="#TVS ex"
data-reference-type="ref" data-reference="TVS ex">1</a>-<a
href="#convex ex" data-reference-type="ref"
data-reference="convex ex">2</a></p>
</div>
<div id="local convergence" class="exercise">
<p><strong>Exercise 7</strong> (Smooth convergence is equal to local
convergence). <em>Show that <span
class="math inline"><em>φ</em><sub><em>n</em></sub> → <em>φ</em> ∈ 𝒟(<em>U</em>)</span>
if and only if there exists a compact set <span
class="math inline"><em>K</em></span> such that for all <span
class="math inline"><em>n</em></span> the support of <span
class="math inline"><em>f</em><sub><em>n</em></sub></span> and <span
class="math inline"><em>f</em></span> are in <span
class="math inline"><em>K</em></span> and <span
class="math display">$$\begin{aligned}
        \lim_{n \to \infty}\varphi_n  =\varphi \in  C_c^\infty(K).
    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 7</em>. Given any sequence <span
class="math inline"><strong>a</strong> = {<em>a</em><sub><em>j</em></sub>}<sub><em>j</em> ∈ ℕ</sub> ∈ ℝ<sub>+</sub></span>
and an increasing set of compact sets <span
class="math inline"><em>K</em><sub><em>j</em></sub></span> with <span
class="math inline"><em>U</em> = ⋃<sub><em>j</em> ∈ ℕ</sub><em>K</em><sub><em>j</em></sub></span>
show that <span class="math display">$$\begin{aligned}
        p_{\mathbf{a}}(\varphi):=\sup _{j \in \mathbb{N}}{a_j}
\sum_{|\alpha| \leq j}\left\lVert D^\alpha \varphi(x)
\right\rVert_{L^\infty(U\setminus K_j)}.
    \end{aligned}$$</span> Is a restrictable seminorm. Why does this
prevent the support of <span
class="math inline"><em>φ</em><sub><em>n</em></sub></span> escaping to
infinity? Now knowing all functions are supported in some <span
class="math inline"><em>K</em></span> use that <span
class="math inline">∥⋅∥<sub><em>C</em><sup><em>k</em></sup>(<em>K</em>)</sub></span>
is restrictable to conclude the proof.</p>
</div>
<div class="exercise">
<p><strong>Exercise 8</strong> (Completeness). <em>Show that <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>Ω</em>)</span>
with the smooth topology is complete.</em></p>
</div>
<div class="hint">
<p><em>Hint 8</em>. Given a Cauchy net <span
class="math inline"><em>φ</em><sub>•</sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
show as in Exercise <a href="#local convergence"
data-reference-type="ref" data-reference="local convergence">7</a> that
the support of <span class="math inline"><em>φ</em><sub>•</sub></span>
cannot escape a compact set <span class="math inline"><em>K</em></span>.
Conclude using the completeness on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>K</em>)</span>
and Exercise <a href="#convergence TVS" data-reference-type="ref"
data-reference="convergence TVS">3</a>.</p>
</div>
<div class="exercise">
<p><strong>Exercise 9</strong>. <em>Show that <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>Ω</em>)</span>
with the smooth topology is Hausdorff.</em></p>
</div>
<div class="hint">
<p><em>Hint 9</em>. The initial topology of a set of functions that
separates points is Hausdorff.</p>
</div>
<div class="observation">
<p><strong>Observation 1</strong>. <em>The topology on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
is <em>not</em> metrizable (note the family of seminorms used to
generate it is not countable) and as a result <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
<strong>is not</strong> a Fréchet space. This and more can be found in
<span class="citation" data-cites="leoni2017first"></span> page
286.</em></p>
</div>
<p>The construction of the topology on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
is a bit technical a more intuitive construction would be to define the
family of seminorms <span class="math display">$$\begin{aligned}
    \left\lVert \varphi \right\rVert_j := \sup_{\left| \alpha \right|
\leq j}  \left\lVert D^\alpha \varphi
\right\rVert_{L^\infty(U)}.\end{aligned}$$</span> And then define the
topology on <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
to be the one generated by this family of seminorms. This has the
following problem.</p>
<div class="exercise">
<p><strong>Exercise 10</strong>. <em>Show that <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
with the topology generated by <span
class="math inline">∥⋅∥<sub><em>j</em></sub></span> is not
complete.</em></p>
</div>
<div class="hint">
<p><em>Hint 10</em>. Construct a sequence that is Cauchy with respect to
every <span class="math inline">∥⋅∥<sub><em>j</em></sub></span> whose
support escapes to infinity.</p>
</div>
<p>Using the smooth topology we can now work with the dual of <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span></p>
<div class="definition">
<p><strong>Definition 5</strong>. <em>We define the space of
<em>distributions</em> to be <span
class="math display">$$\begin{aligned}
        \mathcal{D}'(U):= (C_c^\infty(U))'.
    \end{aligned}$$</span> And give it the <a
href="https://en.wikipedia.org/wiki/Weak_topology">weak-<span
class="math inline">*</span></a> topology.</em></p>
</div>
<div class="observation">
<p><strong>Observation 2</strong>. <em>The inclusions <span
class="math display">$$\begin{aligned}
        C_c^\infty(U) \hookrightarrow C_c^\infty(\mathbb{R}^d)
\hookrightarrow \mathcal{S}(\mathbb{R}^d)
    \end{aligned}$$</span> are continuous. As a result, <span
class="math inline">𝒮′(ℝ<sup><em>d</em></sup>) ↪ 𝒟′(<em>U</em>)</span>.
That is, distributions are a larger or more general class than tempered
distributions.</em></p>
</div>
<p>Of course, not all smooth functions have compact support. Other (in
this case Fréchet) spaces of smooth functions are <span
class="math display">$$\begin{aligned}
    C^\infty(U)                &amp; :=\left\{\varphi: \left\lVert
\varphi \right\rVert_j:= \sup_{\left| \alpha \right| \leq
j}  \left\lVert D^\alpha \varphi
\right\rVert_{L^\infty(U)}&lt;\infty,\quad \forall k \in \mathbb{N}
\right\}                 \\
    C^\infty_{\mathrm{loc}}(U) &amp; :=\left\{\varphi: \left\lVert
\varphi \right\rVert_{k,K}:= \sup_{\left| \alpha \right| \leq
k}  \left\lVert D^\alpha \varphi
\right\rVert_{L^\infty(K)}&lt;\infty,\quad \forall k \in \mathbb{N}, K
\subset U \right\}\end{aligned}$$</span> Where, we give them
respectively the topologies generated by <span
class="math inline">∥⋅∥<sub><em>k</em></sub></span> and <span
class="math inline">∥⋅∥<sub><em>k</em>, <em>K</em></sub></span>.</p>
<p>An equivalent characterization of <span
class="math inline">𝒟′(<em>U</em>)</span> (see <span class="citation"
data-cites="taylor2013partial"></span> page 241 ) is that, <span
class="math inline"><em>ω</em> ∈ 𝒟′(<em>U</em>)</span> if and only if
for all <span
class="math inline"><em>φ</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
the operator <span class="math inline"><em>φ</em><em>w</em></span>
defined by <span class="math display">$$\begin{aligned}
\label{equiv}
    (f, \varphi w):= (\varphi f, w), \quad\forall f \in
C^\infty(U),\end{aligned}$$</span> is continuous on <span
class="math inline"><em>C</em><sup>∞</sup>(<em>U</em>)</span>.</p>
<h2 id="locally-integrable-functions-as-distributions">Locally
integrable functions as distributions</h2>
<p>In our post on the Fourier transform <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=One-,may,-verify%20that%20we">we
saw</a> that integrable functions could naturally be considered as
tempered distributions. The analogous is true for distributions. In this
case, since our test functions are compactly supported, the functions we
pair them up with only need to be locally integrable. We recall the
definition</p>
<div class="definition">
<p><strong>Definition 6</strong>. <em>Given <span
class="math inline"><em>p</em> ∈ [1,∞]</span> we write <span
class="math inline"><em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
for the space of locally <span class="math inline"><em>p</em></span>
integrable functions, <span class="math display">$$\begin{aligned}
        L^p_{\mathrm{loc}}(U):= \left\{f: \left\lVert f
\right\rVert_{L^p(K)}&lt; \infty, \,\text{   for all compact }  K
\subset U\right\}.
    \end{aligned}$$</span> And endow it with the <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=together-,with,-a%20countable%20family">topology
generated by the family of seminorms</a> <span
class="math display">$$\begin{aligned}
        \rho_{K_n,p}(f):= \left\lVert f \right\rVert_{L^p(K_n)}.
    \end{aligned}$$</span> Where <span
class="math inline"><em>K</em><sub><em>n</em></sub></span> are selected
such that <span
class="math inline">⋃<sub><em>n</em> ∈ ℕ</sub><em>K</em><sub><em>n</em></sub> = <em>U</em></span>.</em></p>
</div>
<p>Note that <span
class="math inline"><em>L</em><sub>loc</sub><sup><em>q</em></sup>(<em>U</em>) ⊂ <em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
for all <span class="math inline"><em>q</em> ≤ <em>p</em></span>.</p>
<div class="exercise">
<p><strong>Exercise 11</strong>. <em>Show that <span
class="math inline"><em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
is a Fréchet space.</em></p>
</div>
<div class="hint">
<p><em>Hint 11</em>. The topology is <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=together-,with,-a%20countable%20family">metrizable</a>
as the family of seminorms is countable. By Exercise <a
href="#convergence TVS" data-reference-type="ref"
data-reference="convergence TVS">3</a> if <span
class="math inline"><em>f</em><sub><em>n</em></sub> ∈ <em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
is Cauchy then <span
class="math inline"><em>f</em><sub><em>n</em></sub></span> is Cauchy for
all <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>K</em>)</span>
<span
class="math inline"><em>D</em><sup><em>α</em></sup><em>φ</em><sub><em>n</em></sub></span>
so converges to some <span
class="math inline"><em>f</em><sub><em>K</em></sub> ∈ <em>L</em><sup><em>p</em></sup>(<em>K</em>)</span>.
Show that <span
class="math inline"><em>f</em><sub><em>K</em></sub> = <em>f</em>|<sub><em>K</em></sub></span>
where <span
class="math inline"><em>f</em> ∈ <em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
to conclude the proof.</p>
</div>
<div id="motivation" class="theorem">
<p><strong>Theorem 1</strong> (Locally integrable functions as
distributions). <em>The mapping <span
class="math display">$$\begin{aligned}
        T:L^1_{\mathrm{loc}}(U) &amp; \hookrightarrow  \mathcal{D}'(U)
\\
        u                       &amp; \longmapsto     T_u
        .\end{aligned}$$</span> Defined by <span
class="math display">$$\begin{aligned}
\label{duality}
        (\varphi,T_u):= \int_{U}\varphi u   , \quad\forall \varphi\in
C_c^\infty(U).
    \end{aligned}$$</span> Is injective and continuous.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> We begin by showing that <span
class="math inline"><em>T</em><sub><em>u</em></sub> ∈ 𝒟′(<em>U</em>)</span>.
Firstly, the integral in <a href="#duality" data-reference-type="eqref"
data-reference="duality">[duality]</a> is finite as <span
class="math inline"><em>φ</em></span> has compact support. Secondly, if
we write <span class="math inline"><em>K</em></span> for the support of
<span class="math inline"><em>φ</em></span>, it holds that <span
class="math display">$$\begin{aligned}
        (f,\varphi u)= \int_{K}\varphi f u \leq \left\lVert u
\right\rVert_{L^1(K)} \left\lVert \varphi f \right\rVert_{C^0_c(K)} .
    \end{aligned}$$</span> Which, by our equivalent characterization of
<span class="math inline">𝒟′(<em>U</em>)</span> in <a href="#equiv"
data-reference-type="eqref" data-reference="equiv">[equiv]</a> shows
that <span
class="math inline"><em>T</em><sub><em>u</em></sub> ∈ 𝒟′(<em>U</em>)</span>.
We now show that the identification is injective. That is, if <span
class="math display">$$\begin{aligned}
        \int_{U}\varphi u=0 , \quad\forall \varphi \in C_c^\infty(U) .
    \end{aligned}$$</span> Then <span
class="math inline"><em>u</em> = 0</span>. Consider a compact set <span
class="math inline"><em>K</em> ⊂ <em>U</em></span> and write <span
class="math inline"><em>g</em></span> for the extension of <span
class="math inline">sign(<em>u</em>)</span> by zero outside of <span
class="math inline"><em>K</em></span>. Clearly <span
class="math inline"><em>g</em> ⊂ <em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>.
Consider an approximation to the identity <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub></span> (see Appendix
<a href="#smooth section" data-reference-type="ref"
data-reference="smooth section">12</a> ) and set <span
class="math display">$$\begin{aligned}
        \varphi_n :=  g*\phi_n.
    \end{aligned}$$</span> By the approximation and smoothing of
Propositions <a href="#app pn" data-reference-type="ref"
data-reference="app pn">6</a>-<a href="#smooth"
data-reference-type="ref" data-reference="smooth">7</a> we obtain a
bounded sequence with <span
class="math inline"><em>φ</em><sub><em>n</em></sub> ⊂ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
for <span class="math inline"><em>n</em></span> large enough and such
that <span class="math display">$$\begin{aligned}
        \lim_{n \to \infty}\varphi_n =g \in L^1(\mathbb{R}^d) ; \quad
\left\lVert \varphi_n \right\rVert_{L^\infty(\mathbb{R}^d)} \leq
\left\lVert g \right\rVert_{L^\infty(\mathbb{R}^d)}=1.
    \end{aligned}$$</span> By the first part of the above, we may take a
subsequence <span
class="math inline"><em>φ</em><sub><em>n</em><sub><em>k</em></sub></sub></span>
converging to <span class="math inline"><em>g</em></span> almost
everywhere, and by the second we may apply the dominated convergence
theorem to obtain that <span class="math display">$$\begin{aligned}
        0= \lim_{k \to \infty}\int_{U}\varphi_{n_k} u=\int_{K}\left| u
\right|.
    \end{aligned}$$</span> As a result, <span
class="math inline"><em>u</em> = 0</span> vanishes on <span
class="math inline"><em>K</em></span>. Since <span
class="math inline"><em>K</em></span> was any compact subset of <span
class="math inline"><em>U</em></span> and every open set can be written
as a union of compact sets we conclude that <span
class="math inline"><em>u</em> = 0</span> as desired. The continuity of
<span class="math inline"><em>T</em></span> follows from the estimate
<span class="math display">$$\begin{aligned}
        (\varphi,T_{u} -T_v)\leq \left\lVert \varphi
\right\rVert_{C_c^k(K)}\left\lVert u-v
\right\rVert_{L^1_{\mathrm{loc}}(U)}.
    \end{aligned}$$</span> Where <span
class="math inline"><em>φ</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
has support <span class="math inline"><em>K</em></span> (remember we are
considering the weak-<span class="math inline">*</span> topology on
<span class="math inline">𝒟′(<em>U</em>)</span>). ◻</p>
</div>
<p>Due to the above immersion, we will naturally consider <span
class="math inline"><em>L</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>
as a subspace of <span class="math inline">𝒟′(<em>U</em>)</span>. In
particular, any subspaces of <span
class="math inline"><em>L</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>
such as <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
or <span class="math inline"><em>C</em><sup>∞</sup>(<em>U</em>)</span>
can also be considered as distributions.</p>
<div class="exercise">
<p><strong>Exercise 12</strong>. <em>Show that the <span
class="math inline"><em>L</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>
is not closed in <span class="math inline">𝒟′(<em>U</em>)</span>
.</em></p>
</div>
<div class="hint">
<p><em>Hint 12</em>. Show that an approximation to the identity
converges to a Dirac delta <span
class="math inline"><em>δ</em><sub>0</sub> ∈ 𝒟′(<em>U</em>)</span>.
However <span
class="math inline"><em>δ</em><sub>0</sub> ∉ <em>L</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>.</p>
</div>
<h2 id="support-of-a-distribution">Support of a distribution</h2>
<p>In the continuous case, the support of a function is well-defined as
the smallest closed set outside of which the set is zero. However, when
working with an equivalence class of functions the definition must be
amended (consider for example the support of <span
class="math inline">0 = 1<sub>ℚ</sub></span>). This is resolved by the
following definitions.</p>
<div class="definition">
<p><strong>Definition 7</strong>. <em>We say that a distribution <span
class="math inline"><em>w</em> ∈ 𝒟′(<em>U</em>)</span>
<strong>vanishes</strong> on <span
class="math inline"><em>V</em> ⊂ <em>U</em></span> if <span
class="math display">$$\begin{aligned}
        (\varphi, w)=0 , \quad\forall \varphi \in C_c^\infty(U) \text{
with } \mathbf{supp}(\varphi) \subset V  .
    \end{aligned}$$</span> And write <span
class="math display">$$\begin{aligned}
        w =0 \text{ on } V.
    \end{aligned}$$</span></em></p>
</div>
<p>If a function vanishes on a collection of sets it also vanishes on
their union, this extends to distributions.</p>
<div id="biggest vanish" class="lemma">
<p><strong>Lemma 1</strong>. <em>Let <span
class="math inline">{<em>U</em><sub><em>α</em></sub>}<sub><em>α</em> ⊂ <em>I</em></sub></span>
be a collection of open sets in <span
class="math inline"><em>U</em></span> and suppose that <span
class="math display">$$\begin{aligned}
        w=0 \text{ on  } U_\alpha , \quad\forall \alpha \in I.
    \end{aligned}$$</span> Then <span
class="math inline"><em>w</em></span> vanished on <span
class="math inline"><em>U</em> := ⋃<sub><em>α</em> ∈ <em>I</em></sub><em>U</em><sub><em>α</em></sub></span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline"><em>φ</em></span> have
support in <span class="math inline"><em>U</em></span>. Then, by
compactness, we can extract a finite covering <span
class="math inline">{<em>U</em><sub><em>i</em></sub>}<sub><em>i</em> = 1</sub><sup><em>n</em></sup></span>
of <span
class="math inline"><strong>s</strong><strong>u</strong><strong>p</strong><strong>p</strong>(<em>φ</em>)</span>.
Let <span
class="math inline">{<em>ρ</em><sub><em>i</em></sub>}<sub><em>i</em> = 1</sub><sup><em>n</em></sup></span>
be a partition of unity subordinate to <span
class="math inline"><em>U</em><sub><em>i</em></sub></span> (see Appendix
<a href="#local to global" data-reference-type="ref"
data-reference="local to global">13</a>). Then <span
class="math display">$$\begin{aligned}
        (\varphi,\omega)=\left(\sum_{i=1}^n \rho _i \varphi,w
\right)=\sum_{i=1}^n (\rho _i \varphi,w )=0 .
    \end{aligned}$$</span> Since <span
class="math inline"><em>φ</em></span> was any test function supported in
<span class="math inline"><em>U</em></span> this concludes the
proof. ◻</p>
</div>
<p>By the just proved Lemma <a href="#biggest vanish"
data-reference-type="ref" data-reference="biggest vanish">1</a> we see
that there is a largest set on which <span
class="math inline"><em>w</em></span> vanishes. As a result, we can make
the following definition.</p>
<div id="support def" class="definition">
<p><strong>Definition 8</strong>. <em>Let <span
class="math inline"><em>w</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
and let <span class="math inline"><em>V</em></span> be the largest open
set on which <span class="math inline"><em>w</em></span> vanishes. Then,
we define the <strong>support</strong> of <span
class="math inline"><em>w</em></span> as <span
class="math display">$$\begin{aligned}
        \mathbf{supp}(w)= V^c .
    \end{aligned}$$</span></em></p>
</div>
<p>Since <span
class="math inline"><em>L</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>
is naturally included in <span class="math inline">𝒟′(<em>U</em>)</span>
we obtain in particular the definition of support of a function <span
class="math inline"><em>f</em> ∈ <em>L</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>.</p>
<div class="exercise">
<p><strong>Exercise 13</strong>. <em>If <span
class="math inline"><em>f</em> ∈ <em>L</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>
the support of <span class="math inline"><em>f</em></span> is the
complementary of the largest open set on which <span
class="math inline"><em>f</em></span> is <span
class="math inline">0</span> almost everywhere. In particular, if <span
class="math inline"><em>f</em></span> is continuous, the
(distributional) support of <span class="math inline"><em>f</em></span>
coincides with the classical support of <span
class="math inline"><em>f</em></span>.</em></p>
</div>
<div class="hint">
<p><em>Hint 13</em>. We saw in Theorem <a href="#motivation"
data-reference-type="ref" data-reference="motivation">1</a> that <span
class="math inline"><em>f</em></span> is <span
class="math inline">0</span> almost everywhere on some open set if and
only if it integrates to <span class="math inline">0</span> against any
test function on the open set. This shows the first part and the second
follows immediately.</p>
</div>
<h1 id="sobolev-spaces">Sobolev spaces</h1>
<p>Now that we have built the space of distributions we can define weak
derivatives of test functions just as we did with tempered
distributions.</p>
<div class="definition">
<p><strong>Definition 9</strong>. <em>Given <span
class="math inline"><em>w</em> ∈ 𝒟′(<em>U</em>)</span> we define the
(weak) <span class="math inline"><em>α</em></span>-th derivative by
<span class="math display">$$\begin{aligned}
        (u,D^\alpha \omega):=(-1)^{\left| \alpha \right| }(D^\alpha u,
\omega).
    \end{aligned}$$</span></em></p>
</div>
<div class="exercise">
<p><strong>Exercise 14</strong>. <em>Show that <span
class="math inline"><em>D</em><sup><em>α</em></sup><em>w</em> ∈ 𝒟′(<em>U</em>)</span>.</em></p>
</div>
<div class="hint">
<p><em>Hint 14</em>. Show that <span
class="math inline"><em>D</em><sup><em>α</em></sup></span> is continuous
on <span class="math inline">𝒟(<em>U</em>)</span> by using that <span
class="math inline">∥⋅∥<sub><em>C</em><sup><em>k</em></sup>(<em>U</em>)</sub></span>
are restrictable seminorms. Conclude by using that <span
class="math inline"><em>D</em><sup><em>α</em></sup></span> defined on
<span class="math inline">𝒟′(<em>U</em>)</span> is the <a
href="https://en.wikipedia.org/wiki/Transpose_of_a_linear_map">adjoint</a>
of <span class="math inline"><em>D</em><sup><em>α</em></sup></span>
defined on <span class="math inline">𝒟(<em>U</em>)</span></p>
</div>
<p>A prerequisite for the definition to make sense is that the notion
corresponds to that of classical derivative.</p>
<div class="exercise">
<p><strong>Exercise 15</strong>. <em>Let <span
class="math inline"><em>u</em> ∈ <em>C</em><sub>loc</sub><sup>1</sup>(<em>U</em>)</span>
have classical derivatives <span
class="math inline"><em>u</em><sup>(<em>i</em>)</sup></span>. Then <span
class="math inline"><em>u</em><sup>(<em>i</em>)</sup> = ∂<sub><em>i</em></sub><em>u</em></span>.</em></p>
</div>
<div class="hint">
<p><em>Hint 15</em>. By definition of weak derivatives and the chain
rule, we have the distributional equality <span
class="math display">$$\begin{aligned}
        T_{u^{(i)}}-T_{\partial _i u}=T_{u^{(i)}-\partial _i u}=0 \in
\mathcal{D}'(U)   .
    \end{aligned}$$</span> The result follows by the injectivity of
<span class="math inline"><em>T</em></span>.</p>
</div>
<div id="sobolev def" class="definition">
<p><strong>Definition 10</strong> (Sobolev spaces). <em>Given an open
set <span
class="math inline"><em>U</em> ⊂ ℝ<sup><em>d</em></sup></span>, <span
class="math inline"><em>k</em> ∈ ℕ</span> and <span
class="math inline"><em>p</em> ∈ [1,∞]</span> we define <span
class="math display">$$\begin{aligned}
        W^{k,p}(U):=\left\{ u: D^{\alpha}u \in L^p(U) \hookrightarrow
\mathcal{D}'(\mathbb{R}^d), \quad\forall \left| \alpha \right|\leq
k   \right\} .
    \end{aligned}$$</span> Where <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
is identified as a subspace of <span
class="math inline">𝒟′(<em>U</em>)</span> by Theorem <a
href="#motivation" data-reference-type="ref"
data-reference="motivation">1</a>. We give <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
the norm <span class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{W^{k,p}(U)}&amp;:=\sum_{\left|
\alpha \right|\leq k } \left\lVert D^\alpha u
\right\rVert_{L^p(U)}.        \end{aligned}$$</span></em></p>
</div>
<p>That is, <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
is the space of <span class="math inline"><em>k</em></span>-times
(weakly) differentiable functions with derivatives in <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>.
An equivalent norm that is also sometimes used is <span
class="math display">$$\begin{aligned}
    \left\lVert u \right\rVert_{W^{k,p}(U)}\sim \sum_{j=1}^k \left\lVert
\nabla^j u \right\rVert_{L^p(U\to \mathbb{R}^{d^j})}
.\end{aligned}$$</span></p>
<p>The local Sobolev spaces <span
class="math inline"><em>W</em><sub>loc</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
are defined similarly, where we now only require that <span
class="math display">$$\begin{aligned}
    D^\alpha u \in L^p_{\text{loc}}(U) , \quad\forall \left| \alpha
\right|\leq k .\end{aligned}$$</span> And now generate the topology by
local seminorms analogously to <span
class="math inline"><em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>.</p>
<div class="theorem">
<p><strong>Theorem 2</strong> (Completeness of Sobolev spaces). <em>For
all <span class="math inline"><em>k</em> ∈ ℕ</span> and <span
class="math inline"><em>p</em> ∈ [1,∞]</span> both <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
and <span
class="math inline"><em>W</em><sub>loc</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
are Banach spaces. If <span
class="math inline"><em>p</em> ∈ (1,∞)</span> these spaces are also
reflexive.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span
class="math inline">{<em>u</em><sub><em>n</em></sub>}<sub><em>n</em> = 1</sub><sup>∞</sup></span>
be a Cauchy sequence in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>.
Then, by definition of the norm on <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
the sequence of derivatives <span
class="math inline"><em>D</em><sup><em>α</em></sup><em>u</em><sub><em>n</em></sub></span>
is Cauchy in <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
for each <span class="math inline">|<em>α</em>| ≤ <em>k</em></span> and
since <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
is complete, converge to some functions <span
class="math inline"><em>u</em><sup><em>α</em></sup></span> <span
class="math display">$$\begin{aligned}
        \lim_{n \to \infty} D^\alpha u_n = u^{(\alpha)} \in L^p(U) ,
\quad\forall \left| \alpha \right| \leq k  .
    \end{aligned}$$</span> To conclude, it suffices to show that <span
class="math inline"><em>u</em> := <em>u</em><sup>(0)</sup></span>
verifies <span class="math display">$$\begin{aligned}
        D^\alpha u= u^{(\alpha)}.
    \end{aligned}$$</span> This holds as, for every test function <span
class="math inline"><em>φ</em> ∈ 𝒟(<em>U</em>)</span> <span
class="math display">$$\begin{aligned}
        \int_{U} u^{(\alpha)}\varphi =\lim_{n \to \infty}\int_{U}
u_n^{(\alpha)}\varphi=\lim_{n \to \infty}(-1)^{\left| \alpha \right|
}\int_{U} u_nD^\alpha\varphi=(-1)^{\left| \alpha \right| }\int_{U}
uD^\alpha\varphi  .
    \end{aligned}$$</span> Where the first and last inequality follows
from the continuous immersion of <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
in <span class="math inline">𝒟′(<em>U</em>)</span> (Hölder’s
inequality). Reflexivity follows from the fact that the mapping <span
class="math display">$$\begin{aligned}
        T: W^{k,p}(U) &amp; \longrightarrow (L^p(U))_{\left| \alpha
\right|\leq k }
        \\
        u             &amp; \longmapsto     (D^{\alpha}(u))_{\left|
\alpha \right|\leq k }
        .\end{aligned}$$</span> Is an isometry, so <span
class="math inline"><strong>I</strong><strong>m</strong>(<em>T</em>)</span>
is closed in the reflexive Banach space <span
class="math inline">(<em>L</em><sup><em>p</em></sup>(<em>U</em>))<sub>|<em>α</em>| ≤ <em>k</em></sub></span>
and thus reflexive (see <span class="citation"
data-cites="brezis2011functional"></span> page 70). The case of <span
class="math inline"><em>W</em><sub>loc</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
is proved identically now working with the local seminorms. ◻</p>
</div>
<p>We now show some relevant properties of the weak derivative all of
which are to be expected knowing the classical case. These can be
greatly generalized with tools we will later develop.</p>
<div id="properties" class="proposition">
<p><strong>Proposition 1</strong> (Properties). <em>Let <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>.
Then it holds that</em></p>
<ol>
<li><p><em>Leibniz rule: given <span
class="math inline"><em>φ</em> ∈ <em>C</em><sup>1</sup>(<em>U</em>)</span>
it holds that <span class="math display">$$\begin{aligned}
                  \partial _{i} (u \varphi)= \partial_i u \varphi+ u
\partial _i \varphi .
              \end{aligned}$$</span></em></p></li>
<li><p><em>The translation <span
class="math inline"><em>τ</em><sub><em>y</em></sub><em>u</em>(<em>x</em>) := <em>u</em>(<em>x</em>−<em>y</em>) ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
with <span
class="math inline"><em>D</em><sup><em>α</em></sup><em>τ</em><sub><em>y</em></sub><em>u</em> = <em>τ</em><sub><em>y</em></sub><em>D</em><sup><em>α</em></sup><em>u</em></span>.</em></p></li>
<li><p><em>Let <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
and <span
class="math inline"><em>v</em> ∈ <em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>.
Then <span class="math display">$$\begin{aligned}
                  D^\alpha (v*u)= v* D^\alpha u
              \end{aligned}$$</span></em></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> Points 1 and 2 follow by the definition of weak
derivative and the relevant properties for classical derivatives. The
third property follows from the second as, by Fubini, <span
class="math display">$$\begin{aligned}
         &amp; (v*u,D^\alpha\varphi )  =
\int_{\mathbb{R}^d}v(y)\left(\int_{\mathbb{R}^d}D^\alpha \varphi(x)
u(x-y) \,\mathrm{d}x \right) \,\mathrm{d}y \\&amp;
        =(-1)^{\left| \alpha \right| }
\int_{\mathbb{R}^d}v(y)  \left(\int_{\mathbb{R}^d}\varphi(x) D^\alpha
u(x-y) \,\mathrm{d}x \right) \,\mathrm{d}y             =(-1)^{\left|
\alpha \right| }(v*D^\alpha u, \varphi).
    \end{aligned}$$</span> ◻</p>
</div>
<p>A natural question is what relationship there is between Sobolev
functions and classical derivatives. For example, in <span
class="math inline">1</span> dimension a classical result is that <span
class="math inline"><em>u</em> ∈ <em>W</em><sup>1, 1</sup>(<em>a</em>,<em>b</em>)</span>
if and only if <span class="math inline"><em>u</em></span> is absolutely
continuous and has derivative almost everywhere. A more general result
is as follows.</p>
<div class="proposition">
<p><strong>Proposition 2</strong> (Absolute continuity on lines).
<em>The following are equivalent</em></p>
<ul>
<li><p><em><span
class="math inline"><em>u</em> ∈ <em>W</em><sub>loc</sub><sup>1, <em>p</em></sup>(<em>U</em>)</span>.</em></p></li>
<li><p><em><span
class="math inline"><em>u</em> ∈ <em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
is almost everywhere differentiable with classical derivatives <span
class="math inline"><em>u</em><sup>(<em>i</em>)</sup> ∈ <em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
and, given <span class="math inline"><em>V</em> ⋐ <em>U</em></span> it
holds that <span class="math inline"><em>u</em></span> is absolutely
continuous on almost all (with respect to the Lebesgue measure on <span
class="math inline">ℝ<sup><em>d</em> − 1</sup></span>) line segments in
<span class="math inline"><em>V</em></span> parallel to the coordinate
axis.</em></p></li>
</ul>
<p><em>The above holds true if we replace <span
class="math inline"><em>W</em><sub>loc</sub><sup>1, <em>p</em></sup>(<em>U</em>), <em>L</em><sub>loc</sub><sup><em>p</em></sup>(<em>U</em>)</span>
with their none local counterparts <span
class="math inline"><em>W</em><sup>1, <em>p</em></sup>(<em>U</em>), <em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>.</em></p>
</div>
<p>We omit the proof which can be found in <span class="citation"
data-cites="Juha"></span> pages <span
class="math inline">39 − 43</span>. The next exercise show that, perhaps
somewhat unexpectedly, to have <span
class="math inline"><em>u</em> ∈ <em>W</em><sup>1, <em>p</em></sup>(<em>U</em>)</span>
it is not sufficient to require that <span
class="math inline"><em>u</em></span> is differentiable almost
everywhere with integrable derivatives.</p>
<div class="example">
<p><strong>Example 2</strong>. <em>The <a
href="https://en.wikipedia.org/wiki/Cantor_function">devil’s
staircase</a> <span class="math inline"><em>c</em></span> is
differentiable almost everywhere with <span
class="math inline"><em>c</em>′ = 0</span>.</em></p>
</div>
<p>As a result, if <span
class="math inline"><em>c</em> ∈ <em>W</em><sup>1, <em>p</em></sup>(0,1)</span>
then <span class="math inline"><em>u</em></span> would be constant
(which it is not). In fact, <span
class="math inline"><em>c</em> ∉ <em>W</em><sup>1, <em>p</em></sup>(0,1)</span>
as it is not absolutely continuous.</p>
<h1 id="smooth-approximation-of-sobolev-functions">Smooth approximation
of Sobolev functions</h1>
<p>The definition of weak derivative requires one to integrate against
smooth functions whenever trying to prove some property holds. This is
somewhat cumbersome. One would much rather</p>
<ol>
<li><p>Work pretending all Sobolev functions are (classically)
smooth.</p></li>
<li><p>Manipulate them according to the standard rules of
calculus.</p></li>
<li><p>Obtain a result that holds for all Sobolev functions (and not
just the classically smooth ones).</p></li>
</ol>
<p>This process can be rigorously justified by the density of various
spaces of smooth functions in Sobolev spaces. Or to use Tao’s
terminology, by giving ourselves <a
href="https://terrytao.wordpress.com/2009/02/28/tricks-wiki-give-yourself-an-epsilon-of-room/">an
epsilon of room</a>.</p>
<p>In this section, we prove the relevant results. These rely heavily on
the analogous density results for functions in <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
(see Appendix <a href="#smooth section" data-reference-type="ref"
data-reference="smooth section">12</a>). As a result, they will not when
<span class="math inline"><em>p</em> = ∞</span>. We start without making
any assumptions on <span class="math inline"><em>U</em></span> and
obtain two local-type results. Throughout this section we will often be
switching between different open sets and, if following the proofs,
making some drawings is recommended.</p>
<div id="local" class="theorem">
<p><strong>Theorem 3</strong> (Local approximation by smooth functions).
<em>Let <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
for <span class="math inline"><em>p</em> &lt; ∞</span>, denote its
extension by zero <span class="math inline"><em>ũ</em></span> and let
<span
class="math inline">{<em>ϕ</em><sub><em>n</em></sub>}<sub><em>n</em> = 1</sub><sup>∞</sup></span>
be an approximation to unity. Then <span
class="math display">$$\begin{aligned}
        u=\lim_{n \to \infty} \tilde{u}*\phi_n  \in W^{k,p}(V) ,
\quad\forall V \Subset U.
    \end{aligned}$$</span> As a result, for any <span
class="math inline"><em>V</em> ⋐ <em>U</em></span>, <span
class="math display">$$\begin{aligned}
        \overline{\left.C_c^\infty(\mathbb{R}^d)\right|_{V}}=\left.W^{k,p}(U)\right|_{V}\quad
\text{ and } \quad
\overline{\left.C_c^\infty(\mathbb{R}^d)\right|_{U}}=W_{\mathrm{loc}}^{k,p}(U)
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Given a compactly embedded set <span
class="math inline"><em>V</em> ⋐ <em>U</em></span> we can take <span
class="math inline"><em>n</em></span> large enough so that <span
class="math inline">$V+  B \left(0, \frac{1}{n}\right) \subset U$</span>
and as a result, the convolution <span
class="math inline"><em>φ</em><sub><em>n</em></sub> := <em>ũ</em> * <em>ϕ</em><sub><em>n</em></sub></span>
verifies (see Observation <a href="#local smoothing"
data-reference-type="ref" data-reference="local smoothing">6</a>) <span
class="math display">$$\begin{aligned}
        \varphi_n= u* \phi_n \quad  \text{ on  } V .
    \end{aligned}$$</span> Thus, by the third property <a
href="#properties" data-reference-type="ref"
data-reference="properties">1</a>, for all <span
class="math inline">|<em>α</em>| ≤ <em>k</em></span> <span
class="math display">$$\begin{aligned}
        D^\alpha \varphi_n = D^\alpha u * \phi_n \quad \text{ on } V.
    \end{aligned}$$</span> Taking limits we conclude from Proposition <a
href="#app pn" data-reference-type="ref" data-reference="app pn">6</a>
that <span class="math display">$$\begin{aligned}
        \lim_{n \to \infty}D^\alpha \varphi_n =D^\alpha u \in L^p(V) .
    \end{aligned}$$</span> To conclude density of <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)|<sub><em>V</em></sub></span>
consider <span class="math inline"><em>K</em></span> such that <span
class="math display">$$\begin{aligned}
        V \subset K; \quad  K+ B_{1 /n}\subset U.
    \end{aligned}$$</span> And a bump function <span
class="math inline"><em>η</em><sub><em>V</em></sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
that is equal to <span class="math inline">1</span> on <span
class="math inline"><em>V</em></span> and is supported in <span
class="math inline"><em>K</em></span> (this is possible by Uryshon’s
lemma and a convolution). Then, <span
class="math display">$$\begin{aligned}
        \varphi_{V,n}:= \varphi_n \eta _V \in C_c^\infty(\mathbb{R}^d);
\quad \lim_{n \to \infty}\varphi_{V,n}=u \in W^{k,p}(V).
    \end{aligned}$$</span> The density of <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
in <span
class="math inline"><em>W</em><sub>loc</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
follows by taking <span
class="math inline"><em>V</em><sub><em>n</em></sub></span> converging to
<span class="math inline"><em>U</em></span> and <span
class="math inline"><em>u</em><sub><em>n</em></sub> := <em>φ</em><sub><em>V</em><sub><em>n</em></sub>, <em>n</em></sub></span>
as then, for every compactly included <span
class="math inline"><em>W</em> ⋐ <em>U</em></span> <span
class="math display">$$\begin{aligned}
        \lim_{n \to \infty}u_{n}=u \in W^{k,p}(W) .
    \end{aligned}$$</span> This concludes the proof as by Exercise <a
href="#convergence TVS" data-reference-type="ref"
data-reference="convergence TVS">3</a> local convergence is equivalent
to convergence on every compactly included subset. ◻</p>
</div>
<div class="observation">
<p><strong>Observation 3</strong>. <em>Note that, without further
assumptions on <span class="math inline"><em>U</em></span> it is
impossible to get a global approximation by smooth functions defined on
all of <span class="math inline">ℝ<sup><em>d</em></sup></span>. This is
because, the convolution <span
class="math inline"><em>f</em> * <em>ϕ</em><sub><em>n</em></sub></span>
can only be defined on <span class="math display">$$\begin{aligned}
        U_{1/n}:= \left\{x \in U: d(x,\partial U)&gt;
\frac{1}{n}\right\} .
    \end{aligned}$$</span></em></p>
</div>
<p>The above issue disappears when <span
class="math inline"><em>U</em> = ℝ<sup><em>d</em></sup></span>. This
shows that</p>
<div id="approx rd" class="theorem">
<p><strong>Theorem 4</strong> (Global approximation in <span
class="math inline">ℝ<sup><em>d</em></sup></span>). <em>It holds that
for all <span class="math inline"><em>p</em> &lt; ∞</span>, <span
class="math display">$$\begin{aligned}
        \overline{C_c^\infty(\mathbb{R}^n)}=W^{k,p}(\mathbb{R}^d).
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span
class="math inline"><em>η</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
be equal to <span class="math inline">1</span> on <span
class="math inline"><em>B</em><sub>1</sub></span> and set <span
class="math inline"><em>η</em><sub><em>n</em></sub>(<em>x</em>) := <em>η</em>(<em>x</em>/<em>n</em>)</span>.
Then, given <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(ℝ<sup><em>n</em></sup>)</span>
and a smooth approximation to unity <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub></span> we obtain
that, by the triangle inequality <span
class="math display">$$\begin{aligned}
        u= \lim_{n \to \infty}(u*\phi_n)\eta  _n \in
W^{k,p}(\mathbb{R}^d).
    \end{aligned}$$</span> ◻</p>
</div>
<p>The following Theorem shows a global-type approximation.</p>
<div id="Meyers" class="theorem">
<p><strong>Theorem 5</strong> (Meyers-Serrin: local till boundary
approximation). <em>Let <span
class="math inline"><em>U</em> ⊂ ℝ<sup><em>d</em></sup></span> be open,
then for all <span class="math inline"><em>p</em> &lt; ∞</span> <span
class="math display">$$\begin{aligned}
        \overline{C^\infty_{\mathrm{loc}}(U)\cap W^{k,p}(U)}=W^{k,p}(U).
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The proof is an instructive way of using a partition
of unity to piece together a local result (in this case Theorem <a
href="#local" data-reference-type="ref" data-reference="local">3</a>) to
get a global one. Let <span class="math inline"><em>ϵ</em> &gt; 0</span>
and consider an open covering <span
class="math inline">{<em>V</em><sub><em>i</em></sub>}<sub><em>i</em> = 0</sub><sup>∞</sup></span>
of <span class="math inline"><em>U</em></span> with <span
class="math inline"><em>V</em><sub>0</sub> = ∅</span> and <span
class="math inline"><em>V</em><sub><em>i</em></sub> ⋐ <em>V</em><sub><em>i</em> + 1</sub></span>.
By Theorem <a href="#partition" data-reference-type="ref"
data-reference="partition">17</a> we may obtain a partition of unity
<span class="math inline"><em>ρ</em><sub><em>i</em></sub></span>
subordinate to the “rings” <span class="math inline">$U_{i}:=
V_{i+1}\setminus \overline{V_{i-1}}$</span> (the trickery with the
indices is so that the <span
class="math inline"><em>U</em><sub><em>i</em></sub></span> actually
cover <span class="math inline"><em>U</em></span>). Where we relabel so
that <span class="math display">$$\begin{aligned}
        \mathbf{supp}(\rho _i)\subset U_i .
    \end{aligned}$$</span> We have that <span
class="math inline"><em>ρ</em><sub><em>i</em></sub><em>u</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>V</em><sub><em>i</em> + 1</sub>)</span>
with <span
class="math inline"><em>V</em><sub><em>i</em> + 1</sub> ⋐ <em>U</em></span>
so by the local approximation in Theorem <a href="#local"
data-reference-type="ref" data-reference="local">3</a> we can find <span
class="math inline"><em>n</em><sub><em>i</em></sub></span> such that
<span class="math display">$$\begin{aligned}
        \left\lVert \phi_{n_i}*(\rho_i u)-\rho_i u
\right\rVert_{W^{k,p}(U)}=\left\lVert \phi_{n_i}*(\rho_i u)-\rho_i u
\right\rVert_{V_{i+1}}\leq \frac{\epsilon }{2^i} .
    \end{aligned}$$</span> Now we obtain the global approximation by
taking <span class="math display">$$\begin{aligned}
        \varphi:= \sum_{i=1}^\infty \phi_{n_i}* (\rho_i u) \in
C_{\mathrm{loc}}^\infty(U) .
    \end{aligned}$$</span> As then <span
class="math display">$$\begin{aligned}
        \left\lVert \varphi-u \right\rVert
        _{W^{k,p}(U)}\leq\sum_{i=1}^\infty \left\lVert
\phi_{n_i}*(\rho_i u)-\rho_i u  \right\rVert_{W^{k,p}(U)}\leq
\sum_{i=1}^\infty \frac{\epsilon }{2^i}=\epsilon   .
    \end{aligned}$$</span> ◻</p>
</div>
<p>Note that Theorem <a href="#Meyers" data-reference-type="ref"
data-reference="Meyers">5</a> is not strictly stronger than theorem <a
href="#local" data-reference-type="ref" data-reference="local">3</a> as
it is not, in general, possible to extend functions in <span
class="math inline"><em>C</em><sub>loc</sub><sup>∞</sup>(<em>U</em>)</span>
to <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>n</em></sup>)</span>.
As a corollary of Meyers-Serrin’s theorem, we obtain an equivalent
definition of <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>.</p>
<div id="eq def" class="exercise">
<p><strong>Exercise 16</strong>. <em>Let <span
class="math inline"><em>U</em> ⊂ ℝ<sup><em>d</em></sup></span> be an
open set and <span class="math inline"><em>p</em> &lt; ∞</span>. Then
<span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
is equal to the completion of <span
class="math inline"><em>C</em><sub>loc</sub><sup>∞</sup>(<em>U</em>) ∩ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
with the <span
class="math inline">∥⋅∥<sub><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</sub></span>
norm.</em></p>
</div>
<div class="hint">
<p><em>Hint 16</em>. Use that <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
is complete and that the completion of a metric space is unique.</p>
</div>
<p>Before Theorem <a href="#Meyers" data-reference-type="ref"
data-reference="Meyers">5</a> was proved, both our original definition
<a href="#sobolev def" data-reference-type="ref"
data-reference="sobolev def">10</a> (distributions with derivatives in
<span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>)
and the one in Corollary <a href="#eq def" data-reference-type="ref"
data-reference="eq def">16</a> (closure of smooth functions with Sobolev
norm) were used as the definition of <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>.
But it was unclear which was the “correct” Sobolev space. This debate
was settled by Meyers and Serrin who proved that, as we just showed,
both are equal.</p>
<p>We now show an example of how these kinds of density results can be
useful. The following generalizes the second point of Proposition <a
href="#properties" data-reference-type="ref"
data-reference="properties">1</a></p>
<div id="change of variables" class="exercise">
<p><strong>Exercise 17</strong> (Change of variables). <em>Let <span
class="math inline"><em>V</em>, <em>U</em></span> be open in <span
class="math inline">ℝ<sup><em>d</em></sup></span> and <span
class="math inline"><em>Φ</em> : <em>V</em> ≃ <em>U</em></span> be
bijective with <span
class="math inline"><em>Φ</em> ∈ <em>C</em><sup><em>k</em></sup>(<em>V</em>→ℝ<sup><em>d</em></sup>), <em>Φ</em><sup>−1</sup> ∈ <em>C</em><sup>1</sup>(<em>U</em>→ℝ<sup><em>d</em></sup>)</span>.
Then for any <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
it holds that <span
class="math inline"><em>u</em> ∘ <em>Φ</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>V</em>)</span>
and the usual chain rule holds. For example <span
class="math display">$$\begin{aligned}
\label{chain}
        \partial _i (u\circ \Phi) = \sum_{j=1}^d (\partial _i
\Phi_j)(\partial _j u_j)\circ \Phi_j  .
    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 17</em>. Give yourself an <span
class="math inline"><em>ϵ</em></span> of room. By induction, it suffices
to consider the case <span class="math inline"><em>k</em> = 1</span>.We
can approximate <span class="math inline"><em>u</em></span> on each
compact <span class="math inline"><em>K</em> ⊂ <em>U</em></span> by a
sequence of functions <span
class="math inline"><em>u</em><sub><em>n</em></sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>.
For <span class="math inline"><em>u</em><sub><em>n</em></sub></span> the
equality <a href="#chain" data-reference-type="ref"
data-reference="chain">[chain]</a> holds. Furthermore, by a change of
variables, <a href="#chain" data-reference-type="eqref"
data-reference="chain">[chain]</a> is continuous in <span
class="math inline"><em>u</em> ∈ <em>W</em><sup>1, <em>p</em></sup>(<em>Ω</em>)</span>
so we may pass to the limit and obtain <a href="#chain"
data-reference-type="eqref" data-reference="chain">[chain]</a> for <span
class="math inline"><em>u</em></span> on <span
class="math inline"><em>K</em></span>. Since <span
class="math inline"><em>K</em></span> was any, the equality also holds
on the whole of <span class="math inline"><em>U</em></span>.</p>
</div>
<p>In Exercise <a href="#change of variables" data-reference-type="ref"
data-reference="change of variables">17</a> it is important that <span
class="math inline"><em>Φ</em></span> is diffeomorphic so that
composition with <span class="math inline"><em>Φ</em></span> is
continuous.</p>
<div class="exercise">
<p><strong>Exercise 18</strong>. <em>Show that the conclusion of
Exercise <a href="#change of variables" data-reference-type="ref"
data-reference="change of variables">17</a> is false if we only assume
that <span
class="math inline"><em>Φ</em> ∈ <em>C</em><sup><em>k</em></sup>(ℝ<sup><em>d</em></sup>)</span>
and do not impose invertibility.</em></p>
</div>
<div class="hint">
<p><em>Hint 18</em>. Divide by zero.</p>
</div>
<p>Now we provide a final global approximation result in the case where
the domain is smooth (see Appendix <a href="#boundary"
data-reference-type="ref" data-reference="boundary">14</a> for a review
on manifolds with boundary) and bounded.</p>
<div id="global" class="theorem">
<p><strong>Theorem 6</strong> (Global, smooth on boundary
approximation). <em>Let <span class="math inline"><em>Ω</em></span> be a
<strong>bounded</strong> open domain with <strong><span
class="math inline"><em>C</em><sup>1</sup></span> boundary</strong>,
then for all <span class="math inline"><em>p</em> &lt; ∞</span>. <span
class="math display">$$\begin{aligned}
        \overline{\left.C_c^\infty(\mathbb{R}^d)\right|_{\Omega}}=
W^{k,p}(\Omega).
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The idea will be to locally translate points close to
the boundary further into <span class="math inline"><em>Ω</em></span> so
that we can convolve with an approximation of unity and then recover the
global case with a partition of unity. We begin by “straightening the
boundary”. That is, since <span class="math inline">∂<em>Ω</em></span>
is <span class="math inline"><em>C</em><sup>1</sup></span>, given <span
class="math inline"><em>x</em><sub>0</sub> ∈ ∂<em>Ω</em></span> there
exists an open set <span
class="math inline"><em>V</em> ⊂ ℝ<sup><em>d</em></sup></span> and a
function <span
class="math inline"><em>γ</em> ∈ <em>C</em><sup>1</sup>(ℝ<sup><em>d</em> − 1</sup>)</span>
such that, relabeling and flipping the last coordinate axis if necessary
<span class="math display">$$\begin{aligned}
        V \cap \Omega = \left\{x \in V :x_d  &gt;\gamma
(x_1,\ldots,x_{d-1})\right\}  .
    \end{aligned}$$</span> By considering a translation in the last
coordinate <span
class="math inline"><em>e</em><sub><em>d</em></sub> = (0,…,0,1)</span>
and its mollification by an approximation of unity <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub></span> <span
class="math display">$$\begin{aligned}
        u_n(x):= u\left(x+ \frac{2}{n}e_d \right); \quad \varphi_n:= u_n
*\phi_n .
    \end{aligned}$$</span> For <span
class="math inline"><em>n</em></span> big enough we have that <span
class="math inline"><em>φ</em></span> is well defined ans smooth on
<span class="math inline">$W_0:=B_{\frac{1}{n}}(x_0)$</span>. Since
translation is continuous on <span
class="math inline"><em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
for <span class="math inline"><em>p</em> ∈ [1, ∞)</span> and by the
behavior of differentiation with convolution (see Proposition <a
href="#properties" data-reference-type="ref"
data-reference="properties">1</a>), for <span
class="math inline"><em>n</em></span> large enough <span
class="math display">$$\begin{aligned}
        \left\lVert u -\varphi_n \right\rVert_{W^{k,p}(W_0)}\leq
\left\lVert u -u_n \right\rVert_{W^{k,p}(W_0)}+\left\lVert u_n
-u_n*\phi_n \right\rVert_{W^{k,p}(W_0)}\leq \epsilon.
    \end{aligned}$$</span> Now, since <span
class="math inline"><em>Ω</em></span> is bounded <span
class="math inline">∂<em>Ω</em></span> is compact we may extract a
finite covering <span
class="math inline">$\left\{W_i:=B_{\frac{1}{n_i}}(x_i)\right\}_{i=0}^n$</span>
of <span class="math inline">∂<em>Ω</em></span> and functions <span
class="math inline">{<em>φ</em><sub><em>i</em></sub>}<sub><em>i</em> = 1</sub><sup><em>n</em></sup></span>
smooth on <span
class="math inline"><em>W</em><sub><em>i</em></sub></span> such that
<span class="math display">$$\begin{aligned}
        \left\lVert u -\varphi_n \right\rVert_{W^{k,p}(W_i)}\leq
\frac{\epsilon}{n+2}  .
    \end{aligned}$$</span></p>
<p>Now we take an open set <span
class="math inline"><em>W</em><sub><em>n</em> + 1</sub> ⋐ <em>Ω</em></span>
such that <span
class="math inline">{<em>W</em><sub><em>i</em></sub>}<sub><em>i</em> = 0</sub><sup><em>n</em> + 1</sup></span>
cover <span class="math inline"><em>Ω</em></span>. By the local
approximation of Theorem <a href="#local" data-reference-type="ref"
data-reference="local">3</a> we know we can approximate <span
class="math inline"><em>u</em></span> on <span
class="math inline"><em>W</em><sub><em>n</em> + 1</sub></span> by some
<span
class="math inline"><em>φ</em><sub><em>n</em> + 1</sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
<span class="math display">$$\begin{aligned}
        \left\lVert u-\varphi_{n+1}
\right\rVert_{W^{k,p}(W_{n+1})}\leq\frac{\epsilon}{n+2} .
    \end{aligned}$$</span> Finally, we take a smooth partition of unity
<span
class="math inline">{<em>ρ</em><sub><em>i</em></sub>}<sub><em>i</em> = 0</sub><sup><em>n</em> + 1</sup></span>
subordinate to <span
class="math inline">{<em>W</em><sub><em>i</em></sub>}<sub><em>i</em> = 0</sub><sup><em>n</em> + 1</sup></span>
and a bump function <span
class="math inline"><em>η</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
which is equal to <span class="math inline">1</span> on <span
class="math inline"><em>Ω</em></span> and is supported on <span
class="math inline">$\bigcup_{i=0}^{n+1} W_i$</span> (see example <a
href="#bump example2" data-reference-type="ref"
data-reference="bump example2">5</a>) and set <span
class="math display">$$\begin{aligned}
        \varphi:= \eta \sum_{i=0}^{n+1} \rho _i \varphi_i
\in  C^\infty_c(\Omega) .
    \end{aligned}$$</span> This gives the desired approximation <span
class="math display">$$\begin{aligned}
        \left\lVert u-\varphi \right\rVert_{W^{k,p}(\Omega)} \leq
\sum_{i=0}^{n+1} \left\lVert \rho _i(u-\varphi_i)
\right\rVert_{W^{k,p}(W_i)} \leq  \epsilon  .
    \end{aligned}$$</span> This concludes the proof. ◻</p>
</div>
<p>In contrast to Theorem <a href="#Meyers" data-reference-type="ref"
data-reference="Meyers">5</a>, Theorem <a href="#global"
data-reference-type="ref" data-reference="global">6</a> shows that
Sobolev functions on smooth bounded domains can be approximated by
functions that are also <em>smooth on the boundary</em> of the domain
<span class="math inline"><em>Ω</em></span>. This will prove fundamental
in the next section. Both to extend them to the whole of <span
class="math inline">ℝ<sup><em>d</em></sup></span> and to restrict them
to <span class="math inline">∂<em>Ω</em></span>.</p>
<h1 id="extension section">Extensions and restrictions</h1>
<p>Using the approximation of Sobolev functions by functions smooth on
the boundary we can extend functions in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
to the whole of <span class="math inline">ℝ<sup><em>d</em></sup></span>.
However, the extension is not unique.</p>
<div id="extension" class="theorem">
<p><strong>Theorem 7</strong> (Extension theorem). <em>Let <span
class="math inline"><em>Ω</em> ⊂ ℝ<sup><em>d</em></sup></span> be a
<strong>bounded</strong> open set with <strong><span
class="math inline"><em>C</em><sup><em>k</em></sup></span></strong>
<strong>boundary</strong> where <span
class="math inline"><em>k</em> ∈ ℕ<sub>+</sub></span>. Then for all
<span class="math inline"><em>p</em> ∈ [1, ∞)</span> . Then, given an
open set <span class="math inline"><em>W</em></span> with <span
class="math inline"><em>Ω</em> ⋐ <em>W</em></span> there exists a
continuous operator <span class="math display">$$\begin{aligned}
        E: W^{k,p}(\Omega)\to W^{k,p}(\mathbb{R}^d); \quad E:
C^{k}(\Omega)\to C^k(\mathbb{R}^d).
    \end{aligned}$$</span> such that <span
class="math display">$$\begin{aligned}
        Eu = \begin{cases}
                 u \quad &amp; \text{ on  }  \Omega \\
                 0 \quad &amp; \text{ on }  W^c
             \end{cases}.
    \end{aligned}$$</span> We call <span
class="math inline"><em>E</em><em>u</em></span> an
<strong>extension</strong> of <span
class="math inline"><em>u</em></span> to <span
class="math inline">ℝ<sup><em>n</em></sup></span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> We work first in the upper half-space (the canonical
example of a manifold with boundary) <span
class="math display">$$\begin{aligned}
        \mathcal{H}^d =\left\{x=(x_1,\ldots,x_d) \in \mathbb{R}^d : x_d
\geq 0\right\} .
    \end{aligned}$$</span> That is, we suppose that there is some open
set <span
class="math inline"><em>Ω</em>′ ⊂ ℝ<sup><em>d</em></sup></span> such
that <span class="math display">$$\begin{aligned}
        \Omega=\Omega' \cap \mathcal{H}^d_{&gt;0}.
    \end{aligned}$$</span> Where <span
class="math display">$$\begin{aligned}
            \quad \mathcal{H}^d_{&gt;0}
=\mathrm{int}(\mathcal{H}^d)=\left\{x=(x_1,\ldots,x_d) \in \mathbb{R}^d
: x_d &gt;0\right\} .
    \end{aligned}$$</span> By Theorem <a href="#global"
data-reference-type="ref" data-reference="global">6</a> we also give
ourselves an epsilon of room by supposing that <span
class="math inline">$u \in C^k(\overline{\Omega})$</span>. We define the
extension of <span class="math inline"><em>u</em></span> to <span
class="math inline"><em>Ω</em>′</span> as <span
class="math display">$$\begin{aligned}
        Eu(x) = \begin{cases}
                    u(x) \quad                                 &amp;
x_{d}                                 \geq 0      \\
                    \sum_{j=1}^{k+1} a_j  u_j(x - j e_d) \quad &amp;
x_d                                           &lt; 0
                \end{cases}.
    \end{aligned}$$</span> We will have <span
class="math inline"><em>E</em><em>u</em> ∈ <em>C</em><sup><em>k</em></sup>(<em>Ω</em>′)</span>
as long as we can get the derivatives to match up on the boundary <span
class="math inline">$\{x_d=0\}\cap \overline{\Omega'}$</span>. That is,
as long as <span
class="math inline"><em>a</em><sub><em>j</em></sub></span> verify <span
class="math display">$$\begin{aligned}
        \sum_{j=1}^{k+1}(-j)^l a_j =1 , \quad l=0,1,\ldots,k .
    \end{aligned}$$</span> The above is a system of <span
class="math inline"><em>k</em> + 1</span> equations with <span
class="math inline"><em>k</em> + 1</span>-unknowns <span
class="math inline"><em>a</em><sub><em>j</em></sub></span>. Its matrix
is the <a
href="https://en.wikipedia.org/wiki/Vandermonde_matrix">Vandermonde
matrix</a> (which is invertible). As a result, the system may be solved
to extend <span class="math inline"><em>u</em></span>. By the form of
<span class="math inline"><em>E</em><em>u</em></span> we have the bound
<span class="math display">$$\begin{aligned}
        \left\lVert Eu \right\rVert_{W^{k,p}(\Omega')} \leq c\left\lVert
u \right\rVert_{W^{k,p}(\Omega)} .
    \end{aligned}$$</span> Where <span
class="math inline"><em>c</em> := (<em>k</em>+1)<sup><em>l</em> + 1</sup>max {1,∥<em>a</em>∥<sub>∞</sub>}</span>.
Working now in the general case for <span
class="math inline"><em>Ω</em></span>, we may cover the compact <span
class="math inline">$\overline{\Omega}$</span> by a finite amount of
bounded open sets <span
class="math inline"><em>Ω</em><sub><em>i</em></sub> ⊂ <em>W</em></span>
such that <span class="math display">$$\begin{aligned}
        \Phi_i : \Omega_i \xrightarrow{\sim} \Omega_i'\quad
\text{and}  \quad \Phi_i : \Omega_i \cap \Omega \xrightarrow{\sim}
\Omega_i' \cap \mathcal{H}^d .
    \end{aligned}$$</span> Where <span
class="math inline"><em>Ω</em><sub><em>i</em></sub>′</span> are open in
<span class="math inline">ℝ<sup><em>d</em></sup></span> and <span
class="math inline"><em>Φ</em><sub><em>i</em></sub></span> are <span
class="math inline"><em>C</em><sup><em>k</em></sup></span>
diffeomorphisms. By the previous case, we can extend <span
class="math inline"><em>u</em>′<sub><em>i</em></sub> := <em>u</em> ∘ <em>Φ</em><sub><em>i</em></sub><sup>−1</sup> ∈ <em>C</em><sup><em>k</em></sup>(<em>Ω</em><sub><em>i</em></sub>′∩ℋ<sup><em>d</em></sup>)</span>
to functions <span class="math inline">$\widetilde{u'_i} \in
C^k(\Omega_i')$</span> and then transform back to the original space to
get <span class="math display">$$\begin{aligned}
        \tilde{u_i}:= \widetilde{u'_i} \circ \Phi_i \in C^k(\Omega_i).
    \end{aligned}$$</span> Where <span
class="math display">$$\begin{aligned}
\label{bound}
        \left\lVert \tilde{u_i}
\right\rVert_{W^{k,p}(\Omega_i)}\lesssim  \left\lVert u_i
\right\rVert_{W^{k,p}(\Omega)}.
    \end{aligned}$$</span> The hidden constant depending only on <span
class="math inline"><em>c</em>, ∥<em>Φ</em><sub><em>i</em></sub>∥<sub><em>C</em><sup><em>k</em></sup>(<em>Ω</em><sub><em>i</em></sub>)</sub>∥<em>Φ</em><sub><em>i</em></sub><sup>−1</sup>∥<sub><em>C</em><sup><em>k</em></sup>(<em>Ω</em><sub><em>i</em></sub>′)</sub></span>.
Next, using a partition of unity subordinate to <span
class="math inline">{<em>Ω</em><sub><em>i</em></sub>}<sub><em>i</em> = 1</sub><sup><em>n</em></sup></span>
we glue the local extensions together to form an extension to all of
<span class="math inline"><em>Ω</em></span> <span
class="math display">$$\begin{aligned}
        \tilde{u}:= \sum_{i=1}^n \rho _i{u_i} \in C^k(\Omega).
    \end{aligned}$$</span> The desired extension can now be obtained by
multiplying <span class="math inline"><em>ũ</em></span> with a bump
function <span class="math inline"><em>η</em></span> that is supported
in <span class="math inline"><em>W</em></span> and equal to <span
class="math inline">1</span> on <span
class="math inline"><em>Ω</em></span>. <span
class="math display">$$\begin{aligned}
        Eu := \eta \tilde{u} \in C^k(\mathbb{R}^d).
    \end{aligned}$$</span> By <a href="#bound"
data-reference-type="eqref" data-reference="bound">[bound]</a> we have
that <span class="math display">$$\begin{aligned}
        \left\lVert E u \right\rVert_{W^{k,p}(\mathbb{R}^d)}
\lesssim  \left\lVert u \right\rVert_{W^{k,p}(\Omega)}.
    \end{aligned}$$</span> As a result, <span
class="math inline"><em>E</em></span> is a (bounded) linear operator. So
far we had considered <span class="math inline">$u
\in  C^k(\overline{\Omega})$</span>. Now, since by Theorem <a
href="#global" data-reference-type="ref" data-reference="global">6</a>
the space <span class="math inline">$C^k(\overline{\Omega})$</span> is
dense in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
we may extend <span class="math inline"><em>E</em></span> to a linear
operator on the whole of <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>.
A verification shows that <span class="math inline"><em>E</em></span> is
also bounded as an operator from <span
class="math inline"><em>C</em><sup><em>k</em></sup>(<em>Ω</em>)</span>
to <span
class="math inline"><em>C</em><sup><em>k</em></sup>(ℝ<sup><em>d</em></sup>)</span>.
This concludes the proof. ◻</p>
</div>
<div id="restriction" class="exercise">
<p><strong>Exercise 19</strong> (Restriction). <em>Under the conditions
of Theorem <a href="#extension" data-reference-type="ref"
data-reference="extension">7</a> it holds that <span
class="math display">$$\begin{aligned}
        W^{k,p}(\Omega)= \left.W^{k,p}(\mathbb{R}^d)\right|_{\Omega};
\quad C^{k}(\Omega)= \left.C^{k}(\mathbb{R}^d)\right|_{\Omega}.
    \end{aligned}$$</span> That is, functions in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>), <em>C</em><sup><em>k</em></sup>(<em>Ω</em>)</span>
are equal to the restriction of functions in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(ℝ<sup><em>d</em></sup>), <em>C</em><sup><em>k</em></sup>(ℝ<sup><em>d</em></sup>)</span>
respectively.</em></p>
</div>
<div class="hint">
<p><em>Hint 19</em>. Given <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
we can extend it to <span
class="math inline"><em>E</em><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
by the just proved extension theorem <a href="#extension"
data-reference-type="ref" data-reference="extension">7</a>. By
definition <span
class="math inline"><em>u</em> = <em>E</em><em>u</em>|<sub><em>Ω</em></sub></span>.
The case <span
class="math inline"><em>u</em> ∈ <em>C</em><sup><em>k</em></sup>(ℝ<sup><em>d</em></sup>)</span>
is identical.</p>
</div>
<p>Using extensions also gives us a way to define the Sobolev spaces
<span
class="math inline"><em>H</em><sup><em>s</em></sup>(<em>Ω</em>)</span>
when the exponent <span class="math inline"><em>s</em></span> is real
valued.</p>
<div class="definition">
<p><strong>Definition 11</strong>. <em>Given a <strong>bounded</strong>
open set <span class="math inline"><em>Ω</em></span> with
<strong>boundary</strong> of type <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> with <span
class="math inline"><em>k</em> ∈ ℕ<sub>+</sub></span>, we define for all
real <span class="math inline"><em>s</em> ∈ [0,<em>k</em>]</span> <span
class="math display">$$\begin{aligned}
        H^s(\Omega):=\left.H^s(\mathbb{R}^d)\right|_{\Omega} .
    \end{aligned}$$</span></em></p>
</div>
<p>To further generalize this definition to domains where restriction is
not possible one needs to use <a
href="https://en.wikipedia.org/wiki/Interpolation_space">complex
interpolation</a> (see for example <span class="citation"
data-cites="taylor2013partial"></span> pages 321-333).</p>
<h1 id="trace-theorem">Trace theorem</h1>
<p>As we already discussed, a PDE often incorporates boundary
information such as <span
class="math inline"><em>u</em>|<sub>∂<em>Ω</em></sub> = 0</span>. This
is well defined if <span class="math inline"><em>u</em></span> is
continuous, however, if <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>,
and is thus only defined <strong>almost everywhere</strong>, then <span
class="math inline"><em>u</em>|<sub>∂<em>U</em></sub></span> is a priori
not well defined. The following theorem remedies this issue.</p>
<div id="trace" class="theorem">
<p><strong>Theorem 8</strong> (Trace). <em>Let <span
class="math inline"><em>Ω</em></span> be a <strong>bounded</strong> open
set of <span class="math inline">ℝ<sup><em>d</em></sup></span> with
<span class="math inline"><em>C</em><sup>1</sup></span>
<strong>boundary</strong>. Then, there exists a continuous linear
operator <span class="math display">$$\begin{aligned}
        T: W^{1,p}(U)\to L^p(\partial U) .
    \end{aligned}$$</span> Such that <span
class="math inline"><em>T</em><em>u</em> = <em>u</em>|<sub>∂<em>Ω</em></sub></span>
for all <span class="math inline">$u \in C(\overline{\Omega}) \cap
W^{1,p}(\Omega)$</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> As in previous results, the trick is to suppose first
<span class="math inline"><em>u</em></span> is smooth, work locally, and
then obtain a global result using a partition of unity and the density
in Theorem <a href="#global" data-reference-type="ref"
data-reference="global">6</a>.<br />
Given <span
class="math inline"><em>x</em><sub>0</sub> ∈ ∂<em>Ω</em></span> we take
a open set <span
class="math inline"><em>U</em> ⊂ ℝ<sup><em>d</em></sup></span>
containing <span class="math inline"><em>x</em><sub>0</sub></span>.
Flattening out the boundary by <span
class="math inline"><em>Φ</em> : <em>U</em> ≃ <em>U</em>′</span> where
necessarily the boundary is preserved <span
class="math display">$$\begin{aligned}
        \Phi: U \cap  \partial \Omega\xrightarrow{\sim}U' \cap
\partial  \mathcal{H}^d,
    \end{aligned}$$</span> and using the extension theorem <a
href="#extension" data-reference-type="ref"
data-reference="extension">7</a> to extend <span
class="math inline"><em>u</em>′ := <em>u</em> ∘ <em>Φ</em></span> to
<span class="math inline"><em>ũ</em>′</span> with compact support <span
class="math inline"><em>K</em> ⊂ ℝ<sup><em>d</em></sup></span> we obtain
by the <a
href="https://en.wikipedia.org/wiki/Divergence_theorem#:~:text=space%5Bedit%5D-,We,-are%20going%20to%20prove">divergence
theorem</a> <span class="math display">$$\begin{aligned}
        \int_{U'\cap \partial \mathcal{H}^d}\left| u'
\right|^p  \leq\int_{\partial \mathcal{H}^d} \left| \widetilde{u}'
\right|^p=\int_{\mathcal{H}^d} \partial_{d} \left| \widetilde{u}'
\right|^p\leq\int_{\mathcal{H}^d} p\left| \widetilde{u}'
\right|^{p-1}\left| \partial_{d} u \right|   \lesssim \left\lVert
\widetilde{u}' \right\rVert_{W^{1,p}(\mathcal{H}^d)}^p  .
    \end{aligned}$$</span> Where in the second inequality we used the
chain rule and in the last Hölder’s inequality. Since <span
class="math inline"><em>Φ</em><sup>−1</sup></span> is <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> and by the
continuity of the extension we obtain what we are looking for in <span
class="math display">$$\begin{aligned}
\label{estimate local}
        \left\lVert u \right\rVert_{L^p(U \cap \partial
\mathcal{H}^d)}\lesssim \left\lVert \widetilde{u}'
\right\rVert_{W^{1,p}(\mathcal{H}^d)}\lesssim \left\lVert u'
\right\rVert_{W^{1,p}(U'\cap \mathcal{H}^d)}\lesssim  \left\lVert u
\right\rVert_{W^{1,p}(U\cap \Omega)}
    \end{aligned}$$</span> We had supposed <span
class="math inline"><em>u</em></span> smooth, now taking a finite
covering <span
class="math inline">{<em>U</em><sub><em>i</em></sub>}<sub><em>i</em> = 1</sub><sup><em>n</em></sup></span>
of <span class="math inline">∂<em>Ω</em></span> (this is possible by
compactness of <span class="math inline">∂<em>Ω</em></span>) and taking
a subordinate partition of unity <span
class="math inline"><em>ρ</em><sub><em>i</em></sub></span> we conclude
from <a href="#estimate local" data-reference-type="eqref"
data-reference="estimate local">[estimate local]</a> that <span
class="math display">$$\begin{aligned}
        \int_{\partial \Omega} \left| u \right|^p  =\sum_{i=1}^n \int_{
U_i \cap \partial \Omega} \left| u \right|^p \lesssim \sum_{i=1}^n
\left\lVert u \right\rVert_{W^{1,p}(U_i \cap \Omega)}^p =\left\lVert u
\right\rVert_{W^{1,p}(U)}^p .
    \end{aligned}$$</span> That is, <span
class="math display">$$\begin{aligned}
        \left\lVert T u \right\rVert_{L^p( \partial
\Omega)}\lesssim  \left\lVert u \right\rVert_{W^{1,p}(U)} .
    \end{aligned}$$</span> Using Theorem <a href="#global"
data-reference-type="ref" data-reference="global">6</a> to extend <span
class="math inline"><em>T</em></span> continuously to <span
class="math inline">$W^{k,p}(\Omega)=
\overline{\left.C_c^\infty(\mathbb{R}^d)\right|_{\Omega}}$</span>
concludes the proof. ◻</p>
</div>
<div class="definition">
<p><strong>Definition 12</strong>. <em>We define the
<strong>trace</strong> of <span
class="math inline"><em>u</em> ∈ <em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
as <span class="math inline"><em>T</em><em>u</em></span>. We also use
the notation <span class="math display">$$\begin{aligned}
        \left.u\right|_{\partial \Omega}:= Tu.
    \end{aligned}$$</span></em></p>
</div>
<p>To get an estimate on the trace we paid <span
class="math inline">1</span>-degree of regularity. We can do better and
only pay <span class="math inline">1/<em>p</em></span> degrees of
regularity. This uses the theory of <a
href="https://en.wikipedia.org/wiki/Trace_operator#For_p_=_1:~:text=%5Bedit%5D-,A%20more,-concrete%20representation%20of">Sobolev–Slobodeckij
spaces</a> which we will not develop here. In the case <span
class="math inline"><em>p</em> = 2</span> we can use Hölder spaces <span
class="math inline"><em>H</em><sup><em>s</em></sup>(<em>Ω</em>)</span>
to get the improved result.</p>
<div class="theorem">
<p><strong>Theorem 9</strong>. <em>For all real <span
class="math inline"><em>s</em> &gt; 1/2</span> the trace operator is a
continuous operator <span class="math display">$$\begin{aligned}
        T: H^s(\Omega) \to H^{s -\frac{1}{2}}(\Omega).
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Straightening out the boundary and using the
extension operator as in the trace theorem <a href="#trace"
data-reference-type="ref" data-reference="trace">8</a>, it is sufficient
to work in the case where <span class="math inline"><em>u</em></span> is
smooth and defined on <span
class="math inline">ℋ<sup><em>d</em></sup></span>. By Fourier inversion,
if we write <span
class="math inline"><em>ξ</em> = (<em>ξ</em>′,<em>ξ</em><sub><em>d</em></sub>)</span>
<span class="math display">$$\begin{aligned}
        \widehat{Tu}(\xi ')=\int_{\mathbb{R}}\widehat{u}(\xi)
\,\mathrm{d}\xi _d .
    \end{aligned}$$</span> So, by Cauchy Schwartz <span
class="math display">$$\begin{aligned}
\label{f1}
        \left| \widehat{Tu}(\xi ) \right|^2\leq \int_{\mathbb{R}}\left|
\widehat{u}(\xi) \right|^2\left\langle\xi \right\rangle^{2s}
\,\mathrm{d}\xi _d \int_{\mathbb{R}}\left\langle\xi \right\rangle^{-2s}
\,\mathrm{d}\xi _d.
    \end{aligned}$$</span> The change of variables <span
class="math inline"><em>ξ</em><sub><em>d</em></sub> → ⟨<em>ξ</em>′⟩<em>ξ</em><sub><em>d</em></sub></span>
shows that <span class="math display">$$\begin{aligned}
\label{f2}
        \int_{\mathbb{R}}\left\langle\xi \right\rangle^{-2s}
\,\mathrm{d}\xi _d=\left\langle\xi' \right\rangle^{-2(s-\frac{1}{2})}
\int_{\mathbb{R}}\left\langle\xi _d\right\rangle^{-2s}\,\mathrm{d}\xi
_d\lesssim  \left\langle\xi' \right\rangle^{-2(s-\frac{1}{2})}
    \end{aligned}$$</span> Where in the inequality it was used that
<span class="math inline"><em>s</em> &gt; 1/2</span>. We deduce from <a
href="#f1" data-reference-type="eqref" data-reference="f1">[f1]</a> and
<a href="#f2" data-reference-type="eqref" data-reference="f2">[f2]</a>
on taking norms that <span class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{H^{s-1 /2}(\mathbb{R}^{d-1})}
\lesssim  \left\lVert u \right\rVert_{H^s(\mathbb{R}^d)}.
    \end{aligned}$$</span> Which concludes the proof. ◻</p>
</div>
<p>A particularly useful space of functions related to the trace
operator is the following</p>
<div class="definition">
<p><strong>Definition 13</strong>. <em>We define the space of functions
with trace zero as <span class="math display">$$\begin{aligned}
        W^{k,p}_0(U):=\overline{C_c^\infty(U)}\subset W^{k,p}(U).
    \end{aligned}$$</span> Where the closure is with respect to the
topology on <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>.</em></p>
</div>
<div id="trace 0" class="exercise">
<p><strong>Exercise 20</strong>. <em>Show that for all <span
class="math inline"><em>u</em> ∈ <em>W</em><sub>0</sub><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
<span class="math display">$$\begin{aligned}
        \left.u\right|_{\partial \Omega}=0.
    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 20</em>. Use the continuity of the trace operator.</p>
</div>
<p>The converse to Exercise <a href="#trace 0" data-reference-type="ref"
data-reference="trace 0">20</a> holds but is far from trivial.</p>
<div class="proposition">
<p><strong>Proposition 3</strong>. <em>Let <span
class="math inline"><em>Ω</em></span> be a <strong>bounded</strong> open
set with <span class="math inline"><em>C</em><sup>1</sup></span>
<strong>boundary</strong>. Then <span
class="math display">$$\begin{aligned}
        W^{k,p}_0(\Omega)=\left\{u \in W^{k,p}(U): Tu=0\right\} .
    \end{aligned}$$</span></em></p>
</div>
<p>The proof is very technical, see <span class="citation"
data-cites="evans2022partial"></span> page 274 for the details.<br />
Being able to approximate functions in <span
class="math inline"><em>W</em><sub>0</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
by smooth functions compactly supported <strong>inside of</strong> <span
class="math inline"><em>U</em></span> gives us many more tools. For
example, a function <span class="math inline"><em>u</em></span> in <span
class="math inline"><em>W</em><sub>0</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
can be extended by zero to obtain an element <span
class="math inline"><em>ũ</em></span> in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
even for non-smooth unbounded domains.</p>
<div class="exercise">
<p><strong>Exercise 21</strong> (Extension trace 0). <em>Let <span
class="math inline"><em>U</em></span> be an open set, and define <span
class="math display">$$\begin{aligned}
        \widetilde{u}:=\begin{cases}
                           u &amp; \text{ on } U   \\
                           0 &amp; \text{ on } U^c
                       \end{cases}.
    \end{aligned}$$</span> Then <span
class="math display">$$\begin{aligned}
        E: W_0^{k,p}(U) \to W^{k,p}(\mathbb{R}^d); \quad  u \to
\widetilde{u}
    \end{aligned}$$</span> is a linear with <span
class="math inline">∥<em>E</em>∥ = 1</span>.</em></p>
</div>
<div class="hint">
<p><em>Hint 21</em>. It is immediate that <span
class="math inline">∥<em>ũ</em>∥<sub><em>W</em><sup><em>k</em>, <em>p</em></sup>(ℝ<sup><em>d</em></sup>)</sub> = ∥<em>ũ</em>∥<sub><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</sub></span>
for <span
class="math inline"><em>u</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>.
As a result, we can extend <span class="math inline"><em>E</em></span>
by density to the closure <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>.
Which by definition is <span
class="math inline"><em>W</em><sub>0</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>.</p>
</div>
<div class="observation">
<p><strong>Observation 4</strong>. <em>The fact that we can extend
functions in <span
class="math inline"><em>W</em><sub>0</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
for arbitrary <span class="math inline"><em>U</em></span> allows one to
derive results that when stated for the whole of <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>
require <span class="math inline"><em>U</em></span> to be smooth so that
it is possible to extend <span
class="math inline"><em>U</em></span>.</em></p>
</div>
<div class="exercise">
<p><strong>Exercise 22</strong> (Integration by parts 1). <em>Let <span
class="math inline"><em>U</em></span> be any open set and consider <span
class="math inline"><em>u</em> ∈ <em>W</em><sub>0</sub><sup>1, <em>p</em></sup>(<em>U</em>), <em>v</em> ∈ <em>W</em><sup>1, <em>p</em>′</sup>(<em>U</em>)</span>
then <span class="math display">$$\begin{aligned}
        \int_{U} (\partial _iu) v = -\int_{U}u \partial _i v  .
    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 22</em>. Give yourself an epsilon of room and take
limits.</p>
</div>
<div class="exercise">
<p><strong>Exercise 23</strong> (Integration by parts 2). <em>Let <span
class="math inline"><em>Ω</em></span> be a <strong>bounded</strong> open
set of <span class="math inline">ℝ<sup><em>d</em></sup></span> with
<span class="math inline"><em>C</em><sup>1</sup></span>
<strong>boundary</strong> and consider <span
class="math inline"><em>u</em> ∈ <em>W</em><sup>1, <em>p</em></sup>(<em>Ω</em>), <em>v</em> ∈ <em>W</em><sup>1, <em>p</em>′</sup>(<em>Ω</em>)</span>
then <span class="math display">$$\begin{aligned}
        \int_{\Omega} (\partial _iu) v = -\int_{\Omega}u \partial _i v+
\int_{\partial \Omega} u v \textbf{n}_i  \,\mathrm{d}.
    \end{aligned}$$</span> Where <span
class="math inline"><strong>n</strong></span> is the outward pointing
unit normal vector to <span
class="math inline">∂<em>Ω</em></span>.</em></p>
</div>
<div class="hint">
<p><em>Hint 23</em>. Give yourself an epsilon of room, apply the <a
href="https://en.wikipedia.org/wiki/Divergence_theorem#:~:text=space%5Bedit%5D-,We,-are%20going%20to%20prove">divergence
theorem</a> and take limits.</p>
</div>
<h1 id="sobolev-embeddings-and-inequalities">Sobolev embeddings and
inequalities</h1>
<p>Sobolev inequalities are relationships that bound the norm of <span
class="math inline"><em>u</em></span> in different function spaces
depending on how differentiable and integrable <span
class="math inline"><em>u</em></span> is. For example, such a
relationship could look like <span
class="math display">$$\begin{aligned}
\label{example}
    \left\lVert u \right\rVert_{W^{ l,p^* }(\Omega)}\leq \left\lVert u
\right\rVert_{W^{k,p}(\Omega)}.\end{aligned}$$</span> By considering the
rescaling <span
class="math inline"><em>u</em>(<em>λ</em><em>x</em>)</span>, performing
a change of variables, and taking <span
class="math inline"><em>λ</em></span> to <span
class="math inline">∞</span> we see that for such a relationship to hold
it is necessary that <span class="math display">$$\begin{aligned}
\label{conjugate}
    l-     \frac{d}{p^*}=k-\frac{d}{p}  .\end{aligned}$$</span> The case
<span class="math inline"><em>k</em> = <em>l</em> + 1</span> gives rise
to the following definition</p>
<div class="definition">
<p><strong>Definition 14</strong>. <em>The <strong>Sobolev
conjugate</strong> of <span
class="math inline">1 ≤ <em>p</em> &lt; <em>d</em></span> is <span
class="math inline"><em>p</em><sup>*</sup></span> defined by <span
class="math display">$$\begin{aligned}
        \frac{1}{p^*}= \frac{1}{p} -\frac{1}{d} .
    \end{aligned}$$</span></em></p>
</div>
<p>Note that <span
class="math inline"><em>p</em> &lt; <em>p</em><sup>*</sup></span>. The
idea behind inequalities such as <a href="#example"
data-reference-type="eqref" data-reference="example">[example]</a> is to
cash in some differentiability for some integrability. The main results
used to do this are based on the fundamental theorem of calculus. First,
we need the following lemma.</p>
<div id="whitney" class="lemma">
<p><strong>Lemma 2</strong> (Loomis-Whitney inequality). <em>Let <span
class="math inline"><em>d</em> ≥ 1</span>, let <span
class="math inline"><em>f</em><sub>1</sub>, …, <em>f</em><sub><em>d</em></sub> ∈ <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em> − 1</sup>)</span>
for some <span class="math inline"><em>p</em> ∈ (0, ∞]</span>, and
define <span class="math display">$$\begin{aligned}
        F_d\left(x_1, \ldots, x_d\right):=\prod_{i=1}^d f_i\left(x_1,
\ldots, x_{i-1}, x_{i+1}, \ldots, x_d\right).
    \end{aligned}$$</span> Then, <span
class="math display">$$\begin{aligned}
\label{loomis ineq}
        \left\lVert F_d
\right\rVert_{L^{p}/({d-1})}\leq\prod_{i=1}^d\left\|f_i\right\|_{L^p\left(\mathbb{R}^{d-1}\right)}
.
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The case <span
class="math inline"><em>d</em> = 2</span> is immediate by Fubini. The
general case follows from induction on <span
class="math inline"><em>d</em></span> . We write <span
class="math inline">(<em>x</em><sub>1</sub>,…<em>x</em><sub><em>d</em> + 1</sub>) = (<em>x</em>′,<em>x</em><sub><em>d</em> + 1</sub>)</span>
<span class="math display">$$\begin{aligned}
         &amp; \left\lVert F_{d+1} \right\rVert_{L^{p
/d}(\mathbb{R}^{d+1})}  =\left(\int_{\mathbb{R}}\left(\int_{\mathbb{R}^d}
F_d(x)^{\frac{p}{d}} f_{d+1}(x')^{\frac{p}{d}}
\,\mathrm{d}x'  \right)  \,\mathrm{d}x_{d+1} \right)^{\frac{d}{p}
}          \notag       \\
         &amp; \leq
\left(\int_{\mathbb{R}}         \left(\int_{\mathbb{R}^d}
F_d(x)^{\frac{p}{d-1}}
\,\mathrm{d}x'  \right)^{\frac{d-1}{d}}\,\mathrm{d}x_{d+1}
\right)^{\frac{d}{p} }\left\lVert f_{d+1}
\right\rVert_{L^p(\mathbb{R}^d)}      \notag               \\
         &amp; \leq \left(\int_{\mathbb{R}}
\prod_{i=1}^d\left\|f_i(x_{d+1})\right\|_{L^p\left(\mathbb{R}^{d}\right)}^{\frac{p}{d}}
\,\mathrm{d}x_{d+1}\right)^{\frac{d}{p}}\left\lVert f_{d+1}
\right\rVert_{L^p(\mathbb{R}^{d})}\label{induc}
    \end{aligned}$$</span> Where in the first inequality we applied
Cauchy-Schwartz with <span
class="math inline"><em>q</em> = <em>d</em>/(<em>d</em>−1), <em>q</em>′ = <em>d</em></span>.
Now applying the general version of Hölder’s<span
class="math display">$$\begin{aligned}
    \left\lVert g_1\cdots g_n  \right\rVert_{L^1} \leq \left\lVert g_1
\right\rVert_{L^{p_1}}\cdots\left\lVert g_1 \right\rVert_{L^{p_n}};
\quad  \frac{1}{p_1}+\cdots
\frac{1}{p_n}=1   .\end{aligned}$$</span></p>
<p>to <span class="math inline">$g_i:= \left\lVert f_i(\cdot )
\right\rVert^{\frac{p}{d}}_{L^p(\mathbb{R}^{d})} \in
L^{d}(\mathbb{R})$</span> gives</p>
<p><span class="math display">$$\begin{aligned}
        \int_{\mathbb{R}}\prod_{i=1}^{d}g_i \leq \prod_{i=1}^{d}
\left\lVert g_i \right\rVert_{L^d(\mathbb{R})}    .
    \end{aligned}$$</span> Substituting into <a href="#induc"
data-reference-type="eqref" data-reference="induc">[induc]</a> concludes
the proof. ◻</p>
</div>
<p>Using the Loomis-Whitney inequality and the fundamental theory of
calculus gives us our first Sobolev inequality</p>
<div id="est1" class="theorem">
<p><strong>Theorem 10</strong> (Sobolev-Gagliardo-Niremberg). <em>Given
<span class="math inline">1 ≤ <em>p</em> &lt; <em>d</em></span> it holds
that <span class="math display">$$\begin{aligned}
        \left\lVert u
\right\rVert_{L^{p^*}(\mathbb{R}^d)}\lesssim  \left\lVert \nabla u
\right\rVert_{L^p (\mathbb{R}^d)}.
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> By density (see Theorem <a href="#approx rd"
data-reference-type="ref" data-reference="approx rd">4</a>), it is
enough to take <span
class="math inline"><em>u</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>.
Applying the fundamental theorem of calculus gives <span
class="math display">$$\begin{aligned}
        \left| u \right|^m=\int_{-\infty}^\cdot \partial _i \left| u
\right|^m \,\mathrm{d}x_i  \leq \int_{\mathbb{R}}\left| u
\right|^{m-1}\left| \partial _i u \right| \,\mathrm{d}x_i=: f_i ,
\quad\forall i=1,\ldots,d.
    \end{aligned}$$</span> Multiplying all these inequalities together
gives <span class="math display">$$\begin{aligned}
        \left| u \right|^{md} \leq \prod_{i=1}^{d} f_i   .
    \end{aligned}$$</span> Applying the Loomis-Whitney inequality <a
href="#loomis ineq" data-reference-type="eqref"
data-reference="loomis ineq">[loomis ineq]</a> “with <span
class="math inline"><em>p</em> = 1</span>” and Hölder’s inequality shows
<span class="math display">$$\begin{aligned}
\label{hard}
        \left\lVert u \right\rVert_{L^{ md
/(d-1)}(\mathbb{R}^d)}^{md}\lesssim  \prod_{i=1}^{d}  \left\lVert
u^{m-1}\partial_iu \right\rVert_{L^1(\mathbb{R}^d)} \leq \left\lVert u
\right\rVert_{L^{(m-1)p'}(\mathbb{R}^d)}^{(m-1)d}\left\lVert \nabla u
\right\rVert_{L^{p}(\mathbb{R}^d \to  \mathbb{R}^d)}^d
    \end{aligned}$$</span> It remains to choose <span
class="math inline"><em>m</em></span> such that <span
class="math display">$$\begin{aligned}
        \frac{md}{d-1}= (m-1)p' \implies m= \frac{(d-1)p^*}{d} =\frac{dp
-p}{d-p} \geq 1.
    \end{aligned}$$</span> Substituting into <a href="#hard"
data-reference-type="eqref" data-reference="hard">[hard]</a> gives <span
class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{L^{ p^*}(\mathbb{R}^d)}^{m}\lesssim
\left\lVert u \right\rVert_{L^{p^*}(\mathbb{R}^d)}^{m-1}\left\lVert
\nabla u \right\rVert_{L^{p}(\mathbb{R}^d \to  \mathbb{R}^d)} .
    \end{aligned}$$</span> This concludes the proof. ◻</p>
</div>
<div id="est12" class="exercise">
<p><strong>Exercise 24</strong>. <em>Given <span
class="math inline">$p&lt;\frac{d}{k}$</span> define <span
class="math inline"><em>p</em><sup><em>k</em>*</sup></span> by <span
class="math inline">$\frac{1}{p^{k*}}=\frac{1}{p}-\frac{k}{d}$</span>.
Then, <span class="math display">$$\begin{aligned}
\left\lVert u \right\rVert_{L^{p^{k*}}(\mathbb{R}^d)}
\lesssim  \left\lVert \nabla^k u
\right\rVert_{L^p(\mathbb{R}^d)}    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 24</em>. Apply induction on <span
class="math inline"><em>k</em></span> using Theorem <a href="#est1"
data-reference-type="ref" data-reference="est1">10</a>.</p>
</div>
<p>The result can also be further <a
href="https://en.wikipedia.org/wiki/Gagliardo%E2%80%93Nirenberg_interpolation_inequality">generalized</a>
An estimate for the endpoint <span
class="math inline"><em>d</em> = <em>p</em></span> can also be
achieved</p>
<div id="estt2" class="theorem">
<p><strong>Theorem 11</strong>. <em>It holds that <span
class="math display">$$\begin{aligned}
        W^{1,d}(\mathbb{R}^d) \hookrightarrow L^q(\mathbb{R}^d) ,
\quad\forall  q \in [d,+\infty)
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Setting <span
class="math inline"><em>p</em> = <em>d</em></span> in our estimate <a
href="#hard" data-reference-type="eqref"
data-reference="hard">[hard]</a> gives <span
class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{L^{ m
d/(d-1)}(\mathbb{R}^d)}^{m}\lesssim  \left\lVert u
\right\rVert_{L^{(m-1)d /(d-1)}(\mathbb{R}^d)}^{m-1}\left\lVert \nabla u
\right\rVert_{L^{d}(\mathbb{R}^d \to  \mathbb{R}^d)} .
    \end{aligned}$$</span> Applying Young’s product inequality with
<span class="math inline">$p = \frac{m}{m-1}, p'= m$</span> and using
that raising to a power is convex gives <span
class="math display">$$\begin{aligned}
\label{22}
        \left\lVert u \right\rVert_{L^{ m
d/(d-1)}(\mathbb{R}^d)}\lesssim \left\lVert u
\right\rVert_{L^{(m-1)d/(d-1)}(\mathbb{R}^d)}+\left\lVert \nabla u
\right\rVert_{L^{d}(\mathbb{R}^d \to  \mathbb{R}^d)} , \quad\forall  m
\geq 1.
    \end{aligned}$$</span> Taking <span
class="math inline"><em>m</em> = <em>d</em></span> above gives <span
class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{L^{d^2 /(d-1)}(\mathbb{R}^d)}
\lesssim  \left\lVert u \right\rVert_{W^{1,d}(\mathbb{R}^d)}.
    \end{aligned}$$</span> We also trivially have <span
class="math inline">∥<em>u</em>∥<sub><em>L</em><sup><em>d</em></sup>(ℝ<sup><em>d</em></sup>)</sub> ≤ ∥<em>u</em>∥<sub><em>W</em><sup>1, <em>d</em></sup>(ℝ<sup><em>d</em></sup>)</sub></span>
so by <a
href="https://en.wikipedia.org/wiki/Riesz%E2%80%93Thorin_theorem#:~:text=%5Bedit%5D-,First,-we%20need%20the">interpolation</a>
we can extend the inequality to <span
class="math display">$$\begin{aligned}
\label{step 1}
        \left\lVert u \right\rVert_{L^{q}(\mathbb{R}^d)}
\lesssim  \left\lVert u \right\rVert_{W^{1,d}(\mathbb{R}^d)} ,
\quad\forall q \in \left[d,\frac{d^2}{d-1}\right].
    \end{aligned}$$</span> We now iterate, taking <span
class="math inline"><em>m</em> = <em>d</em> + 1</span> gives <span
class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{L^{
(d+1)d/(d-1)}(\mathbb{R}^d)}\lesssim \left\lVert u
\right\rVert_{L^{d^2/(d-1)}(\mathbb{R}^d)}+\left\lVert \nabla u
\right\rVert_{L^{d}(\mathbb{R}^d
\to  \mathbb{R}^d)}             \end{aligned}$$</span> Which combined
with <a href="#step 1" data-reference-type="eqref"
data-reference="step 1">[step 1]</a> and interpolating gives <span
class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{L^{q}(\mathbb{R}^d)}
\lesssim  \left\lVert u \right\rVert_{W^{1,d}(\mathbb{R}^d)} ,
\quad\forall q \in \left[d,\frac{(d+1)d}{d-1}\right].
    \end{aligned}$$</span> Iterating this process (taking <span
class="math inline"><em>m</em> = <em>d</em> + 2, …, <em>m</em> = <em>d</em> + <em>k</em></span>
in <a href="#22" data-reference-type="eqref"
data-reference="22">[22]</a>) shows that <span
class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{L^{q}(\mathbb{R}^d)}
\lesssim  \left\lVert u \right\rVert_{W^{1,d}(\mathbb{R}^d)} ,
\quad\forall q \in \left[d+k,\frac{(d+k)d}{d-1}\right].
    \end{aligned}$$</span> From this, we conclude the result. ◻</p>
</div>
<div id="est22" class="exercise">
<p><strong>Exercise 25</strong>. <em>It holds that <span
class="math display">$$\begin{aligned}
        W^{k,\frac{d}{k}}(\mathbb{R}^d) \hookrightarrow
L^q(\mathbb{R}^d) , \quad\forall  q \in [d /k,+\infty)
    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 25</em>. Use induction on <span
class="math inline"><em>k</em></span> with Theorem <a href="#estt2"
data-reference-type="ref" data-reference="estt2">11</a>.</p>
</div>
<p>Note that the constant in our above estimate blows up on iterating.
As a result, we do not expect <span
class="math display">$$\begin{aligned}
    W^{1,d}(\mathbb{R}^d) \hookrightarrow
L^\infty(\mathbb{R}^d).\end{aligned}$$</span> This holds if and only if
<span class="math inline"><em>d</em> = 1</span>. Otherwise, we require
more integrability. However, this extra integrability can be converted
into regularity in the style of <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=.%C2%A0%E2%97%BB-,As%20a%20corollary,-of%20this%2C%20we">Sobolev
spaces</a>. First, we recall the following definition</p>
<div class="definition">
<p><strong>Definition 15</strong>. <em>Let <span
class="math inline"><em>U</em> ⊂ ℝ<sup><em>d</em></sup></span> be open
and <span class="math inline"><em>γ</em> ∈ ℝ<sub>+</sub></span>, we
define the Holder space <span class="math display">$$\begin{aligned}
        C^{k,\gamma }(\mathbb{R}^d):= \left\{u \in C^k(U): \left\lVert u
\right\rVert_{C^{k,\gamma }(U)}&lt;\infty\right\} .
    \end{aligned}$$</span> Where the Holder norm is defined as <span
class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{C^{0,\gamma }(U)} &amp; := \sup_{x
\neq y \in \mathbb{R}^d} \frac{\left| u(x)-u(y) \right| }{\left| x-y
\right|^\gamma  }          \\
        \left\lVert u \right\rVert_{C^{k,\gamma }(U)} &amp;
:=\left\lVert u \right\rVert_{C^{k}(U)}+\sum_{\left| \alpha \right|= k }
\left\lVert D^\alpha u \right\rVert_{C^{0,\gamma }(U)}   .
    \end{aligned}$$</span></em></p>
</div>
<p>For <span class="math inline"><em>γ</em> = 1</span> the <span
class="math inline"><em>C</em><sup><em>k</em>, <em>γ</em></sup></span>
is the space of functions with bounded derivatives up to order <span
class="math inline"><em>k</em></span> and whose <span
class="math inline"><em>k</em></span>-th order derivatives are Lipschitz
continuous.</p>
<div id="est3" class="theorem">
<p><strong>Theorem 12</strong> (Morrey). <em>Let <span
class="math inline"><em>p</em> &gt; <em>d</em></span> and set <span
class="math inline">$\gamma=1-\frac{d}{p}$</span>. Then, the following
inclusion is continuous <span class="math display">$$\begin{aligned}
        W^{1,p}(\mathbb{R}^d) \hookrightarrow C^{0,\gamma
}(\mathbb{R}^d).
    \end{aligned}$$</span></em></p>
</div>
<p>The proof is technical and can be found in <span class="citation"
data-cites="brezis2011functional"></span> page 282.</p>
<p>As is logical, as <span class="math inline"><em>p</em></span>
approaches <span class="math inline"><em>d</em></span> from above the
extra differentiability we get goes to <span
class="math inline">0</span>. Furthermore, no matter how much
integrability we cash in, we can never get more differentiability than
we started with, so <span class="math inline"><em>γ</em> → 1</span> as
<span class="math inline"><em>p</em> → ∞</span>.</p>
<div id="est32" class="exercise">
<p><strong>Exercise 26</strong> (Sobolev regularity). <em>Let <span
class="math inline"><em>p</em> &gt; <em>d</em></span> and set <span
class="math inline">$\gamma=1-\frac{d}{p}$</span>. Then, the following
inclusion is continuous <span class="math display">$$\begin{aligned}
        W^{k,p}(\mathbb{R}^d) \hookrightarrow C^{k,\gamma
}(\mathbb{R}^d).
    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 26</em>. This holds for the case <span
class="math inline"><em>k</em> = 1</span>. We now proceed by induction.
Since <span
class="math inline">∇<em>u</em> ∈ <em>W</em><sup><em>k</em> − 1, <em>p</em></sup>(ℝ<sup><em>d</em></sup>→ℝ<sup><em>d</em></sup>)</span>
by hypothesis of induction we obtain <span
class="math display">$$\begin{aligned}
        \nabla u \in C^{k-1,\widetilde{\gamma }}(\mathbb{R}^d \to
\mathbb{R}^d); \quad \widetilde{\gamma }:= k-1 -\frac{d}{p} .
    \end{aligned}$$</span> In consequence, <span
class="math display">$$\begin{aligned}
        u \in C^{k-1+1,\widetilde{\gamma}+1}(\mathbb{R}^d
)=C^{k,\gamma}(\mathbb{R}^d ) .
    \end{aligned}$$</span></p>
</div>
<p>Combining the three results gives</p>
<div id="rellich" class="theorem">
<p><strong>Theorem 13</strong> (Rellich-Kondrachov). <em>Let <span
class="math inline"><em>Ω</em></span> either be <span
class="math inline">ℝ<sup><em>d</em></sup></span> or
<strong>bounded</strong> with <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> boundary,
then following inclusions are continuous <span
class="math display">$$\begin{aligned}
                 &amp; W^{k,p}(\Omega) \hookrightarrow L^q(\Omega)
,           \quad\forall q \in [1,p^{k*})    &amp; \text{ and
}     p&lt;\frac{d}{k}  \\
         &amp; W^{k,p}(\Omega) \hookrightarrow L^q(\Omega)
,           \quad\forall q \in [p,\infty) &amp; \text{ and
}   p=\frac{d}{k}  \\
                 &amp; W^{k,p}(\Omega) \hookrightarrow C^{k,\gamma
}(\overline{\Omega}) \hookrightarrow C^{k}(\overline{\Omega})
,  \quad                         &amp; \text{ and
}  p&gt;\frac{d}{k}    \end{aligned}$$</span> Where <span
class="math inline"><em>p</em><sup><em>k</em>*</sup></span> is defined
by the relation <span
class="math inline">$\frac{1}{p^{k*}}=\frac{1}{p}-\frac{k}{d}$</span>
and <span class="math inline">$\gamma =1 -\frac{p}{d}$</span>.
Furthermore, the first, second, fourth, and third composed with fourth
inclusions are <a
href="https://en.wikipedia.org/wiki/Compact_embedding">compact</a>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The fact that the above inclusions are continuous
follows by our three Sobolev inequalities in Exercises <a href="#est12"
data-reference-type="ref" data-reference="est12">24</a>,<a href="#est22"
data-reference-type="ref" data-reference="est22">25</a>,<a href="#est32"
data-reference-type="ref" data-reference="est32">26</a> together with
the extension theorem <a href="#extension" data-reference-type="ref"
data-reference="extension">7</a>.</p>
<p>The compactness of the embeddings requires reduce to showing that the
unit ball in each of the embedded spaces is <a
href="https://en.wikipedia.org/wiki/Equicontinuity">equicontinuous</a>.</p>
<ol>
<li><p>For the first inclusion we will use <a
href="https://en.wikipedia.org/wiki/Fr%C3%A9chet%E2%80%93Kolmogorov_theorem">Fréchet–Kolmogorov’s</a>
theorem. First we note that we can suppose <span
class="math inline"><em>q</em> &gt; <em>p</em></span> as <span
class="math inline"><em>L</em><sup><em>q</em></sup>(<em>Ω</em>) ↪ <em>L</em><sup><em>p</em></sup>(<em>Ω</em>)</span>.
Let <span class="math inline"><em>B</em><sub>1</sub></span> be the unit
ball in <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>.
By continuity of the inclusion <span
class="math inline"><em>B</em><sub>1</sub></span> is bounded in <span
class="math inline"><em>L</em><sup><em>q</em></sup>(<em>Ω</em>)</span>
and it only remains to show that <span
class="math inline"><em>B</em><sub>1</sub></span> is equicontinuous. We
have that <span class="math display">$$\begin{aligned}
            \left\lVert \tau_h u-u \right\rVert_{L^p(\Omega)}\leq
\left\lVert \nabla u \right\rVert_{L^p(\Omega)}\left| h \right| ,
\quad\forall u \in W^{1,p}(\Omega) .
        \end{aligned}$$</span> Where the above is known to be true for
smooth functions by the fundamental theorem of calculus and extends by
density to <span
class="math inline"><em>W</em><sup><em>k</em>, <em>p</em></sup>(<em>Ω</em>)</span>
(we recall translation is continuous on <span
class="math inline"><em>L</em><sup><em>p</em></sup></span> for <span
class="math inline"><em>p</em> &lt; ∞</span>). The above also holds for
<span class="math inline"><em>p</em><sup><em>k</em>*</sup></span> and
since <span
class="math inline"><em>p</em> &lt; <em>q</em> &lt; <em>p</em><sup><em>k</em>*</sup></span>
we can write <span class="math display">$$\begin{aligned}
    \frac{1}{q}=\frac{\alpha}{p}+\frac{1-\alpha}{p^{k*}}   .\end{aligned}$$</span>
By <a
href="https://en.wikipedia.org/wiki/Riesz%E2%80%93Thorin_theorem#:~:text=the%20sumset%20formulation.-,Riesz%E2%80%93Thorin,-interpolation%20theorem%C2%A0%E2%80%94%C2%A0">interpolation</a>
we obtain that <span class="math display">$$\begin{aligned}
            \left\lVert \tau_h u-u \right\rVert_{L^q(\Omega)}\leq
\left\lVert \nabla u \right\rVert_{L^p(\Omega)}^\alpha\left\lVert \nabla
u \right\rVert_{L^{p^{k*}}(\Omega)}^{1-\alpha}\left| h \right| ,
\quad\forall u \in W^{1,p}(\Omega) .
    \end{aligned}$$</span> This shows equicontinuity and concludes the
first case.</p></li>
<li><p>The compactness of the second inclusion is proved
identically.</p></li>
<li><p>For the compactness of the last inclusion we use <a
href="https://en.wikipedia.org/wiki/Arzel%C3%A0%E2%80%93Ascoli_theorem#:~:text=%2C%20%C2%A7IV.6.7)%3A-,Let,-X%20be%20a">Arzelà–Ascoli
theorem</a> on a “derivative by derivative basis”. By definition of
Hölder norm, <span class="math display">$$\begin{aligned}
                     \left| D^\alpha u(x)- D^\alpha u(y)
\right|&amp;\lesssim  \left\lVert u
\right\rVert_{C^{k}(\mathbb{R}^d)}\left| x-y \right| ,
&amp;&amp;\quad\forall \left| \alpha \right|&lt;k\\
                     \left| D^\alpha u(x)- D^\alpha u(y)
\right|&amp;\lesssim  \left\lVert u \right\rVert_{C^{k,\gamma
}(\mathbb{R}^d)}\left| x-y \right|^\gamma  , &amp;&amp;\quad\forall
\left| \alpha \right|=k.
        \end{aligned}$$</span> As a result, for each <span
class="math inline">|<em>α</em>| ≤ <em>k</em></span> the family <span
class="math display">$$\begin{aligned}
    A_\alpha:=\left\{D^\alpha u: u \in B_1 \subset C^{k,\gamma
}(\overline{\Omega})\right\},\end{aligned}$$</span> is equicontinuous.
So by Arzelà–Ascoli we may extract a sequence <span
class="math inline"><em>u</em><sub><em>n</em></sub></span> such that
<span
class="math inline"><em>D</em><sup><em>α</em></sup><em>u</em><sub><em>n</em></sub></span>
converges uniformly to some <span
class="math inline"><em>u</em><sup>(<em>α</em>)</sup></span>. By the
fundamental theorem of calculus we conclude that <span
class="math inline"><em>u</em><sup>(<em>α</em>)</sup> = <em>D</em><sup><em>α</em></sup><em>u</em><sup>(0)</sup></span>
and as a result <span class="math inline">$u_n \to u \in
C^k(\overline{\Omega})$</span>. That is, the unit ball <span
class="math inline"><em>B</em><sub>1</sub> ⊂ <em>C</em><sup><em>k</em>, <em>γ</em></sup></span>
is sequentially compact and thus compact when embedded in <span
class="math inline">$C^k(\overline{\Omega})$</span>. This proves this
point.</p></li>
<li><p>The composition of the inclusions on the last line is compact as
the composition of a compact and a continuous operator is compact. This
concludes the proof.</p></li>
</ol>
<p> ◻</p>
</div>
<p>The main utility of all these compact embeddings is that given a
sequence <span
class="math inline"><em>u</em><sub><em>n</em></sub></span> whose
derivatives are bounded in certain <span
class="math inline"><em>L</em><sup><em>p</em></sup></span> norms we can
extract convergent subsequences in appropriate spaces. We end this post
(modulo appendices) with one of the most useful inequalities which we
will make use of in future posts</p>
<div class="theorem">
<p><strong>Theorem 14</strong> (Poincaré inequality). <em>Let <span
class="math inline"><em>u</em> ∈ <em>W</em><sub>0</sub><sup>1, <em>p</em></sup>(<em>U</em>)</span>
where <span class="math inline"><em>U</em></span> is bounded in one
direction. Then <span class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{W^{1,p}(U)}\leq C\left\lVert \nabla
u \right\rVert_{W^{1,p}(U \to \mathbb{R}^d)}.
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> By density (which holds by definition of <span
class="math inline"><em>W</em><sub>0</sub><sup><em>k</em>, <em>p</em></sup>(<em>U</em>)</span>)
of it is sufficient to reason for <span
class="math inline"><em>u</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
and pass to the limit. By relabeling we may suppose <span
class="math inline"><em>U</em></span> is bounded along the <span
class="math inline"><em>x</em><sub><em>d</em></sub></span> axis. That
is, for some finite <span
class="math inline"><em>a</em> &lt; <em>b</em></span> <span
class="math display">$$\begin{aligned}
        U \subset \mathbb{R}^{d-1} \times [a,b].
    \end{aligned}$$</span> The idea is to use the fundamental theorem of
calculus together with the compact support of <span
class="math inline"><em>u</em></span>. This allows us to rewrite <span
class="math display">$$\begin{aligned}
        \left| u(x) \right|= \left| \int_{a}^{x_d} \partial_d u(x',t)
\,\mathrm{d}t \right| \leq \left(\int_{\mathbb{R}}\left| \partial _d
u(x',t) \right|^p
\,\mathrm{d}t\right)^\frac{1}{p}(x_d-a)^{\frac{1}{p'}}  .
    \end{aligned}$$</span> Taking <span
class="math inline"><em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
norms above gives <span class="math display">$$\begin{aligned}
        \left\lVert u \right\rVert_{L^p(\mathbb{R}^d)}\leq \left\lVert
\partial _du
\right\rVert_{L^p(\mathbb{R}^d)}\frac{p'}{p+p'}(b-a)^{\frac{p+p'}{p'}}
\lesssim  \left\lVert \nabla u \right\rVert_{L^p(\mathbb{R}^d \to
\mathbb{R}^d)} .
    \end{aligned}$$</span> This concludes the proof. ◻</p>
</div>
<h1 id="convolutions-and-regularization">Convolutions and
regularization</h1>
<p>The convolution of two functions <span
class="math inline"><em>f</em>, <em>g</em></span> can be thought of as
“blurring” <span class="math inline"><em>f</em></span> by averaging it
against <span class="math inline"><em>g</em></span>. In the case where
<span class="math inline"><em>g</em></span> is smooth, this blurring has
the effect of smoothing out any sharp edges and irregularities in <span
class="math inline"><em>f</em></span>. This allows us to approximate
irregular functions by smooth ones and serves as an important technical
tool in our analysis.</p>
<div class="definition">
<p><strong>Definition 16</strong> (Convolution of functions). <em>Given
<span class="math inline"><em>f</em></span> and <span
class="math inline"><em>g</em></span> we define the convolution of <span
class="math inline"><em>f</em>, <em>g</em></span> to be the function
<span class="math inline"><em>f</em> * <em>g</em></span> <span
class="math display">$$\begin{aligned}
\label{convo}
        f *g := \int f(y)g(x-y) \,\mathrm{d}y
    \end{aligned}$$</span></em></p>
</div>
<p>The definition given by <a href="#convo" data-reference-type="eqref"
data-reference="convo">[convo]</a> is purposefully vague. We still need
to specify what spaces <span
class="math inline"><em>f</em>, <em>g</em></span> belong to so that
<span class="math inline"><em>f</em> * <em>g</em></span> is a
well-defined element (of a further unspecified space). This can be done
as follows.</p>
<div id="Young" class="proposition">
<p><strong>Proposition 4</strong> (Young’s convolution inequality).
<em>Consider the definition in <a href="#convo"
data-reference-type="eqref" data-reference="convo">[convo]</a> and let
<span
class="math inline"><em>p</em>, <em>q</em>, <em>r</em> ∈ [1,∞]</span>.
Then it holds that</em></p>
<ol>
<li><p><em>If <span
class="math inline"><em>f</em> ∈ <em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>
and <span
class="math inline"><em>g</em> ∈ <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
then <span
class="math inline"><em>f</em> * <em>g</em> ∈ <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
with <span class="math display">$$\begin{aligned}
                  \left\lVert f*g \right\rVert_{L^p(\mathbb{R}^d)}\leq
\left\lVert f \right\rVert_{L^1(\mathbb{R}^d)}\left\lVert g
\right\rVert_{L^p(\mathbb{R}^d)}.
              \end{aligned}$$</span></em></p></li>
<li><p><em>Suppose that <span class="math display">$$\begin{aligned}
                  \frac{1}{p}+\frac{1}{q}=1+\frac{1}{r}; \quad f \in
L^p(\mathbb{R}^d); \quad g \in L^q(\mathbb{R}^d)    .
              \end{aligned}$$</span> Then <span
class="math inline"><em>f</em> * <em>g</em> ∈ <em>L</em><sup><em>r</em></sup>(ℝ<sup><em>d</em></sup>)</span>
with <span class="math display">$$\begin{aligned}
                  \left\lVert f*g \right\rVert_{L^r(\mathbb{R}^d)}\leq
\left\lVert f \right\rVert_{L^p(\mathbb{R}^d)}\left\lVert g
\right\rVert_{L^q(\mathbb{R}^d)}.
              \end{aligned}$$</span></em></p></li>
</ol>
<p><em>In any of the above cases <span
class="math inline"><em>f</em> * <em>g</em> = <em>g</em> * <em>f</em></span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The first point follows from the triangle inequality
for the Bochner integral (in this context this is also called
Minkowski’s integral inequality) as <span
class="math display">$$\begin{aligned}
        \left\lVert \int_{\mathbb{R}^d}f(y)g(\cdot -y) \,\mathrm{d}y
\right\rVert_{L^p(\mathbb{R}^d)}\leq\int_{\mathbb{R}^d}\left\lVert
f(y)g(\cdot -y) \,\mathrm{d}y \right\rVert_{L^p(\mathbb{R}^d)}=
\left\lVert f \right\rVert_{L^1(\mathbb{R}^d)} \left\lVert g
\right\rVert_{L^p(\mathbb{R}^d)}.
    \end{aligned}$$</span> To see the second point fix <span
class="math inline"><em>f</em></span> and define the linear operator
<span
class="math inline"><em>T</em><sub><em>f</em></sub><em>g</em> := <em>f</em> * <em>g</em></span>.
Then, for <span
class="math inline"><em>g</em> ∈ <em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>
and <span
class="math inline"><em>g</em> ∈ <em>L</em><sup><em>p</em>′</sup>(ℝ<sup><em>d</em></sup>)</span>
respectively <span class="math display">$$\begin{aligned}
        \left\lVert T_f g \right\rVert_{L^p(\mathbb{R}^d)} \leq
\left\lVert f \right\rVert_{L^p(\mathbb{R}^d)} \left\lVert g
\right\rVert_{L^1(\mathbb{R}^d)}; \quad    \left\lVert T_f g
\right\rVert_{L^\infty(\mathbb{R}^d)} \leq \left\lVert f
\right\rVert_{L^p(\mathbb{R}^d)} \left\lVert g
\right\rVert_{L^{p'}(\mathbb{R}^d)};  .
    \end{aligned}$$</span> Where the first inequality is point one and
the second follows from Cauchy Schwartz. Now applying <a
href=" https://en.wikipedia.org/wiki/Riesz%E2%80%93Thorin_theorem#:~:text=the%20sumset%20formulation.-,Riesz%E2%80%93Thorin,-interpolation%20theorem%C2%A0%E2%80%94%C2%A0">Riesz-Thorin’s
interpolation theorem</a> concludes the proof. ◻</p>
</div>
<p>The definition of convolution can be extended to even more settings,
for example, suppose that <span class="math inline"><em>g</em></span> is
the density of some finite (possibly signed) measure <span
class="math inline"><em>μ</em></span> and <span
class="math inline"><em>f</em></span> is bounded, then <span
class="math display">$$\begin{aligned}
    f*\mu(x):= f*g(x)= \int_{\mathbb{R}^d}f(x-y) g(y)\,\mathrm{d}y =
\int_{\mathbb{R}^d} f(x-y)\,\mathrm{d}\mu (y)
.\end{aligned}$$</span></p>
<div class="definition">
<p><strong>Definition 17</strong> (Convolution of function with
measure). <em>Let <span class="math inline"><em>μ</em></span> be a
finite signed Borel measure on <span
class="math inline">ℝ<sup><em>d</em></sup></span> and <span
class="math inline"><em>f</em> ∈ <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
then we define the convolution <span
class="math display">$$\begin{aligned}
        f*\mu (x) :=\int_{\mathbb{R}^d} f(x-y)\,\mathrm{d}\mu (y) \in
L^p(\mathbb{R}^d).
    \end{aligned}$$</span></em></p>
</div>
<p>Note that, once more by the triangle inequality, the convolution is
well-defined with <span class="math display">$$\begin{aligned}
    \left\lVert f* \mu  \right\rVert_{L^p(\mathbb{R}^d)} \leq
\left\lVert f \right\rVert_{L^p(\mathbb{R}^d)} \left\lVert
\mu  \right\rVert_{TV} .\end{aligned}$$</span> Now, if we consider <span
class="math inline"><em>f</em>, <em>g</em></span> to be the densities of
some finite (signed) measures <span
class="math inline"><em>μ</em>, <em>ν</em></span> then we obtain that
for bounded <span class="math inline"><em>h</em></span> <span
class="math display">$$\begin{aligned}
\label{push}
    (h, \mu *\nu) &amp; := \int_{\mathbb{R}^d} h(x) f*g(x) \,\mathrm{d}x
= \int_{\mathbb{R}^d}\int_{\mathbb{R}^d}  h(x+y) f(x)  g(y)\,\mathrm{d}x
\,\mathrm{d}y\notag \\
                  &amp; = \int_{\mathbb{R}^d \times\mathbb{R}^d} f(x+y)
\,\mathrm{d}(\mu \otimes \nu)(x,y).\end{aligned}$$</span> That is, the
convolution of <span class="math inline"><em>μ</em></span> with <span
class="math inline"><em>ν</em></span> is the <a
href="https://en.wikipedia.org/wiki/Pushforward_measure">pushforward</a>
of the product measure <span
class="math inline"><em>μ</em> ⊗ <em>ν</em></span> with the sum <span
class="math inline"><em>S</em>(<em>x</em>,<em>y</em>)</span>.</p>
<div class="definition">
<p><strong>Definition 18</strong> (Convolution of measures). <em>Let
<span class="math inline"><em>μ</em>, <em>ν</em></span> be two finite
signed measures on <span
class="math inline">ℬ(ℝ<sup><em>d</em></sup>)</span>. Then the
convolution of <span class="math inline"><em>μ</em> * <em>ν</em></span>
is the pushforward <span class="math display">$$\begin{aligned}
        \mu *\nu := S\# (\mu \otimes\nu).
    \end{aligned}$$</span></em></p>
</div>
<p>The language of random variables can give some good motivation for
this</p>
<div class="example">
<p><strong>Example 3</strong>. <em>Let <span
class="math inline"><em>X</em>, <em>Y</em></span> be random variables
with law <span class="math inline"><em>μ</em>, <em>ν</em></span> then
<span class="math inline"><em>X</em> + <em>Y</em></span> has law <span
class="math inline"><em>μ</em> * <em>ν</em></span>. Furthermore, if
<span class="math inline"><em>X</em>, <em>Y</em></span> are independent
and <span class="math inline"><em>μ</em>, <em>ν</em></span> are
absolutely continuous with densities <span
class="math inline"><em>f</em>, <em>g</em></span> then <span
class="math inline"><em>X</em> + <em>Y</em></span> is absolutely
continuous with density <span
class="math inline"><em>f</em> * <em>g</em></span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The first part is by definition of pushforward. To
show that <span class="math inline"><em>μ</em> * <em>ν</em></span> has
density <span class="math inline"><em>f</em> * <em>g</em></span> it
suffices to read the reasoning in equation <a href="#push"
data-reference-type="eqref" data-reference="push">[push]</a>
backward. ◻</p>
</div>
<p>Through the random variable interpretation, we also see that if <span
class="math inline"><em>μ</em>, <em>ν</em></span> have all their mass in
<span class="math inline"><em>A</em>, <em>B</em></span> then their
convolution must have all its mass in <span
class="math inline"><em>A</em> + <em>B</em></span>. That is,</p>
<div id="Support" class="lemma">
<p><strong>Lemma 3</strong>. <em>Let <span
class="math inline"><em>f</em>, <em>g</em>, <em>μ</em>, <em>ν</em></span>
be such that the convolution is well-defined. Then <span
class="math display">$$\begin{aligned}
        \mathbf{supp}(f*g)=\mathbf{supp}(f)+\mathbf{supp}(g); \quad
\mathbf{supp}(\mu*\nu )=\mathbf{supp}(\mu )+\mathbf{supp}(\nu).
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows directly from the definition of
convolution. ◻</p>
</div>
<p>One technical point is that to define the convolution of two objects
it is required that they be defined globally. For example if <span
class="math inline"><em>U</em> ⊊ ℝ<sup><em>d</em></sup></span>, we can’t
convolve <span
class="math inline"><em>f</em> ∈ <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
with <span
class="math inline"><em>g</em> ∈ <em>L</em><sub>1</sub>(<em>U</em>)</span>
as the integral <span class="math display">$$\begin{aligned}
    \int_{\mathbb{R}^d}f(y)g(x-y) \,\mathrm{d}y\end{aligned}$$</span>
requires we evaluate <span class="math inline"><em>f</em></span> on all
of <span class="math inline">ℝ<sup><em>d</em></sup></span>. One
workaround is, if <span
class="math inline"><em>ϕ</em> ∈ <em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>
with <span
class="math inline">$\mathbf{supp}(\phi)\subset  \overline{B(0,\epsilon
) }$</span> we can extend <span class="math inline"><em>f</em></span> to
be equal to some <span
class="math inline"><em>g</em> ∈ <em>L</em><sup><em>p</em></sup>(ℝ)</span>
outside of <span class="math inline"><em>U</em></span> <span
class="math display">$$\begin{aligned}
    \tilde{f}(x)=\begin{cases}
                     f(x) \quad &amp; x \in U     \\
                     g(x) \quad &amp; x \not\in U
                 \end{cases}.\end{aligned}$$</span> Then, the
convolution <span class="math inline"><em>f̃</em> * <em>g</em></span> is
well defined and equal to <span class="math display">$$\begin{aligned}
    \tilde{f}*\phi(x) = \int_{B(x,\epsilon )\cap U} f(y)\phi(x-y)
\,\mathrm{d}y+\int_{B(x,\epsilon )\cap U^c} g(y)\phi(x-y) \,\mathrm{d}y
.\end{aligned}$$</span> As we can see, the convolution in general
depends on how we extend <span class="math inline"><em>f</em></span>
outside of <span class="math inline"><em>U</em></span>. However, it is
independent of the extension for <span
class="math inline"><em>x</em></span> in <span
class="math display">$$\begin{aligned}
    U_\epsilon :=\left\{x \in  U : d(x,\partial U)&lt; \epsilon
\right\}.\end{aligned}$$</span> With <span
class="math display">$$\begin{aligned}
    \tilde{f}*\phi(x) = \int_{B(x,\epsilon )} f(y)\phi(x-y)
\,\mathrm{d}y , \quad\forall x \in  U_\epsilon   .\end{aligned}$$</span>
For this reason, we will employ the following notation.</p>
<div id="Convolution support" class="definition">
<p><strong>Definition 19</strong>. <em>Given <span
class="math inline"><em>f</em> ∈ <em>L</em><sup><em>p</em></sup>(<em>U</em>)</span>
and <span
class="math inline"><em>ϕ</em> ∈ <em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>
with <span
class="math inline">$\mathbf{supp}(\phi)\subset  \overline{B(0,\epsilon
) }$</span> we define <span
class="math inline"><em>f</em> * <em>ϕ</em> ∈ <em>L</em><sup><em>p</em></sup>(<em>U</em><sub><em>ϵ</em></sub>)</span>
as <span class="math display">$$\begin{aligned}
        f*\phi(x):= \int_{B(x,\epsilon )}f(y)\phi(x-y) \,\mathrm{d}y .
    \end{aligned}$$</span></em></p>
</div>
<p>Convolution of distributions with test functions can also be
considered. A similar reason to previously leads us to the following
definition</p>
<div class="definition">
<p><strong>Definition 20</strong>. <em>Let <span
class="math inline"><em>T</em> ∈ 𝒟′(ℝ<sup><em>d</em></sup>)</span> and
<span
class="math inline"><em>φ</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>.
Then we define the convolution <span
class="math inline"><em>T</em> * <em>φ</em> ∈ 𝒟<sup>*</sup>(ℝ<sup><em>d</em></sup>)</span>
by <span class="math display">$$\begin{aligned}
    T*\varphi(\phi):=T(\widetilde{\varphi}*\phi) \quad \text{ where }
\widetilde{\varphi}(x):=\varphi(-x) .\end{aligned}$$</span></em></p>
</div>
<p>In the above we can also swap all occurrences of <span
class="math inline"><em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
and <span class="math inline">𝒟′(ℝ<sup><em>d</em></sup>)</span> by <span
class="math inline">𝒮(ℝ<sup><em>d</em></sup>)</span> and <span
class="math inline">𝒮′(ℝ<sup><em>d</em></sup>)</span> respectively. An
interesting fact is that the convolution of a distribution with a
function is itself a function.</p>
<div class="proposition">
<p><strong>Proposition 5</strong>. <em>Convolution of distribution and
test function is smooth:</em></p>
<ol>
<li><p><em>Let <span
class="math inline"><em>φ</em> ∈ 𝒟(ℝ<sup><em>d</em></sup>), <em>w</em> ∈ 𝒟′(ℝ<sup><em>d</em></sup>)</span>
then <span
class="math inline"><em>ω</em> * <em>φ</em> ∈ <em>C</em><sub>loc</sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>.</em></p></li>
<li><p><em>Let <span
class="math inline"><em>φ</em> ∈ 𝒮(ℝ<sup><em>d</em></sup>), <em>w</em> ∈ 𝒮′(ℝ<sup><em>d</em></sup>)</span>
then <span
class="math inline"><em>ω</em> * <em>φ</em> ∈ <em>C</em><sub>loc</sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>.</em></p></li>
</ol>
</div>
<p>The previous definitions all go through word by word in the case
where we substitute the domain from Euclidean space <span
class="math inline">ℝ<sup><em>d</em></sup></span> to a <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=Since-,every,-locally%20compact%20Hausdorff">LCA
group with Haar measure</a> <span class="math inline"><em>μ</em></span>.
For example <span class="math display">$$\begin{aligned}
    f*g(x):= \int_{G}f(y)g(x-y) \,\mathrm{d}\mu
(y).\end{aligned}$$</span> A typical case is when <span
class="math inline"><em>G</em> = 𝕋<sup><em>d</em></sup></span> with the
Lebesgue measure or <span
class="math inline"><em>G</em> = ℤ<sup><em>d</em></sup></span> with the
counting measure. These respectively give <span
class="math display">$$\begin{aligned}
    f*g(x)=\int_{\mathbb{T}^d}f(y)g(x-y) \,\mathrm{d}y;
\quad      f*g(k):= \sum_{j\in \mathbb{Z}^d}
f(j)g(k-j)  .\end{aligned}$$</span> The same results are also obtained.
In fact, save the commutation <span
class="math inline"><em>f</em> * <em>g</em> = <em>g</em> * <em>f</em></span>,
the above results hold even if <span
class="math inline"><em>G</em></span> is not Abelian. In this case, one
considers the <a
href="https://en.wikipedia.org/wiki/Haar_measure#:~:text=%5Bedit%5D-,There,-is%2C%20up">left
or right Haar measure</a>. See for example <span class="citation"
data-cites="fremlin2006measure"></span> 444R.</p>
<h1 id="smooth section">Smoothing in <span
class="math inline"><em>L</em><sup><em>p</em></sup></span></h1>
<p>In this section, we examine how convolution can be used to
approximate functions by smoother ones. This is of great practical use
as it allows us to</p>
<ol>
<li><p>Consider an appropriate space of functions for our problem,
smooth or otherwise.</p></li>
<li><p>Perform formal manipulations using the standard rules of calculus
as if all functions in this space were smooth and compactly supported
until we obtain a desired result.</p></li>
<li><p>Pass to the limit to recover the expression for the whole class
of functions.</p></li>
</ol>
<p>A crucial tool in this program is the following:</p>
<div id="app def" class="definition">
<p><strong>Definition 21</strong>. <em>We say that a family of functions
<span
class="math inline">{<em>ϕ</em><sub><em>n</em></sub>}<sub><em>n</em> = 1</sub><sup>∞</sup> ⊂ <em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>
is an <strong>approximation to unity</strong> if</em></p>
<ul>
<li><p><em>Norm 1: <span
class="math inline">∥<em>ϕ</em><sub><em>n</em></sub>∥<sub><em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>)</sub> = 1</span>.</em></p></li>
<li><p><em>Decreasing support: <span
class="math inline"><strong>s</strong><strong>u</strong><strong>p</strong><strong>p</strong>(<em>ϕ</em><sub><em>n</em></sub>) ⊂ <em>B</em>(0,1/<em>n</em>)</span>.</em></p></li>
</ul>
<p><em>If <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
we say that <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub></span> are
smooth.</em></p>
</div>
<div class="observation">
<p><strong>Observation 5</strong>. <em>The above definition is
frequently also given letting the index set range over <span
class="math inline"><em>ϵ</em> ∈ ℝ<sub>+</sub></span> and taking <span
class="math inline"><strong>s</strong><strong>u</strong><strong>p</strong><strong>p</strong>(<em>ϕ</em><sub><em>ϵ</em></sub>) ⊂ <em>B</em>(0,<em>ϵ</em>)</span>.
This is equivalent and simply leads to taking <span
class="math inline"><em>ϵ</em> → 0</span> instead of <span
class="math inline"><em>n</em> → ∞</span>.</em></p>
</div>
<p>The first question is whether a smooth approximation to the identity
exists. In the following example, we answer this in the affirmative.</p>
<div class="example">
<p><strong>Example 4</strong>. <em>Let <span
class="math inline"><em>φ</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
then <span class="math display">$$\begin{aligned}
    \phi_n:= \frac{n^d }{\left\lVert \varphi
\right\rVert_{L^1(\mathbb{R}^d)}}\varphi(nx)\end{aligned}$$</span> is a
smooth approximation of the identity. Additionally, <span
class="math display">$$\begin{aligned}
\label{bump example}
        \varphi(x):=  \exp({\frac{1}{\left| x \right|^2-1}}) 1_{B(0,1)}
\in C_c^\infty(\mathbb{R}^d)
    \end{aligned}$$</span></em></p>
</div>
<p>By Proposition <a href="#Young" data-reference-type="ref"
data-reference="Young">4</a> <span
class="math inline">(<em>L</em><sup>1</sup>(ℝ<sup><em>d</em></sup>),*)</span>
is a <a href="https://en.wikipedia.org/wiki/Banach_algebra">Banach
algebra</a>. However, it is a non-unital one. That is there does not
exist an element <span class="math inline"><em>e</em></span> such that
<span class="math display">$$\begin{aligned}
    f*e=f , \quad\forall f \in L^1(\mathbb{R}^d).\end{aligned}$$</span>
However, we will soon see that in a limiting sense, an identity for the
convolution exists. First, we need the following lemma.</p>
<div id="Uryshon" class="lemma">
<p><strong>Lemma 4</strong>. <em>The space <span
class="math inline"><em>C</em><sub><em>c</em></sub>(ℝ<sup><em>d</em></sup>)</span>
is dense in <span
class="math inline"><em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
for all <span class="math inline"><em>p</em> ∈ [1, ∞)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Consider <span
class="math inline"><em>f</em> ∈ <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>.
If <span class="math inline"><em>f</em> = 1<sub><em>A</em></sub></span>
for some measurable set <span class="math inline"><em>A</em></span> with
finite measure then, by the outer and inner regularity of the Lebesgue
measure we may take <span
class="math inline"><em>U</em>, <em>K</em></span> open and compact
respectively with <span
class="math inline"><em>U</em> ⊂ <em>A</em> ⊂ <em>K</em></span> and
<span class="math display">$$\begin{aligned}
        \lambda  (K)-\lambda  (A) &lt;\epsilon .
    \end{aligned}$$</span> Where we wrote <span
class="math inline"><em>μ</em></span> for the Lebesgue measure on <span
class="math inline">ℝ<sup><em>d</em></sup></span>. By <a
href="https://en.wikipedia.org/wiki/Urysohn%27s_lemma#:~:text=for%20any%20two-,non%2Dempty,-closed%20disjoint%20subsets">Urysohn’s
lemma</a> there exists a continuous function <span
class="math inline"><em>φ</em> ∈ <em>C</em><sub><em>c</em></sub>(<em>U</em>)</span>
such that <span class="math inline"><em>φ</em> ≤ 1</span> and <span
class="math inline"><em>φ</em></span> is <span
class="math inline">1</span> on <span
class="math inline"><em>K</em></span>. Then, <span
class="math display">$$\begin{aligned}
        \left\lVert f- \varphi \right\rVert_{L^p(\mathbb{R}^d)} \leq
\epsilon .
    \end{aligned}$$</span> Since the space of simple functions is dense
in <span
class="math inline"><em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
this concludes the proof. ◻</p>
</div>
<p>The name “approximation of unity” in Definition <a href="#app def"
data-reference-type="ref" data-reference="app def">21</a> is justified
by the following proposition.</p>
<div id="app pn" class="proposition">
<p><strong>Proposition 6</strong>. <em>Let <span
class="math inline"><em>f</em> ∈ <em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
where <span class="math inline"><em>p</em> ∈ [1, ∞)</span> and consider
<span
class="math inline"><em>g</em> ∈ <em>C</em><sub><em>c</em></sub>(ℝ<sup><em>d</em></sup>)</span>
and an approximation to unity <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub></span>. Then it
holds that <span class="math display">$$\begin{aligned}
        \lim_{n \to \infty}g*\phi_n=g \in  C_c(\mathbb{R}^d);\quad
\lim_{n \to \infty}f*\phi_n=f \in  L^p(\mathbb{R}^d).
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Consider <span
class="math inline"><em>ϵ</em> &gt; 0</span>. Using that <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub></span> has mass
<span class="math inline">1</span> and is supported on <span
class="math inline"><em>B</em>(0,1/<em>n</em>)</span>. <span
class="math display">$$\begin{aligned}
        g*\phi_n(x)-g(x) &amp; = \int_{B(0, \frac{1}{n})}(g(x-y)-g(x))
\phi_n(y) \,\mathrm{d}y
        .
    \end{aligned}$$</span> Now taking norms and <span
class="math inline"><em>n</em></span> large enough gives <span
class="math display">$$\begin{aligned}
\label{nm}
        \left\lVert g*\phi_n-g \right\rVert_{L^\infty(\mathbb{R}^d)}
\leq \int_{B(0, \frac{1}{n})} \left\lVert g(\cdot -y) -g
\right\rVert_{L^\infty(\mathbb{R}^d)} \phi_n(y) \,\mathrm{d}y\leq
\epsilon   .
    \end{aligned}$$</span> Where in the last inequality we used that
<span class="math inline"><em>g</em></span> is uniformly continuous and
<span class="math inline"><em>ϕ</em><sub><em>n</em></sub></span> has
mass <span class="math inline">1</span>. Since <span
class="math inline"><em>ϵ</em> &gt; 0</span> was any, this shows the
first part of the proposition.</p>
<p>We now prove the second part. By Lemma <a href="#Uryshon"
data-reference-type="ref" data-reference="Uryshon">4</a> we can choose
<span class="math inline"><em>g</em></span> such that <span
class="math display">$$\begin{aligned}
        \left\lVert g-f \right\rVert_{L^p(\mathbb{R}^d)}&lt;\epsilon .
    \end{aligned}$$</span></p>
<p>Now, since <span
class="math inline"><em>K</em><sub><em>n</em></sub> := <strong>s</strong><strong>u</strong><strong>p</strong><strong>p</strong>(<em>g</em>*<em>ϕ</em><sub><em>n</em></sub>) ⊂ <em>K</em> + <em>B</em>(0,1/<em>n</em>)</span>,
whose measure is bounded by some <span
class="math inline"><em>M</em> &gt; 0</span>, the inequality in <a
href="#nm" data-reference-type="eqref" data-reference="nm">[nm]</a>
shows that <span class="math display">$$\begin{aligned}
        \left\lVert g*\phi_n-g \right\rVert_{L^p(\mathbb{R}^d)}^p \leq
\int_{K_n} \epsilon^p   \,\mathrm{d}y\leq M\epsilon^p  .
    \end{aligned}$$</span> Now using the triangle inequality and Young’s
convolution inequality <a href="#Young" data-reference-type="ref"
data-reference="Young">4</a> gives <span
class="math display">$$\begin{aligned}
        \left\lVert f*\phi_n-f \right\rVert_{L^p(\mathbb{R}^d)} &amp;
\leq\left\lVert (f-g)*\phi_n
\right\rVert_{L^p(\mathbb{R}^d)}+\left\lVert g*\phi_n-g
\right\rVert_{L^p(\mathbb{R}^d)} \\
                                                                            &amp;
+\left\lVert g-f \right\rVert_{L^p(\mathbb{R}^d)}\leq \epsilon +
M^{\frac{1}{p}}\epsilon +\epsilon .
    \end{aligned}$$</span> This shows the second part and concludes the
proof. ◻</p>
</div>
<p>The question is why would we want to approximate a function by its
convolutions with some smooth functions the answer is given in the
following two results.</p>
<div id="smooth" class="proposition">
<p><strong>Proposition 7</strong> (Smoothing effect). <em>Let <span
class="math inline"><em>f</em> ∈ <em>L</em><sub>loc</sub><sup>1</sup>(ℝ<sup><em>d</em></sup>)</span>
and <span
class="math inline"><em>ϕ</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>.
Then <span
class="math inline"><em>f</em> * <em>ϕ</em> ∈ <em>C</em><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
with <span class="math display">$$\begin{aligned}
        D^\alpha(f *\phi)=f*D^\alpha \phi , \quad\forall \alpha \in
\mathbb{N}^d.
    \end{aligned}$$</span> Furthermore, if <span
class="math inline"><em>f</em></span> is compactly supported then <span
class="math inline"><em>f</em> * <em>ϕ</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> By induction, it suffices to consider the case <span
class="math inline"><em>D</em><sup><em>α</em></sup> = ∂<sub><em>i</em></sub></span>
for some <span class="math inline">1 ≤ <em>i</em> ≤ <em>d</em></span>.
This case can be proved by a <a
href="https://nowheredifferentiable.com/2023-01-29-PDE-1-Fourier/#:~:text=Proposition%202%20(-,Differentiation,-under%20the%20integral">differentiation
under the integral sign</a> as, given <span
class="math inline">|<em>x</em>| ≤ <em>M</em></span> <span
class="math display">$$\begin{aligned}
        \partial _{x_i} f(y)\phi(x-y) \leq f(y)\left\lVert \phi
\right\rVert_{C^\infty(K)} 1_{K+B(0,M)}(y) \in L^1(\mathbb{R}^d)
    \end{aligned}$$</span> Where <span
class="math inline"><em>K</em></span> is the support of <span
class="math inline"><em>φ</em></span>. ◻</p>
</div>
<div id="local smoothing" class="observation">
<p><strong>Observation 6</strong> (Local smoothing). <em>The smoothing
effect also holds when <span class="math inline"><em>f</em></span> is
only defined on some open set <span
class="math inline"><em>U</em></span>. Then, with the notation of
Definition <a href="#Convolution support" data-reference-type="ref"
data-reference="Convolution support">19</a>, <span
class="math inline"><em>f</em> * <em>ϕ</em> ∈ <em>C</em><sup>∞</sup>(<em>U</em><sub><em>ϵ</em></sub>)</span>
with an identical proof showing <span
class="math display">$$\begin{aligned}
        D^\alpha(f *\phi)=f*D^\alpha \phi \text{ on } U_\epsilon .
    \end{aligned}$$</span></em></p>
</div>
<div id="density thm" class="theorem">
<p><strong>Theorem 15</strong>. <em>It holds that <span
class="math display">$$\begin{aligned}
        \overline{C_c^\infty(\mathbb{R}^d)}= L^p(\mathbb{R}^d); \quad
\overline{C_c^\infty(\mathbb{R}^d)} = C_c(\mathbb{R}^d).
    \end{aligned}$$</span> Where the closures are respectively in the
<span
class="math inline"><em>L</em><sup><em>p</em></sup>(ℝ<sup><em>d</em></sup>)</span>
and the uniform topology <span class="math inline">(</span>given by
<span class="math inline">∥⋅∥<sub>∞</sub>)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows immediately from Proposition <a
href="#app pn" data-reference-type="ref" data-reference="app pn">6</a>
and Proposition <a href="#smooth" data-reference-type="ref"
data-reference="smooth">7</a>. ◻</p>
</div>
<div class="exercise">
<p><strong>Exercise 27</strong>. <em>Let <span
class="math inline"><em>U</em></span> be an open subset of <span
class="math inline">ℝ<sup><em>d</em></sup></span>, show that <span
class="math display">$$\begin{aligned}
        \overline{C_c^\infty(U)}= L^p(U); \quad \overline{C_c^\infty(U)}
= C_c(U).
    \end{aligned}$$</span></em></p>
</div>
<div class="hint">
<p><em>Hint 27</em>. Let <span class="math inline"><em>f</em></span> be
the non-smooth function to approximate, multiply it first by a mollifier
<span
class="math inline"><em>η</em><sub><em>n</em></sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(<em>U</em>)</span>
equal to <span class="math inline">1</span> in <span
class="math inline"><em>V</em><sub><em>n</em></sub> ⊂ <em>U</em></span>
(see Example <a href="#bump example2" data-reference-type="ref"
data-reference="bump example2">5</a>). Convolve to get <span
class="math display">$$\begin{aligned}
    \varphi_n:=(f \eta_n )*\rho _n.\end{aligned}$$</span> Show as in
Theorem <a href="#density thm" data-reference-type="ref"
data-reference="density thm">15</a> that <span
class="math inline"><em>φ</em><sub><em>n</em></sub></span> converges
appropriately.</p>
</div>
<p>The above can be generalized to non-Euclidean spaces</p>
<div class="theorem">
<p><strong>Theorem 16</strong>. <em>Let <span
class="math inline">(<em>X</em>,<em>μ</em>)</span> be a measure space
such that <span class="math inline"><em>X</em></span> is locally convex
and Hausdorff and <span class="math inline"><em>μ</em></span> is inner
and outer regular. Then <span class="math display">$$\begin{aligned}
        \overline{C_c(X)} =L^p(X).
    \end{aligned}$$</span> Suppose additionally that <span
class="math inline"><em>X</em></span> is a group, that <span
class="math inline"><em>μ</em></span> is the left or right Haar measure,
and that there exists an approximation to unity <span
class="math inline"><em>ϕ</em><sub><em>n</em></sub></span> on <span
class="math inline"><em>X</em></span>. Then <span
class="math display">$$\begin{aligned}
        \overline{C_c^\infty(X)} =L^p(X);\quad \overline{C_c^\infty(X)}
=C_c(X).
    \end{aligned}$$</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The first part can be proved by the same method as in
Lemma <a href="#Uryshon" data-reference-type="ref"
data-reference="Uryshon">4</a> (note that Uryshon’s lemma <a
href="https://planetmath.org/ApplicationsOfUrysohnsLemmaToLocallyCompactHausdorffSpaces">still
holds</a> for LCH spaces). The second part follows by copying the proof
of Propositions <a href="#app pn" data-reference-type="ref"
data-reference="app pn">6</a> and <a href="#smooth"
data-reference-type="ref" data-reference="smooth">7</a>. ◻</p>
</div>
<p>The assumption of the existence of an approximation of unity is
perhaps the most delicate, but it can be applied for example in the
following case.</p>
<div id="Stone" class="corollary">
<p><strong>Corollary 1</strong>. <em>It holds that <span
class="math display">$$\begin{aligned}
        \overline{C^\infty(\mathbb{T}^d)}= L^p(\mathbb{T}^d); \quad
\overline{C^\infty(\mathbb{T}^d)} = C(\mathbb{T}^d).
    \end{aligned}$$</span></em></p>
</div>
<p>Note that the second part of Corollary <a href="#Stone"
data-reference-type="ref" data-reference="Stone">1</a> also follows from
the <a
href="https://en.wikipedia.org/wiki/Stone%E2%80%93Weierstrass_theorem">Stone-Weierstrass
theorem</a>. Similar results hold in the space of distributions.</p>
<div class="proposition">
<p><strong>Proposition 8</strong>. <em>Let <span
class="math inline"><em>T</em> ∈ 𝒟′(ℝ<sup><em>d</em></sup>)</span> and
<span class="math inline"><em>φ</em><sub><em>n</em></sub></span> be an
approximation to unity. Then <span
class="math display">$$\begin{aligned}
        \lim_{n \to \infty} T* \phi_n= T \in \mathcal{D}'(\mathbb{R}^d).
    \end{aligned}$$</span> As a result, <span
class="math inline">$\overline{C_c^\infty(\mathbb{R}^d)}=\mathcal{D}'(\mathbb{R}^d)$</span>.</em></p>
</div>
<p>The proof can be found in <span class="citation"
data-cites="leoni2017first"></span> page 308.</p>
<h1 id="local to global">Global to local and back again</h1>
<p>Often it is advantageous to work locally and then reason in the
general case by some kind of approximation. A useful tool in this
respect are <em>bump functions</em>.</p>
<div class="definition">
<p><strong>Definition 22</strong>. <em>A <strong>bump function</strong>
(also called <strong>cutoff function</strong>) is a function <span
class="math inline"><em>η</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>n</em></sup>)</span>.</em></p>
</div>
<p>Constructing bump functions that have some desired support is a tool
we use frequently throughout. Here we provide two examples to show how
this may be done. Other constructions are of course possible.</p>
<div id="bump example2" class="example">
<p><strong>Example 5</strong>. <em>Given two open sets <span
class="math inline"><em>V</em>, <em>U</em></span> with <span
class="math inline"><em>V</em> ⋐ <em>U</em></span> there exists <span
class="math inline"><em>η</em> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
with support in <span class="math inline"><em>U</em></span>, equal to
<span class="math inline">1</span> on <span
class="math inline"><em>V</em></span> and with <span
class="math inline">0 ≤ <em>η</em> ≤ 1</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Since <span
class="math inline"><em>V</em> ⋐ <em>U</em></span>, there exists a
compact <span class="math inline"><em>K</em></span> with <span
class="math display">$$\begin{aligned}
        V \subset K \subset U;\quad d_u:=d(U,K)&gt;0; \quad
d_V:=d(V,K)&gt;0.
    \end{aligned}$$</span></p>
<p>Now, by <a
href="https://en.wikipedia.org/wiki/Urysohn%27s_lemma#:~:text=for%20any%20two-,non%2Dempty,-closed%20disjoint%20subsets">Urysohn’s
lemma</a> there exists a continuous function <span
class="math inline"><em>f</em> ∈ <em>C</em><sub><em>c</em></sub>(ℝ<sup><em>n</em></sup>)</span>
such that <span class="math inline">0 ≤ <em>φ</em> ≤ 1</span> and <span
class="math inline"><em>φ</em></span> is <span
class="math inline">1</span> on <span
class="math inline"><em>K</em></span>. If we now take an approximation
of unity <span
class="math inline">{<em>ϕ</em><sub><em>n</em></sub>}<sub><em>n</em> = 1</sub><sup>∞</sup></span>
and choose <span class="math inline"><em>N</em></span> large enough so
that <span class="math inline">$\min \left\{d_U,d_V\right\} &gt;
\frac{1}{N}$</span> we can obtain the desired function as <span
class="math inline"><em>η</em> = <em>f</em> * <em>ϕ</em><sub><em>N</em></sub></span>. ◻</p>
</div>
<div class="example">
<p><strong>Example 6</strong>. <em>There exists a sequence of <span
class="math inline"><em>η</em><sub><em>n</em></sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
such that <span class="math display">$$\begin{aligned}
        \eta_n(x) =\begin{cases}
                         1 \text{ if }  &amp;\left| x \right|\leq n  \\
                         0 \text{ if }  &amp;\left| x \right|\geq 2n \\
                   \end{cases}.
    \end{aligned}$$</span> And <span
class="math inline">∥<em>η</em><sub><em>n</em></sub>∥<sub><em>C</em><sup><em>k</em></sup>(ℝ<sup><em>d</em></sup>)</sub> ≤ ∥<em>η</em><sub>1</sub>∥</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span
class="math inline"><em>η</em><sub>1</sub> ∈ <em>C</em><sub><em>c</em></sub><sup>∞</sup>(ℝ<sup><em>d</em></sup>)</span>
be any (for example that of <a href="#bump example"
data-reference-type="eqref" data-reference="bump example">[bump
example]</a>). Then we can take <span
class="math inline"><em>η</em><sub><em>n</em></sub>(<em>x</em>) := <em>η</em>(<em>x</em>/<em>n</em>)</span>. ◻</p>
</div>
<p>In the opposite direction. One is often in the situation where it is
possible to derive some local properties for a given object (think
manifolds). To recover a global result one needs some way to piece
together the local results. A useful tool in this respect is
<em>partitions of unity</em>.</p>
<div class="definition">
<p><strong>Definition 23</strong>. <em>Given a manifold <span
class="math inline"><em>M</em></span> and an o pen covering <span
class="math inline">{<em>U</em><sub><em>α</em></sub>}<sub><em>α</em> ∈ <em>J</em></sub></span>
of <span class="math inline"><em>M</em></span> we say that <span
class="math inline">{<em>ρ</em><sub><em>i</em></sub>}<sub><em>i</em> ∈ <em>I</em></sub></span>
is a <strong>partition of unity on <span
class="math inline">{<em>U</em><sub><em>α</em></sub>}<sub><em>α</em> ∈ <em>J</em></sub></span></strong>
if:</em></p>
<ol>
<li><p><em><span
class="math inline"><strong>s</strong><strong>u</strong><strong>p</strong><strong>p</strong>(<em>ρ</em><sub><em>i</em></sub>) ⊂ <em>U</em><sub><em>α</em></sub></span>
for some <span
class="math inline"><em>α</em> ∈ <em>J</em></span>.</em></p></li>
<li><p><em>For each <span
class="math inline"><em>x</em> ∈ <em>M</em></span>, it holds that <span
class="math inline"><em>x</em> ∈ <strong>s</strong><strong>u</strong><strong>p</strong><strong>p</strong>(<em>ρ</em><sub><em>α</em></sub>)</span>
for only a finite amount of <span
class="math inline"><em>α</em> ∈ <em>I</em></span>.</em></p></li>
<li><p><em><span
class="math inline">∑<sub><em>i</em> ∈ <em>I</em></sub><em>ρ</em><sub><em>i</em></sub> = 1.</span></em></p></li>
</ol>
</div>
<p>Partitions of unity are often used in differential geometry as
follows</p>
<ol>
<li><p>Work in some open subset <span
class="math inline">ℝ<sup><em>n</em></sup></span> (or the upper half
space <span
class="math inline">ℝ<sub>+</sub><sup><em>n</em></sup></span> if our
manifold has boundary) to prove the existence of some object <span
class="math inline"><em>g</em></span> with desired properties.</p></li>
<li><p>Cover the manifold <span class="math inline"><em>M</em></span>
with coordinate charts <span
class="math inline"><em>U</em><sub><em>α</em></sub></span> and translate
the euclidean result via the identification with <span
class="math inline"><em>U</em><sub><em>α</em></sub></span> to obtain
locally defined <span
class="math inline"><em>g</em><sub><em>α</em></sub></span>.</p></li>
<li><p>Obtain a globally defined object <span
class="math inline"><em>g</em></span> by using the partition of unity to
piece together the local objects <span
class="math display">$$\begin{aligned}
              g=\sum_{\alpha \in I}\rho_\alpha g_\alpha .
          \end{aligned}$$</span></p></li>
</ol>
<p>In addition to the approximation and extension theorems in Section <a
href="#extension section" data-reference-type="ref"
data-reference="extension section">8</a>, partitions of unity can be
used to show that: every manifold has a <a
href="https://en.wikipedia.org/wiki/Riemannian_manifold">Riemannian
metric</a>, show that a function is smooth on some none-open set <span
class="math inline"><em>S</em> ⊂ <em>M</em></span> iff it is the
restriction of a smooth function defined on a neighborhood of <span
class="math inline"><em>S</em></span>, prove the existence of an outward
pointing vector on manifolds with boundary, define integration over an
orientable manifold <span class="math inline"><em>M</em></span>, prove
<a
href="https://en.wikipedia.org/wiki/Generalized_Stokes_theorem">Stoke’s
theorem</a>.</p>
<div id="partition" class="theorem">
<p><strong>Theorem 17</strong>. <em>Let <span
class="math inline"><em>M</em></span> be a smooth manifold (in
particular we assume <span class="math inline"><em>M</em></span> is
Hausdorff), then every open covering <span
class="math inline">{<em>U</em><sub><em>α</em></sub>}<sub><em>α</em> ∈ <em>J</em></sub></span>
has a partition of unity <span
class="math inline">{<em>ρ</em><sub><em>n</em></sub>}<sub><em>n</em> = 1</sub><sup>∞</sup></span>.</em></p>
</div>
<p>The proof is based on the existence of bump functions (something we
have already proved for <span
class="math inline">ℝ<sup><em>d</em></sup></span>) and is
straightforward in the case that <span
class="math inline"><em>M</em></span> is compact. The general case can
be reduced to the compact setting by obtaining a covering by relatively
compact open sets <span
class="math inline">{<em>U</em><sub><em>i</em></sub>}<sub><em>i</em> = 0</sub><sup>∞</sup></span>
of <span class="math inline"><em>M</em></span> such that <span
class="math display">$$\begin{aligned}
    V_{i} \Subset V_{i+1}.\end{aligned}$$</span> And then working with
the compact <span class="math inline">$\overline{V_{i+1}} \setminus
V_{i}$</span>. See <span class="citation"
data-cites="tu2011manifolds"></span> Appendix C for the details.</p>
<h1 id="boundary">Manifolds with boundary</h1>
<p>We will be defining differential equations on open domains <span
class="math inline"><em>Ω</em> ⊂ ℝ<sup><em>n</em></sup></span>. In this
case <span class="math inline">$\overline{\Omega}$</span> will be a
“manifold with boundary” whose regularity will determine what results we
have access to. The prototypical example of a manifold with a boundary
is the upper half space <span class="math display">$$\begin{aligned}
    \mathcal{H}^d:=\left\{x=(x_1,\ldots,x_d)\in \mathbb{R}^d: x_d \geq
0\right\} .\end{aligned}$$</span> Here the inequality is not strict so
that the boundary of <span
class="math inline">ℋ<sup><em>d</em></sup></span> is included in itself.
Since <span class="math inline">ℋ<sup><em>d</em></sup></span> is not
open we need to define what is meant by saying that a function is
differentiable on such a set.</p>
<div id="smooth non open" class="definition">
<p><strong>Definition 24</strong>. <em>Let <span
class="math inline"><em>S</em> ⊂ ℝ<sup><em>d</em></sup></span> be an
arbitrary set. We say that a function <span
class="math inline"><em>f</em> : <em>S</em> → ℝ</span> is <em><span
class="math inline"><em>k</em></span>-times differentiable at <span
class="math inline"><em>p</em></span></em> if there exists a function
<span class="math inline"><em>f̃</em> : ℝ<sup><em>d</em></sup> → ℝ</span>
which is <span class="math inline"><em>k</em></span> times
differentiable at <span class="math inline"><em>p</em></span> and such
that <span class="math inline"><em>f̃</em> = <em>f</em></span> on <span
class="math inline"><em>S</em></span>.</em></p>
</div>
<div class="definition">
<p><strong>Definition 25</strong>. <em>If <span
class="math inline"><em>f</em></span> is <span
class="math inline"><em>k</em></span>-times differentiable at every
point of <span class="math inline"><em>S</em></span> we say that <span
class="math inline"><em>f</em> ∈ <em>C</em><sup><em>k</em></sup>(<em>S</em>)</span>.</em></p>
</div>
<div id="ext" class="exercise">
<p><strong>Exercise 28</strong>. <em>Show that <span
class="math inline"><em>f</em> ∈ <em>C</em><sup><em>k</em></sup>(<em>S</em>)</span>
if and only if there exists an extension <span
class="math inline"><em>f̃</em> ∈ <em>C</em><sup><em>k</em></sup>(ℝ<sup><em>d</em></sup>)</span>
of <span class="math inline"><em>f</em></span> which is equal to <span
class="math inline"><em>f</em></span> on <span
class="math inline"><em>S</em></span>.</em></p>
</div>
<div class="hint">
<p><em>Hint 28</em>. Use a partition of unity.</p>
</div>
<p>A manifold with boundary <span class="math inline"><em>M</em></span>
is just a generalization of <span
class="math inline">ℋ<sup><em>d</em></sup></span>, where we impose that
<span class="math inline"><em>M</em></span> is “locally equal” to <span
class="math inline">ℋ<sup><em>d</em></sup></span>. That is, there exists
a covering of <span class="math inline"><em>M</em></span> by open sets
<span class="math inline"><em>V</em><sub><em>α</em></sub></span> and a
collection of homeomorphisms with the <em>subspace topology</em> from
<span class="math inline">ℋ<sup><em>d</em></sup></span> <span
class="math display">$$\begin{aligned}
\label{chart}
    \Phi_\alpha : V_\alpha
\xrightarrow{\sim}\Phi(V_\alpha).\end{aligned}$$</span> And where for
compatibility we impose that for each <span
class="math inline"><em>α</em>, <em>β</em></span> the function <span
class="math display">$$\begin{aligned}
\label{diff}
    \Phi_\beta \circ\Phi_\alpha^{-1}: \Phi_\alpha(V_\alpha\cap V_\beta )
\longmapsto \Phi_\beta (V_\alpha\cap V_\beta ).\end{aligned}$$</span>
Are diffeomorphisms on <span
class="math inline">ℋ<sup><em>d</em></sup></span> (again with the
subspace topology). Here <span
class="math inline">𝒜 = {(<em>U</em><sub><em>α</em></sub>,<em>Φ</em><sub><em>α</em></sub>)}</span>
is an <em>atlas</em> of <span class="math inline"><em>M</em></span>. We
say that <span class="math inline">𝒜</span> is <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> if the
diffeomorphisms in <a href="#diff" data-reference-type="eqref"
data-reference="diff">[diff]</a> are <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> (see
Definition <a href="#smooth non open" data-reference-type="ref"
data-reference="smooth non open">24</a>).</p>
<div class="definition">
<p><strong>Definition 26</strong>. <em>We say that <span
class="math inline">(<em>M</em>,𝒜)</span> is a <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> manifold with
boundary if <span class="math inline"><em>M</em></span> is a second
countable Hausdorff space and <span class="math inline">𝒜</span> is a
<span class="math inline"><em>C</em><sup><em>k</em></sup></span>
atlas.</em></p>
</div>
<p>The boundary of <span class="math inline"><em>M</em></span> is its
points that are mapped to the boundary <span
class="math inline">{<em>x</em><sub><em>d</em></sub>=0}</span> in <span
class="math inline">ℋ<sup><em>d</em></sup></span>.</p>
<div class="definition">
<p><strong>Definition 27</strong>. <em>Given a point <span
class="math inline"><em>p</em> ∈ <em>M</em></span> we say that <span
class="math inline"><em>p</em></span> is a <em>boundary point</em> if
for some (and thus every chart) <span
class="math inline"><em>Φ</em><sub><em>α</em></sub>(<em>p</em>) ∈ ∂ℋ<sup><em>d</em></sup></span>.
We call the set of all boundary points the <em>boundary</em> of <span
class="math inline"><em>M</em></span> and denote it by <span
class="math inline">∂<em>M</em></span>.</em></p>
</div>
<div class="exercise">
<p><strong>Exercise 29</strong>. <em>Show that the restricted atlas
<span
class="math inline"><em>Φ</em><sub><em>α</em></sub>|<sub>∂<em>M</em></sub></span>
makes <span class="math inline">∂<em>M</em></span> a <span
class="math inline"><em>d</em> − 1</span> dimensional manifold
<em>without</em> boundary.</em></p>
</div>
<div class="hint">
<p><em>Hint 29</em>. By definition of boundary <span
class="math display">$$\begin{aligned}
\label{chart2}
        \left.\Phi_\alpha\right|_{\partial M}: V_\alpha \cap M \to
\partial \mathcal{H}^{d-1} \simeq \mathbb{R}^{d-1}.
    \end{aligned}$$</span> And the coordinate changes are <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> as the
restriction of a <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> map is <span
class="math inline"><em>C</em><sup><em>k</em></sup></span>.</p>
</div>
<p>In our case we will always take <span
class="math inline"><em>M</em></span> to be a subset of <span
class="math inline">ℝ<sup><em>d</em></sup></span>, in this case,
different variations of the above definition are possible. For example,
by the inverse function theorem and Exercise <a href="#ext"
data-reference-type="ref" data-reference="ext">28</a>, we can extend the
functions <span
class="math inline"><em>Φ</em><sub><em>α</em></sub></span> to
diffeomorphisms on <span
class="math inline"><em>U</em><sub><em>α</em></sub></span> <em>open in
<span class="math inline">ℝ<sup><em>d</em></sup></span></em> so that <a
href="#chart" data-reference-type="eqref"
data-reference="chart">[chart]</a>-<a href="#chart2"
data-reference-type="eqref" data-reference="chart2">[chart2]</a> now
read <span class="math display">$$\begin{aligned}
\label{alt0}
    \Phi_\alpha : U_\alpha \xrightarrow{\sim}\Phi(U_\alpha);
\quad    \Phi_\alpha : U_\alpha \cap M
\xrightarrow{\sim}\Phi_\alpha(U_\alpha) \cap \mathcal{H}^d
.\end{aligned}$$</span> Additionally, by the implicit function theorem
there exists for each coordinate set <span
class="math inline"><em>U</em><sub><em>α</em></sub></span> functions
<span
class="math inline"><em>γ</em><sub><em>α</em></sub> ∈ <em>C</em><sup><em>k</em></sup>(ℝ<sup><em>d</em> − 1</sup>)</span>
such that, relabeling the coordinates and decreasing the size of <span
class="math inline"><em>U</em><sub><em>α</em></sub></span> if necessary,
<span class="math display">$$\begin{aligned}
\label{alt1}
    \partial M \cap U_\alpha &amp; =\left\{x \in U_\alpha :
x_d=\gamma_\alpha(x_1,\ldots,x_{d-1}) \right\}\end{aligned}$$</span> Let
us write <span
class="math inline"><em>x</em> = (<em>x</em>′,<em>x</em><sub><em>d</em></sub>)</span>,
by the Taylor expansion <span class="math display">$$\begin{aligned}
    \Phi_\alpha(x',\gamma
_\alpha(x')+\epsilon)=\Phi_\alpha(x)+\frac{\partial \Phi}{\partial
x_d}(x)\epsilon +O(\left\lVert
\epsilon  \right\rVert^2)  .\end{aligned}$$</span> We deduce that, once
more reducing the size of <span
class="math inline"><em>U</em><sub><em>α</em></sub></span> if necessary
and depending on the sign of <span
class="math inline">∂<sub><em>d</em></sub><em>Φ</em></span> on <span
class="math inline"><em>U</em><sub><em>α</em></sub></span>, one and only
one of the following two hold <span
class="math display">$$\begin{aligned}
    (M \setminus \partial M) \cap U_\alpha &amp; =\left\{x \in U_\alpha
: x_d&gt;\gamma_\alpha(x_1,\ldots,x_{d-1}) \right\}\label{alt2}
                 \\
                 (M \setminus \partial M) \cap U_\alpha &amp; =\left\{x
\in U_\alpha : x_d&lt;\gamma_\alpha(x_1,\ldots,x_{d-1})
\right\}.\label{alt3}\end{aligned}$$</span> The equivalent formulations
in <a href="#alt0" data-reference-type="eqref"
data-reference="alt0">[alt0]</a> and in <a href="#alt1"
data-reference-type="eqref" data-reference="alt1">[alt1]</a>-<a
href="#alt3" data-reference-type="eqref"
data-reference="alt3">[alt3]</a> are used in the main exposition.
Finally, in our case, we will typically take <span
class="math inline">$M =\overline{\Omega}$</span> where <span
class="math inline"><em>Ω</em> ⊂ ℝ<sup><em>d</em></sup></span> is some
open set. In this case, we adopt the following terminology.</p>
<div class="definition">
<p><strong>Definition 28</strong>. <em>We say that an open set <span
class="math inline"><em>Ω</em> ⊂ ℝ<sup><em>d</em></sup></span> has <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> boundary of
<span class="math inline">$\overline{\Omega}$</span> is a <span
class="math inline"><em>C</em><sup><em>k</em></sup></span> manifold with
boundary.</em></p>
</div>
<p>In the above case, the topological and manifold boundaries of <span
class="math inline"><em>Ω</em></span> necessarily coincide as
homeomorphisms map topological boundaries to topological boundaries.</p>
</body>
</html>
